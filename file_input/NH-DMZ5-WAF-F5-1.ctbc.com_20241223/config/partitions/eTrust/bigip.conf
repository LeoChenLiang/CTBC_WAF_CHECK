#TMSH-VERSION: 17.1.1.3

asm policy /eTrust/SP_eTrust {
    active
    encoding utf-8
}
asm policy /eTrust/SP_eTrust_OBDX {
    active
    encoding utf-8
}
ltm node /eTrust/10.23.94.68 {
    address 10.23.94.68
}
ltm node /eTrust/10.23.95.68 {
    address 10.23.95.68
}
ltm node /eTrust/10.24.67.35 {
    address 10.24.67.35
}
ltm node /eTrust/10.24.67.36 {
    address 10.24.67.36
}
ltm node /eTrust/10.248.29.189 {
    address 10.248.29.189
}
ltm node /eTrust/10.248.29.190 {
    address 10.248.29.190
}
ltm node /eTrust/10.248.29.231 {
    address 10.248.29.231
}
ltm node /eTrust/10.248.29.233 {
    address 10.248.29.233
}
ltm policy /eTrust/asm_auto_l7_policy__VS_OBDX_PROD_443 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /eTrust/SP_eTrust_OBDX
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /eTrust/asm_auto_l7_policy__VS_eTrust_443 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /eTrust/SP_eTrust
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /eTrust/asm_auto_l7_policy__VS_eTrust_9003 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /eTrust/SP_eTrust
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm pool /eTrust/POOL_OBDX_PROD_WEB_OHS {
    members {
        /eTrust/10.248.29.231:4443 {
            address 10.248.29.231
        }
        /eTrust/10.248.29.233:4443 {
            address 10.248.29.233
        }
    }
    monitor /Common/tcp
}
ltm pool /eTrust/POOL_eTrust_9003 {
    members {
        /eTrust/10.23.94.68:9003 {
            address 10.23.94.68
            session user-disabled
        }
        /eTrust/10.23.95.68:9003 {
            address 10.23.95.68
            session user-disabled
        }
        /eTrust/10.24.67.35:9003 {
            address 10.24.67.35
            monitor /Common/tcp
        }
        /eTrust/10.24.67.36:9003 {
            address 10.24.67.36
            monitor /Common/tcp
        }
    }
    monitor /Common/tcp
}
ltm pool /eTrust/POOL_eTrust_9003_New {
    members {
        /eTrust/10.24.67.35:9003 {
            address 10.24.67.35
        }
    }
    monitor /Common/tcp
}
ltm pool /eTrust/POOL_eTrust_9003_V2 {
    load-balancing-mode least-connections-member
    members {
        /eTrust/10.24.67.35:9003 {
            address 10.24.67.35
        }
        /eTrust/10.24.67.36:9003 {
            address 10.24.67.36
        }
    }
    monitor /Common/tcp
}
ltm pool /eTrust/POOL_eTrust_9004 {
    members {
        /eTrust/10.23.94.68:9004 {
            address 10.23.94.68
            session user-disabled
        }
        /eTrust/10.23.95.68:9004 {
            address 10.23.95.68
            session user-disabled
        }
        /eTrust/10.24.67.35:9004 {
            address 10.24.67.35
        }
        /eTrust/10.24.67.36:9004 {
            address 10.24.67.36
            monitor /Common/tcp
        }
    }
    monitor /Common/tcp
}
ltm pool /eTrust/POOL_eTrust_9004_New {
    members {
        /eTrust/10.24.67.35:9004 {
            address 10.24.67.35
            session user-disabled
        }
        /eTrust/10.24.67.36:9004 {
            address 10.24.67.36
            session user-disabled
        }
    }
    monitor /Common/tcp
}
ltm pool /eTrust/POOL_eTrust_9004_v2 {
    load-balancing-mode least-connections-member
    members {
        /eTrust/10.24.67.35:9004 {
            address 10.24.67.35
        }
        /eTrust/10.24.67.36:9004 {
            address 10.24.67.36
        }
    }
    monitor /Common/tcp
}
ltm rule /eTrust/iRule_Dispatch_eTrust {
when HTTP_REQUEST {
        if { ([HTTP::host] equals "corporate.chinatrust.com")} {
            HTTP::redirect "https://corporate.ctbcbank.com[HTTP::uri]"
			if { [HTTP::has_responded] } { return };   
         } 
        set ckflag 0
        if { ([HTTP::uri] ends_with ".html" or [HTTP::uri] ends_with ".htm" or [HTTP::uri] ends_with "/" or [HTTP::uri] ends_with "internet" )} {
            set ckflag 1
        }
        switch -glob [string tolower [HTTP::uri]] {
                  /NBEDIWEB/sign.do* -
                  /nbediweb/sign.do* -
                  /nbediweb/hash.do* -
                  /nbediweb/iffsrv.do* -
                  /nbediweb/aftersign.do* -
                  /nbediweb/ctcbsmartcard.cab* -
                  /nbediweb/etokenkit.cab* -
                  /nbediweb/css/* -
                  /nbediweb/gif/* -
                  /nbediweb/images/* -
                  /web_jsp/* -
                  /servlet/breakingnewsinq* -
                  /mqservlet/marqueeget* -
		/tw* -
		/hk* -
		/sg* -
		/ny* -
		/vn* -
		/jp* -
		/in* {
			pool POOL_eTrust_9004_v2
			# log local0.info "[IP::client_addr]:[TCP::client_port]>>>[HTTP::header Host][HTTP::uri] is Accept via dynasafe"

		}
		default {
			HTTP::redirect "https://[HTTP::host]/tw"
			if { [HTTP::has_responded] } { return };
			#log local0.info "[IP::client_addr]:[TCP::client_port]>>>[HTTP::header Host][HTTP::uri] is Rejected"
		}
	}
}
when HTTP_RESPONSE {
    if {$ckflag == 1} {
    
        #HTTP::header remove "Server"
        
        HTTP::header insert "Cache-Control" "no-cache,no-store,max-age=0"
        HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
        #HTTP::header insert "Content-Security-Policy" "frame-src *; script-src 'self' 'unsafe-eval' 'unsafe-inline'; object-src 'none'; base-uri 'none';frame-ancestors 'self' https://corporate.ctbcbank.com https://corporate.chinatrust.com"
        #HTTP::header insert "Content-Security-Policy" "frame-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; object-src 'none'; base-uri 'none';frame-ancestors 'self' https://corporate.ctbcbank.com https://corporate.chinatrust.com"
        #HTTP::header insert "Content-Security-Policy" "frame-ancestors 'self' https://corporate.ctbcbank.com https://corporate.chinatrust.com"			
        HTTP::header insert "Content-Security-Policy" "default-src 'self' https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*; object-src 'none'; frame-ancestors 'self' https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*; img-src 'self';script-src 'self' https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:* 'unsafe-inline' 'unsafe-eval';style-src 'self' https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:* 'unsafe-inline'; frame-src 'self' https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*;font-src 'self' ;connect-src 'self' https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*;script-src-elem 'self' 'unsafe-eval' 'unsafe-inline'  https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*;base-uri 'none'"


        HTTP::header insert "X-XSS-Protection" "1; mode=block"
        HTTP::header insert "X-Content-Type-Options" "nosniff"
        #HTTP::header insert "Referrer-Policy" "no-referrer-when-downgrade"
        HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"
        HTTP::header insert "Feature-Policy" "camera 'none'"
        HTTP::header insert "Strict-Transport-Security"  "max-age=31536000; includeSubDomains"
        HTTP::header insert  "Permissions-Policy"  "camera=(),microphone=(),geolocation=()"

    }
}
}
ltm rule /eTrust/iRule_Dispatch_eTrustCN {
when HTTP_REQUEST {
        if { ([HTTP::host] equals "corporate.chinatrust.com.cn")} {
            HTTP::redirect "https://corporate.ctbcbank.com.cn"
            if { [HTTP::has_responded] } { return };   
         } 
        set ckflag 0
        if { ([HTTP::uri] ends_with "Login.html" or [HTTP::uri] ends_with "/"  or [HTTP::uri] ends_with ".html"  or [HTTP::uri] ends_with ".htm" )} {
             set ckflag 1
        }
        if { [HTTP::uri] starts_with "/management" } {
          HTTP::redirect "https://[HTTP::host]/"
        }
		if { [HTTP::has_responded] } { return };
        if { [HTTP::uri] starts_with "/bea_wls_internal" } {
          HTTP::redirect "https://[HTTP::host]/"
        }
		if { [HTTP::has_responded] } { return };
        if { [HTTP::uri] starts_with "/weblogic" } {
          HTTP::redirect "https://[HTTP::host]/"
        }
}
when HTTP_RESPONSE {
    #if {$ckflag == 1} {
        #HTTP::header remove "Server"
        HTTP::header remove "Cache-Control"
        HTTP::header remove "X-Frame-Options"
        
        HTTP::header insert "Cache-Control" "no-cache"
        #HTTP::header insert "Cache-Control" "no-store,max-age=0"
        HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
        #HTTP::header insert "Content-Security-Policy" "frame-ancestors 'self'"
        HTTP::header insert "Content-Security-Policy" "default-src 'self' https://pkicb.ctbcbank.com.cn https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*; object-src 'none'; frame-ancestors 'self' https://pkicb.ctbcbank.com.cn https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*; img-src 'self';script-src 'self' https://pkicb.ctbcbank.com.cn https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:* 'unsafe-inline' 'unsafe-eval';style-src 'self' https://pkicb.ctbcbank.com.cn https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:* 'unsafe-inline'; frame-src 'self' https://pkicb.ctbcbank.com.cn https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*;font-src 'self' ;connect-src 'self' https://pkicb.ctbcbank.com.cn https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*;script-src-elem 'self' 'unsafe-eval' 'unsafe-inline' https://pkicb.ctbcbank.com.cn  https://pbibeb.ctbcbank.com https://corpbank.ctbcbank.com https://cash.ctbcbank.com https://pki.chinatrust.com https://bizbank.ctbcbank.com https://corpap.ctbcbank.com https://corporate.ctbcbank.com.cn https://sdrs.ctbcbank.com:9443 https://localhost:* https://127.0.0.1:*;base-uri 'none'"
        HTTP::header insert "X-XSS-Protection" "1; mode=block"
        HTTP::header insert "X-Content-Type-Options" "nosniff"
        #HTTP::header insert "Referrer-Policy" "no-referrer-when-downgrade"
        HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"
        HTTP::header insert "Feature-Policy" "camera 'none'"
        HTTP::header insert "Strict-Transport-Security"  "max-age=31536000; includeSubDomains"
        HTTP::header insert  "Permissions-Policy"  "camera=(),microphone=(),geolocation=()"
    #}
}
}
ltm rule /eTrust/iRule_Dispatch_eTrust_TEST {
when HTTP_REQUEST {
        set ckflag 0
        if { ([HTTP::uri] ends_with "Login.html" or [HTTP::uri] ends_with "/" )} {
             set ckflag 1
        }         
        switch -glob [string tolower [HTTP::uri]] {
                  /NBEDIWEB/sign.do* -
                  /nbediweb/sign.do* -
                  /nbediweb/hash.do* -
                  /nbediweb/aftersign.do* -
                  /nbediweb/ctcbsmartcard.cab* -
                  /nbediweb/etokenkit.cab* -
                  /nbediweb/css/* -
                  /nbediweb/gif/* -
                  /nbediweb/images/* -
                  /web_jsp/* -
                  /servlet/breakingnewsinq* -
                  /mqservlet/marqueeget* -
		/tw* -
		/hk* -
		/sg* -
		/ny* -
		/vn* -
		/jp* -
		/in* {
			pool POOL_eTrust_9004_New
			# log local0.info "[IP::client_addr]:[TCP::client_port]>>>[HTTP::header Host][HTTP::uri] is Accept via dynasafe"

		}
		default {
			#HTTP::redirect "https://[HTTP::host]/tw"
			log local0.info "[IP::client_addr]:[TCP::client_port]>>>[HTTP::header Host][HTTP::uri] is Rejected"
		}
	}
}
when HTTP_RESPONSE {
    if {$ckflag == 1} {
        HTTP::header insert "Cache-Control" "no-cache"
        HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
        HTTP::header insert "Content-Security-Policy" "frame-ancestors 'self'"
        HTTP::header insert "X-XSS-Protection" "1; mode=block"
        HTTP::header insert "X-Content-Type-Options" "nosniff"
        HTTP::header insert "Feature-Policy" "camera 'none'"

    }
}
}
ltm rule /eTrust/iRule_Dispatch_eTrust_byRange {
when HTTP_REQUEST {
	if { [HTTP::has_responded] } { return };
    # remove Range requests for CVE-2011-3192
    HTTP::header remove Range
    HTTP::header remove Request-Range
}
}
ltm rule /eTrust/iRule_PROD_OBDX {
when HTTP_REQUEST {

    #HTTP::header remove "X-Forwarded-For" 
    #HTTP::header insert "X-Forwarded-For" [IP::client_addr] 

  set url [string tolower [HTTP::uri]]

     if { [HTTP::header value "x-target-unit"] eq ""} {
            HTTP::header remove "x-target-unit"
        }


      if { [HTTP::header value "SELECTED_AUTH"] eq ""} {
            HTTP::header remove "SELECTED_AUTH"
        }

        if {$url starts_with "/index-admin.html" or $url starts_with "/home-admin.html"}
    	{
            reject
    	}
    #HTTP::respond 200 content "<html><head>King of F5 </br></head><body>Hello world!!</body></html>"
	pool POOL_OBDX_PROD_WEB_OHS

}
when HTTP_RESPONSE  {

    HTTP::header remove "X-Forwarded-For" 
    HTTP::header insert "X-Forwarded-For" [IP::client_addr] 


    HTTP::header remove "X-Frame-Options"
    HTTP::header remove "X-Content-Type-Options"
# 20241025&#35519;&#25972;
#    HTTP::header replace "Set-Cookie" "[HTTP::header Set-Cookie]  HttpOnly;SameSite=None; Secure"
    HTTP::header insert "Strict-Transport-Security"  "max-age=31536000; includeSubDomains"   
    HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
    HTTP::header insert "X-Content-Type-Options" "nosniff"
    #20240628 marked
    #HTTP::header insert "Content-Security-Policy" "default-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com https://localhost:*; object-src 'self'; frame-ancestors 'none'; img-src 'self' data: ;script-src 'self' https://fonts.googleapis.com https://localhost:* 'unsafe-inline' 'unsafe-eval';style-src 'self' https://fonts.googleapis.com https://localhost:* 'unsafe-inline'; frame-src 'self';font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com https://localhost:*;connect-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com https://localhost:*;"
    #20240628 updated
    HTTP::header insert "Content-Security-Policy" "default-src 'self' https://localhost:*; object-src 'self'; frame-ancestors 'none'; img-src 'self' https://www.ctbcbank.com data: ;script-src 'self' https://localhost:* 'unsafe-inline' 'unsafe-eval';style-src 'self' https://fonts.googleapis.com https://localhost:* 'unsafe-inline'; frame-src 'self';font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com https://localhost:*;connect-src 'self' https://fonts.gstatic.com https://fonts.googleapis.com https://localhost:*;"
    HTTP::header insert "Feature-Policy" "camera 'none'"
    HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"
    HTTP::header insert "Permissions-Policy"  "camera=(),microphone=(),geolocation=()"
# 20241025&#35519;&#25972;
    HTTP::header replace Cache-Control "max-age=0, no-store"
#    HTTP::header replace "Cache-Control" "[HTTP::header Cache-Control]; max-age=0, no-cache, no-store, must-revalidate" 

	if {$url starts_with "/digx*"}
	{
        HTTP::header replace Content-Type "[HTTP::header Content-Type]; charset=utf-8" 
	}

 # 20241025&#35519;&#25972;
if { [HTTP::header exists "Set-Cookie"] } {
           HTTP::header replace Set-Cookie "[HTTP::header Set-Cookie];SameSite=None;Httponly;Secure;"
#           HTTP::header replace Set-Cookie "[HTTP::header Set-Cookie];SameSite=None;Httponly;Secure;"
    }
 }

 when HTTP_RESPONSE_RELEASE {
    
  set cookies [HTTP::cookie names]
  foreach aCookie $cookies {
# 20241025&#35519;&#25972;  
    #HTTP::cookie httponly $aCookie enable
	#HTTP::cookie secure $aCookie enable
  if {$aCookie matches_regex {^TS(?:[0-9a-fA-F]{6,8})(?:$|_[0-9]+$)}} {
      # Remove ASM Cookies
     HTTP::cookie remove $aCookie
    }
  }

}
}
ltm rule /eTrust/iRule_eTrust_Dispatch_DR {
when HTTP_REQUEST {
        set ckflag 0
        if { ([HTTP::uri] ends_with "Login_DR.html" or [HTTP::uri] ends_with "/" )} {
             set ckflag 1
        }         
        switch -glob [string tolower [HTTP::uri]] {
                  /NBEDIWEB/sign.do* -
                  /nbediweb/sign.do* -
                  /nbediweb/hash.do* -
                  /nbediweb/aftersign.do* -
                  /nbediweb/ctcbsmartcard.cab* -
                  /nbediweb/etokenkit.cab* -
                  /nbediweb/css/* -
                  /nbediweb/gif/* -
                  /nbediweb/images/* -
                  /web_jsp/* -
                  /servlet/breakingnewsinq* -
                  /mqservlet/marqueeget* -
		/tw* -
		/hk* -
		/sg* -
		/ny* -
		/vn* -
		/jp* -
		/in* {
			pool POOL_eTrust_9004_v2
			# log local0.info "[IP::client_addr]:[TCP::client_port]>>>[HTTP::header Host][HTTP::uri] is Accept via dynasafe"

		}
		default {
			HTTP::redirect "https://[HTTP::host]/tw"
			log local0.info "[IP::client_addr]:[TCP::client_port]>>>[HTTP::header Host][HTTP::uri] is Rejected"
		}
	}
}
when HTTP_RESPONSE {
    if {$ckflag == 1} {
        HTTP::header insert "Cache-Control" "no-cache"
        HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
        HTTP::header insert "Content-Security-Policy" "frame-ancestors 'self'"
        HTTP::header insert "X-XSS-Protection" "1; mode=block"
        HTTP::header insert "X-Content-Type-Options" "nosniff"
        HTTP::header insert "Feature-Policy" "camera 'none'"

    }
}
}
ltm rule /eTrust/iRule_eTrust_suspend {
when RULE_INIT {
           set ::ma_content_cbps "<html>
<head>
<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">
<meta http-equiv=\"X-UA-Compatible\" content=\"IT=edge,chrome=IE8\">
<meta http-equiv=\"Pragma\" content=\"no-cache\">
<meta http-equiv=\"Cache-Control\" content=\"no-cache, must-revalidate\">
<meta http-equiv=\"Expires\" content=\"0\">
<link href=\"https://ecorp.chinatrust.com.tw/cts/css/common.css\" rel=\"stylesheet\" type=\"text/css\">
<link href=\"https://ecorp.chinatrust.com.tw/cts/css/ctbc_style.css\" rel=\"stylesheet\" type=\"text/css\">
</head>
<body>
<div class=\"Wrap\" style=\"min-width: 1006px;\">
  <div id=\"myheader\" class=\"Header\">
    <div class=\"headerBlk\">
      <h1><a href=\"http://www.ctbcholding.com/content/twhoo/zh_tw/index.html\" class=\"logo\"></a></h1>
      <ul class=\"topLink\">
        <li><a target=\"_blank\" href=\"https://www.ctbcbank.com/content/twcbo/zh_tw/index.html\">&#27861;&#20154;&#37329;&#34701;</a></li>
      </ul>
		</div>
	</div>
</div>

	<div class=\"Main\"><div class=\"Content\">
	<div id=\"mypage\" class=\"Right_Col\">
		<div class=\"rightContent\" style=\"left: -180px; width: 1049px;\">
			<div class=\"ContBlk\">
				<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">
					<tbody>
						<tr>
							<td>
							<table border=\"0\" cellpadding=\"3\" cellspacing=\"0\" height=\"26\" width=\"100%\">
									<tbody>
										<tr>
											<td width=\"100%\" align=\"right\" valign=\"top\" class=\"txt-tw\">
												&nbsp;
											</td>
										</tr>
									</tbody>
								</table>
							</td>
						</tr>
					</tbody>
				</table>
				<p>&nbsp;</p>
				<table width=\"70%\" height=\"70\" align=\"center\" class=\"point\" style=\"font-size:16px;\">
					<tbody>
						<tr>
							<td class=\"impNote\">
								<div align=\"center\">
									<b>eTrust &#27861;&#20154;&#32178;&#37504;&#20572;&#27231;&#20844;&#21578;</b><br><br>
								</div>
								<p style=\"color: #333; font-size: 14px;\">
                                &#35242;&#24859;&#30340;&#39015;&#23458;&#65292;&#24744;&#22909;&#65281;<br>
                                &#20013;&#22283;&#20449;&#35351;eTrust &#27861;&#37329;&#32178;&#37504;&#36914;&#34892;&#31995;&#32113;&#21319;&#32026;&#65292;&#26412;&#34892;&#23559;&#26044; 2024/11/24 (&#26085;) 00:00 &#36215;&#65292;<br>
                                &#33267; 2024/11/24 (&#26085;) 07:30 &#27490;(&#21488;&#21271;&#26178;&#38291;)&#65292;&#26283;&#20572;&#20572;&#27490;&#32178;&#31449;&#26381;&#21209;&#65292;&#36896;&#25104;&#24744;&#30340;&#19981;&#20415;&#65292;&#25964;&#35531;&#35211;&#35538;&#12290;<br>
                                &#24863;&#35613;&#24744;&#30340;&#25903;&#25345;&#33287;&#24859;&#35703;&#65292;&#26412;&#34892;&#23559;&#25345;&#32396;&#25552;&#20379;&#24744;&#26356;&#26041;&#20415;&#12289;&#26356;&#21451;&#21892;&#30340;&#26381;&#21209;&#65281;<br>
                                &#20013;&#22283;&#20449;&#35351;&#21830;&#26989;&#37504;&#34892; &#25964;&#21855;<br>						
								</p>
								<div align=\"center\">
									<b>Notice for eTrust Internet Banking suspend</b><br><br>
								</div>
								<p style=\"color: #333; font-size: 14px;\">
                                Dear Customer, <br>
                                In order to improve system service , eTrust service will temporarily suspend on 2024/11/24 00:00 ~ 2024/11/24 07:30 (Taipei Time). <br>
                                We sincerely apologize for the inconvenience caused. <br>
                                CTBC  BANK<br>
							</p></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>


<div class=\"clear\"></div>
</div>
</div>
<div class=\"Footer\" style=\"width: 1347px;\">
    <div class=\"footerBlk\">&#24314;&#35696;&#28687;&#35261;&#22120;&#29256;&#26412;&#65306;IE11 &#25110; Chrome 50 &#25110; Firefox 52 &#20197;&#19978; &#20013;&#22283;&#20449;&#35351; &#29256;&#27402;&#25152;&#26377;</div>
</div>

</body></html>"
}


when HTTP_REQUEST {

           if { [active_members [LB::server pool]] == 0 } {
                     HTTP::respond 200 content $::ma_content_cbps
           }
}
}
ltm snat-translation /eTrust/10.23.91.22 {
    address 10.23.91.22
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /eTrust/10.23.91.115 {
    address 10.23.91.115
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snatpool /eTrust/SNAT_OBDX_PROD {
    members {
        /eTrust/10.23.91.115
    }
}
ltm snatpool /eTrust/SNAT_eTrust_Intra {
    members {
        /eTrust/10.23.91.22
    }
}
ltm virtual /eTrust/VS_OBDX_PROD_443 {
    creation-time 2023-05-26:19:36:30
    destination /eTrust/175.184.243.37:443
    ip-protocol tcp
    last-modified-time 2024-04-25:15:34:03
    mask 255.255.255.255
    persist {
        /Common/source_addr {
            default yes
        }
    }
    policies {
        /eTrust/asm_auto_l7_policy__VS_OBDX_PROD_443 { }
    }
    pool /eTrust/POOL_OBDX_PROD_WEB_OHS
    profiles {
        /Common/HTTP_X_forward { }
        /Common/serverssl {
            context serverside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /eTrust/ASM_SP_eTrust_OBDX { }
        /eTrust/OBDX_SSL_P_2024 {
            context clientside
        }
    }
    rules {
        /Common/iRule_SlowAttack_Protection
        /eTrust/iRule_PROD_OBDX
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /eTrust/SNAT_OBDX_PROD
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /eTrust/VS_eTRUST_TEST {
    destination /Common/175.184.243.198:8443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /eTrust/cookies_insert_eTrust {
            default yes
        }
    }
    policies {
        /eTrust/asm_auto_l7_policy__VS_eTrust_443 { }
    }
    pool /eTrust/POOL_eTrust_9004_New
    profiles {
        /Common/DDOS-profile_20170428 { }
        /Common/http { }
        /Common/serverssl-insecure-compatible {
            context serverside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /eTrust/ASM_SP_eTrust { }
        /eTrust/eTrust_SSL_P {
            context clientside
        }
    }
    rules {
        /eTrust/iRule_Dispatch_eTrust_TEST
        /eTrust/iRule_Dispatch_eTrust_byRange
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /eTrust/SNAT_eTrust_Intra
        type snat
    }
    translate-address enabled
    translate-port enabled
    vlans {
        /Common/DMZ_Vlan_242
    }
    vlans-enabled
}
ltm virtual /eTrust/VS_eTrust_443 {
    destination /Common/175.184.243.198:443
    ip-protocol tcp
    last-modified-time 2024-05-16:14:27:40
    mask 255.255.255.255
    persist {
        /eTrust/cookies_insert_eTrust {
            default yes
        }
    }
    policies {
        /eTrust/asm_auto_l7_policy__VS_eTrust_443 { }
    }
    pool /eTrust/POOL_eTrust_9004_v2
    profiles {
        /Common/DDOS-profile_20170428 { }
        /Common/serverssl-insecure-compatible {
            context serverside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /eTrust/ASM_SP_eTrust { }
        /eTrust/HTTP_etrust { }
        /eTrust/eTrust_SSL_P {
            context clientside
        }
    }
    rules {
        /Common/iRule_SlowAttack_Protection
        /eTrust/iRule_Dispatch_eTrust
        /eTrust/iRule_Dispatch_eTrust_byRange
        /eTrust/iRule_eTrust_suspend
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /eTrust/SNAT_eTrust_Intra
        type snat
    }
    translate-address enabled
    translate-port enabled
    vlans {
        /Common/DMZ_Vlan_2794
    }
    vlans-enabled
}
ltm virtual /eTrust/VS_eTrust_9003 {
    destination /eTrust/10.23.91.22:9003
    ip-protocol tcp
    last-modified-time 2023-12-08:18:07:09
    mask 255.255.255.255
    persist {
        /eTrust/cookies_insert_eTrust {
            default yes
        }
    }
    policies {
        /eTrust/asm_auto_l7_policy__VS_eTrust_9003 { }
    }
    pool /eTrust/POOL_eTrust_9003_V2
    profiles {
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /eTrust/ASM_SP_eTrust { }
    }
    rules {
        /Common/iRule_SlowAttack_Protection
        /eTrust/iRule_Dispatch_eTrustCN
        /eTrust/iRule_eTrust_suspend
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /eTrust/SNAT_eTrust_Intra
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual-address /eTrust/10.23.91.22 {
    address 10.23.91.22
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /eTrust/175.184.243.37 {
    address 175.184.243.37
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm persistence cookie /eTrust/cookies_insert_eTrust {
    always-send disabled
    app-service none
    cookie-encryption required
    cookie-encryption-passphrase $M$OM$FhK5HL1mSV/CEi07hnrGNg==
    cookie-name none
    defaults-from /Common/cookie
    expiration 0
    method insert
    override-connection-limit disabled
    timeout 180
}
ltm profile client-ssl /eTrust/OBDX_SSL_P_2023 {
    alert-timeout 10
    allow-dynamic-record-sizing disabled
    allow-expired-crl disabled
    allow-non-ssl disabled
    app-service none
    authenticate once
    authenticate-depth 9
    ca-file /Common/vsign-universal-root.crt
    cache-size 262144
    cache-timeout 3600
    cert-extension-includes { basic-constraints subject-alternative-name }
    cert-key-chain {
        OBDX_TWCA_SSL_P_2023_obdx_2023_chain_v2_0 {
            cert /Common/OBDX_TWCA_SSL_P_2023
            chain /Common/obdx_2023_chain_v2
            key /Common/OBDX_TWCA_SSL_P_2023
        }
    }
    cert-lifespan 30
    cert-lookup-by-ipaddr-port disabled
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    client-cert-ca none
    crl none
    crl-file none
    data-0rtt disabled
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-ca-certkeychain true
    inherit-certkeychain false
    max-active-handshakes indefinite
    max-aggregate-renegotiation-per-minute indefinite
    max-renegotiations-per-minute 5
    maximum-record-size 16384
    mod-ssl-methods disabled
    mode enabled
    notify-cert-status-to-virtual-server disabled
    ocsp-stapling disabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    peer-cert-mode ignore
    peer-no-renegotiate-timeout 10
    proxy-ssl disabled
    proxy-ssl-passthrough disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size 1000mb
    renegotiation enabled
    retain-certificate true
    secure-renegotiation require
    server-name none
    session-mirroring disabled
    session-ticket disabled
    session-ticket-timeout 0
    sni-default false
    sni-require false
    ssl-forward-proxy disabled
    ssl-forward-proxy-bypass disabled
    ssl-forward-proxy-verified-handshake disabled
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /eTrust/OBDX_SSL_P_2024 {
    alert-timeout 10
    allow-dynamic-record-sizing disabled
    allow-expired-crl disabled
    allow-non-ssl disabled
    app-service none
    authenticate once
    authenticate-depth 9
    ca-file /Common/vsign-universal-root.crt
    cache-size 262144
    cache-timeout 3600
    cert-key-chain {
        OBDX_TWCA_SSL_P_2024_OBDX_TWCA_SSL_P_2024_chain_0 {
            cert /Common/OBDX_TWCA_SSL_P_2024
            chain /Common/OBDX_TWCA_SSL_P_2024_chain
            key /Common/OBDX_TWCA_SSL_P_2024
        }
    }
    cipher-group none
    ciphers ECDHE-RSA-AES256-GCM-SHA384:!CHACHA20-POLY1305
    client-cert-ca none
    crl none
    crl-file none
    data-0rtt disabled
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-ca-certkeychain true
    inherit-certkeychain false
    max-active-handshakes indefinite
    max-aggregate-renegotiation-per-minute indefinite
    max-renegotiations-per-minute 5
    maximum-record-size 16384
    mod-ssl-methods disabled
    mode enabled
    notify-cert-status-to-virtual-server disabled
    ocsp-stapling disabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    peer-cert-mode ignore
    peer-no-renegotiate-timeout 10
    proxy-ssl disabled
    proxy-ssl-passthrough disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size 1000mb
    renegotiation enabled
    retain-certificate true
    secure-renegotiation require
    server-name none
    session-mirroring disabled
    session-ticket disabled
    session-ticket-timeout 0
    sni-default false
    sni-require false
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /eTrust/eTrust_SSL_P {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    ca-file /Common/vsign-universal-root.crt
    cache-size 262144
    cache-timeout 3600
    cert /Common/eTrust_SSL_2024
    cert-key-chain {
        eTrust_SSL_2024_eTrust_2024_chain_0 {
            cert /Common/eTrust_SSL_2024
            chain /Common/eTrust_2024_chain
            key /Common/eTrust_SSL_2024
        }
    }
    chain /Common/eTrust_2024_chain
    cipher-group none
    ciphers ECDHE-RSA-AES256-GCM-SHA384:!CHACHA20-POLY1305
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/eTrust_SSL_2024
    mod-ssl-methods disabled
    mode enabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    proxy-ssl disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size 1000mb
    renegotiation enabled
    secure-renegotiation require
    server-name none
    session-ticket disabled
    sni-default false
    sni-require false
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /eTrust/eTrust_SSL_P_2024 {
    alert-timeout 10
    allow-dynamic-record-sizing disabled
    allow-expired-crl disabled
    allow-non-ssl disabled
    app-service none
    authenticate once
    authenticate-depth 9
    ca-file /Common/vsign-universal-root.crt
    cache-size 262144
    cache-timeout 3600
    cert-key-chain {
        eTrust_SSL_2024_eTrust_2024_chain_0 {
            cert /Common/eTrust_SSL_2024
            chain /Common/eTrust_2024_chain
            key /Common/eTrust_SSL_2024
        }
    }
    cipher-group none
    ciphers ECDHE-RSA-AES256-GCM-SHA384:!CHACHA20-POLY1305
    client-cert-ca none
    crl none
    crl-file none
    data-0rtt disabled
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-ca-certkeychain true
    inherit-certkeychain false
    max-active-handshakes indefinite
    max-aggregate-renegotiation-per-minute indefinite
    max-renegotiations-per-minute 5
    maximum-record-size 16384
    mod-ssl-methods disabled
    mode enabled
    notify-cert-status-to-virtual-server disabled
    ocsp-stapling disabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    peer-cert-mode ignore
    peer-no-renegotiate-timeout 10
    proxy-ssl disabled
    proxy-ssl-passthrough disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size 1000mb
    renegotiation enabled
    retain-certificate true
    secure-renegotiation require
    server-name none
    session-mirroring disabled
    session-ticket disabled
    session-ticket-timeout 0
    sni-default false
    sni-require false
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile http /eTrust/HTTP_etrust {
    app-service none
    defaults-from /Common/http
    hsts {
        include-subdomains enabled
        maximum-age 31536000
        mode enabled
    }
    proxy-type reverse
}
ltm profile server-ssl /eTrust/serverssl_eTrust {
    app-service none
    cert /Common/eTrust_SSL_2020.crt
    chain /Common/eTrust_2018_chain.crt
    cipher-group none
    ciphers DEFAULT:!DHE:!SHA:!AES:!RSA:!SHA256:!ADH
    defaults-from /Common/serverssl
    key /Common/eTrust_SSL_2020.key
}
ltm profile tcp /eTrust/sack_test {
    app-service none
    defaults-from /Common/tcp
    enhanced-loss-recovery disabled
    selective-acks disabled
    tail-loss-probe disabled
}
security bot-defense asm-profile /eTrust/ASM_SP_eTrust {
    app-service none
}
security bot-defense asm-profile /eTrust/ASM_SP_eTrust_OBDX {
    app-service none
}
sys file ssl-cert /eTrust/Intermediiate_Chain_2048.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:Intermediiate_Chain_2048.crt_37023_1
    revision 1
}
sys file ssl-cert /eTrust/OBDX_TWCA_SSL_P_2024_chain {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:OBDX_TWCA_SSL_P_2024_chain_118835_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_2018_chain.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_2018_chain.crt_55642_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_SSL_2018.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2018.crt_55649_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_SSL_2019.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2019.crt_77052_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_SSL_2020.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2020.crt_77309_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_SSL_2021.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2021.crt_88475_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_SSL_2022.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2022.crt_169133_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_SSL_2023 {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2023_103133_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_SSL_2024.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2024.crt_118747_3
    revision 3
}
sys file ssl-cert /eTrust/eTrust_SSL_2024_V3 {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_SSL_2024_V3_118824_1
    revision 1
}
sys file ssl-cert /eTrust/eTrust_chain_2024.crt {
    cache-path /config/filestore/files_d/eTrust_d/certificate_d/:eTrust:eTrust_chain_2024.crt_118737_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_2024_key {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_2024_key_118766_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_SSL_2018.key {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_SSL_2018.key_55638_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_SSL_2019.key {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_SSL_2019.key_77048_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_SSL_2020.key {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_SSL_2020.key_77305_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_SSL_2021.key {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_SSL_2021.key_88471_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_SSL_2022.key {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_SSL_2022.key_169129_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_SSL_2023 {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_SSL_2023_103131_1
    revision 1
}
sys file ssl-key /eTrust/eTrust_SSL_2024_V3 {
    cache-path /config/filestore/files_d/eTrust_d/certificate_key_d/:eTrust:eTrust_SSL_2024_V3_118814_2
    revision 2
    source-path /var/run/key_mgmt/K31eFh/ssl.key/eTrust_SSL_2024_V3
}
