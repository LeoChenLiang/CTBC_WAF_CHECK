#TMSH-VERSION: 17.1.1.3

apm client-packaging /RBIT/client-packaging { }
apm resource sandbox /RBIT/citrix-client-package {
    base-uri /RBIT/public/citrix
    description "Sandbox for Citrix client package files"
}
apm resource sandbox /RBIT/hosted-content {
    base-uri /RBIT/public/share
    description "Sandbox for static contents"
}
asm policy /RBIT/SP_EBMWIB {
    active
    encoding utf-8
}
asm policy /RBIT/SP_INEB {
    active
    encoding utf-8
}
asm policy /RBIT/SP_INFH {
    active
    encoding utf-8
}
asm policy /RBIT/SP_INWA {
    active
    encoding utf-8
}
ltm ifile /RBIT/CTBC_logo {
    file-name /RBIT/CTBC_logo
}
ltm node /RBIT/10.23.96.8 {
    address 10.23.96.8
    description "INOTP VIP, 2FA"
}
ltm node /RBIT/10.24.69.100 {
    address 10.24.69.100
}
ltm node /RBIT/10.24.70.79 {
    address 10.24.70.79
    description AP_NEW_1
}
ltm node /RBIT/10.24.70.80 {
    address 10.24.70.80
    description AP_NEW_2
}
ltm node /RBIT/10.24.74.20 {
    address 10.24.74.20
}
ltm node /RBIT/10.24.74.21 {
    address 10.24.74.21
}
ltm node /RBIT/10.24.74.22 {
    address 10.24.74.22
}
ltm node /RBIT/10.24.74.23 {
    address 10.24.74.23
}
ltm node /RBIT/10.24.74.48 {
    address 10.24.74.48
}
ltm node /RBIT/10.24.74.52 {
    address 10.24.74.52
}
ltm node /RBIT/10.24.74.53 {
    address 10.24.74.53
}
ltm node /RBIT/10.24.74.54 {
    address 10.24.74.54
}
ltm node /RBIT/10.24.74.58 {
    address 10.24.74.58
}
ltm node /RBIT/10.24.74.59 {
    address 10.24.74.59
}
ltm node /RBIT/10.24.74.60 {
    address 10.24.74.60
}
ltm node /RBIT/10.24.74.61 {
    address 10.24.74.61
}
ltm node /RBIT/10.24.123.8 {
    address 10.24.123.8
}
ltm node /RBIT/10.24.123.10 {
    address 10.24.123.10
}
ltm node /RBIT/10.24.123.12 {
    address 10.24.123.12
    description WEB_NEW
}
ltm node /RBIT/10.248.29.96 {
    address 10.248.29.96
}
ltm node /RBIT/10.248.29.97 {
    address 10.248.29.97
}
ltm node /RBIT/192.168.168.35 {
    address 192.168.168.35
}
ltm node /RBIT/192.168.169.35 {
    address 192.168.169.35
}
ltm node /RBIT/192.168.200.21 {
    address 192.168.200.21
}
ltm node /RBIT/192.168.200.22 {
    address 192.168.200.22
}
ltm node /RBIT/192.168.212.6 {
    address 192.168.212.6
}
ltm policy /RBIT/SP_INEB {
    controls { asm }
    requires { http }
    rules {
        bypass_comment {
            actions {
                0 {
                    asm
                    disable
                }
            }
            conditions {
                0 {
                    http-uri
                    path
                    ends-with
                    values { comment.asp\? }
                }
            }
            ordinal 1
        }
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INEB
                }
            }
            ordinal 2
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_INWA_EXT_80 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INWA
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_INWA_EXT_443 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INWA
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_INWA_Intra_80 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INWA
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_INWA_Intra_443 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INWA
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_MOBILE_INEB_EXT_18080 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_EBMWIB
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_ctbcbank.com_ext_443_DR {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_EBMWIB
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_ctbcbank.com_int_443_DR {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                0 {
                    asm
                    enable
                    policy /RBIT/SP_EBMWIB
                }
            }
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_lotto.ctbcbank.com_443 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INFH
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_www.chinatrustindia.com_ext_80 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_EBMWIB
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_www.ctbcholding.com_ext_80 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INFH
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm policy /RBIT/asm_auto_l7_policy__VS_www.ctbcholding.com_ext_443 {
    controls { asm }
    requires { http }
    rules {
        default {
            actions {
                1 {
                    asm
                    enable
                    policy /RBIT/SP_INFH
                }
            }
            ordinal 1
        }
    }
    strategy /Common/first-match
}
ltm pool /RBIT/INAWA_POOL_AP {
    members {
        /RBIT/10.248.29.96:7013 {
            address 10.248.29.96
            monitor /RBIT/mon_INAWA_AP_96
        }
        /RBIT/10.248.29.97:7013 {
            address 10.248.29.97
            monitor /RBIT/mon_INAWA_AP_97
            session user-disabled
            state user-down
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INAWA_POOL_AP_INTRA {
    members {
        /RBIT/10.248.29.96:7013 {
            address 10.248.29.96
            monitor /Common/tcp
        }
        /RBIT/10.248.29.97:7013 {
            address 10.248.29.97
            monitor /Common/tcp
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INCN_POOL_AP {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7097 {
            address 10.24.74.14
        }
        /Common/10.24.74.15:7097 {
            address 10.24.74.15
            monitor /RBIT/tcp_10seconds
        }
        /RBIT/10.24.74.52:7097 {
            address 10.24.74.52
            monitor /Common/tcp
        }
        /RBIT/10.24.74.53:7097 {
            address 10.24.74.53
        }
    }
    monitor /RBIT/tcp_10seconds
}
ltm pool /RBIT/INCN_POOL_AP_IPsOnly {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7097 {
            address 10.24.74.14
        }
        /Common/10.24.74.15:7097 {
            address 10.24.74.15
        }
        /RBIT/10.24.74.52:7097 {
            address 10.24.74.52
            monitor /Common/tcp
        }
        /RBIT/10.24.74.53:7097 {
            address 10.24.74.53
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INCN_POOL_AP_X5B {
    load-balancing-mode least-connections-member
    members {
        /RBIT/10.24.74.52:7097 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7097 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INCN_POOL_Portal {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7023 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.15:7023 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
        }
        /RBIT/10.24.74.52:7023 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7023 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INCN_POOL_Portal_IPsOnly {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7023 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.15:7023 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
        }
        /RBIT/10.24.74.52:7023 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7023 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INCN_POOL_Portal_X5B {
    members {
        /Common/10.24.74.14:7023 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.52:7023 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7023 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INCN_POOL_WEB {
    load-balancing-mode least-connections-member
    monitor /Common/http
}
ltm pool /RBIT/INCN_POOL_WEB_IPsOnly {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.123.4:83 {
            address 10.24.123.4
            session user-disabled
            state user-down
        }
        /Common/10.24.123.5:83 {
            address 10.24.123.5
            session user-disabled
            state user-down
        }
        /RBIT/10.24.123.10:83 {
            address 10.24.123.10
            session user-disabled
            state user-down
        }
        /RBIT/10.24.123.8:83 {
            address 10.24.123.8
            session user-disabled
            state user-down
        }
    }
    monitor /Common/http
}
ltm pool /RBIT/INCN_POOL_WEB_X5B {
    members {
        /RBIT/10.24.123.10:83 {
            address 10.24.123.10
            session user-disabled
            state user-down
        }
        /RBIT/10.24.123.8:83 {
            address 10.24.123.8
            session user-disabled
            state user-down
        }
    }
    monitor /Common/http
}
ltm pool /RBIT/INEB_POOL_AP {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7203 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.14:7205 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
            session user-disabled
        }
        /RBIT/10.24.74.52:7203 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.52:7205 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
            state user-down
        }
    }
}
ltm pool /RBIT/INEB_POOL_AP_ACCESS_extenral {
    monitor /Common/tcp
}
ltm pool /RBIT/INEB_POOL_AP_ACCESS_internal {
    members {
        /Common/10.24.74.15:7303 {
            address 10.24.74.15
            monitor /RBIT/HTTP_monitor_ACCESS_15
            session user-disabled
            state user-down
        }
        /Common/10.24.74.15:7305 {
            address 10.24.74.15
            monitor /RBIT/HTTP_monitor_ACCESS_15
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.53:7303 {
            address 10.24.74.53
            monitor /RBIT/HTTP_monitor_ACCESS_53
        }
        /RBIT/10.24.74.53:7305 {
            address 10.24.74.53
            monitor /RBIT/HTTP_monitor_ACCESS_53
            session user-disabled
            state user-down
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INEB_POOL_AP_IPsOnly {
    members {
        /Common/10.24.74.14:7203 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.14:7205 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
            session user-disabled
            state user-down
        }
        /Common/10.24.74.14:7207 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
            session user-disabled
        }
        /Common/10.24.74.15:7203 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
        }
        /Common/10.24.74.15:7205 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
            session user-disabled
        }
        /Common/10.24.74.15:7207 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
            session user-disabled
        }
        /RBIT/10.24.74.48:7203 {
            address 10.24.74.48
            monitor /RBIT/mon_INEB_AP_48
            session user-disabled
        }
        /RBIT/10.24.74.48:7205 {
            address 10.24.74.48
            monitor /RBIT/mon_INEB_AP_48
            session user-disabled
        }
        /RBIT/10.24.74.48:7207 {
            address 10.24.74.48
            monitor /RBIT/mon_INEB_AP_48
            session user-disabled
        }
        /RBIT/10.24.74.52:7203 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.52:7205 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.52:7207 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
        }
        /RBIT/10.24.74.53:7203 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
        /RBIT/10.24.74.53:7205 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
        }
        /RBIT/10.24.74.53:7207 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
        }
    }
}
ltm pool /RBIT/INEB_POOL_AP_X5B {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7203 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
            session user-disabled
            state user-down
        }
        /Common/10.24.74.15:7203 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.48:7203 {
            address 10.24.74.48
            monitor /RBIT/mon_INEB_AP_48
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.52:7203 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.52:7205 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
        }
        /RBIT/10.24.74.52:7207 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.52:7209 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.52:7211 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
        }
        /RBIT/10.24.74.52:7213 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
        }
        /RBIT/10.24.74.52:7215 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.52:7217 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
        }
        /RBIT/10.24.74.52:7219 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
        }
        /RBIT/10.24.74.52:7221 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
            session user-disabled
        }
        /RBIT/10.24.74.53:7203 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
        }
        /RBIT/10.24.74.53:7205 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.53:7207 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.53:7209 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
        }
        /RBIT/10.24.74.53:7211 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.53:7213 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.53:7215 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.53:7217 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
        }
        /RBIT/10.24.74.53:7219 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
        }
        /RBIT/10.24.74.53:7221 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
            session user-disabled
        }
        /RBIT/10.24.74.54:7203 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
        }
        /RBIT/10.24.74.54:7205 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
        }
        /RBIT/10.24.74.54:7207 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.54:7209 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.54:7211 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
        }
        /RBIT/10.24.74.54:7213 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.54:7215 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
            state user-down
        }
        /RBIT/10.24.74.54:7217 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
        }
        /RBIT/10.24.74.54:7219 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
        }
        /RBIT/10.24.74.54:7221 {
            address 10.24.74.54
            monitor /RBIT/mon_INEB_AP_54
            session user-disabled
        }
    }
}
ltm pool /RBIT/INEB_POOL_AP_mobilepage {
    load-balancing-mode least-connections-node
    members {
        /Common/10.24.74.14:7219 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.15:7219 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
        }
        /RBIT/10.24.74.52:7219 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7219 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INEB_POOL_AP_mobilepage_internal {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7219 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.15:7219 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
        }
        /RBIT/10.24.74.52:7219 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7219 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INEB_POOL_DUMMY { }
ltm pool /RBIT/INEB_POOL_WEB {
    load-balancing-mode least-connections-member
    monitor /Common/http
}
ltm pool /RBIT/INEB_POOL_WEB_Exalogic {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.123.4:80 {
            address 10.24.123.4
            session user-disabled
            state user-down
        }
        /Common/10.24.123.5:80 {
            address 10.24.123.5
            session user-disabled
        }
    }
    monitor /Common/http
}
ltm pool /RBIT/INEB_POOL_WEB_IPsOnly {
    members {
        /Common/10.24.123.4:80 {
            address 10.24.123.4
        }
        /Common/10.24.123.5:80 {
            address 10.24.123.5
        }
        /RBIT/10.24.123.10:80 {
            address 10.24.123.10
        }
        /RBIT/10.24.123.8:80 {
            address 10.24.123.8
        }
    }
    monitor /Common/http
}
ltm pool /RBIT/INEB_POOL_WEB_X5B {
    load-balancing-mode least-connections-member
    members {
        /RBIT/10.24.123.10:80 {
            address 10.24.123.10
            session user-disabled
            state user-down
        }
        /RBIT/10.24.123.8:80 {
            address 10.24.123.8
            session user-disabled
            state user-down
        }
    }
    monitor /Common/http
}
ltm pool /RBIT/INEB_POOL_WEB_mobilepage {
    description "LINE專案Web Pool"
    load-balancing-mode least-connections-member
    monitor /Common/http
}
ltm pool /RBIT/INFH_POOL_WEB {
    load-balancing-mode least-connections-member
    monitor /RBIT/mon_INFH_WEB
}
ltm pool /RBIT/INHBCC_POOL_AP {
    monitor /Common/tcp
}
ltm pool /RBIT/INHBCC_POOL_AP_IPsOnly {
    monitor /Common/tcp
}
ltm pool /RBIT/INHBCC_POOL_AP_Internal {
    monitor /Common/tcp
}
ltm pool /RBIT/INHBCC_POOL_AP_X5B {
    monitor /Common/tcp
}
ltm pool /RBIT/INHBCC_POOL_WEB {
    monitor /Common/http
}
ltm pool /RBIT/INHB_POOL_AP {
    load-balancing-mode least-connections-member
    members {
        /Common/192.168.212.100:9001 {
            address 192.168.212.100
            monitor /Common/HTTP_INHBCC_100
            priority-group 1
            session user-disabled
            state user-down
        }
        /Common/192.168.212.99:9001 {
            address 192.168.212.99
            monitor /Common/HTTP_INHBCC_99
            priority-group 1
            session user-disabled
            state user-down
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INHB_POOL_AP_Internal {
    members {
        /Common/192.168.212.100:9001 {
            address 192.168.212.100
            monitor /Common/HTTP_INHBCC_100
            session user-disabled
            state user-down
        }
        /Common/192.168.212.99:9001 {
            address 192.168.212.99
            monitor /Common/HTTP_INHBCC_99
            session user-disabled
            state user-down
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INHB_POOL_AP_X5B {
    load-balancing-mode least-connections-member
    monitor /Common/tcp
}
ltm pool /RBIT/INHB_POOL_WEB {
    monitor /Common/http
}
ltm pool /RBIT/INHK_POOL_AP {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7103 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.15:7103 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
        }
        /RBIT/10.24.74.52:7103 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7103 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INHK_POOL_AP_IPsOnly {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7103 {
            address 10.24.74.14
            monitor /Common/HTTP_monitor_AP_14
        }
        /Common/10.24.74.15:7103 {
            address 10.24.74.15
            monitor /Common/HTTP_monitor_AP_15
        }
        /RBIT/10.24.74.52:7103 {
            address 10.24.74.52
            monitor /Common/tcp
        }
    }
}
ltm pool /RBIT/INHK_POOL_AP_X5B {
    members {
        /RBIT/10.24.74.52:7103 {
            address 10.24.74.52
            monitor /RBIT/mon_INEB_AP_52
        }
        /RBIT/10.24.74.53:7103 {
            address 10.24.74.53
            monitor /RBIT/mon_INEB_AP_53
        }
    }
}
ltm pool /RBIT/INHK_POOL_WEB {
    load-balancing-mode least-connections-member
    monitor /Common/http_82
}
ltm pool /RBIT/INHK_POOL_WEB_IPsOnly {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.123.4:82 {
            address 10.24.123.4
            monitor /Common/http_82
        }
        /Common/10.24.123.5:82 {
            address 10.24.123.5
            monitor /Common/http_82
        }
        /RBIT/10.24.123.8:82 {
            address 10.24.123.8
            monitor /Common/tcp
        }
    }
}
ltm pool /RBIT/INHK_POOL_WEB_X5B {
    load-balancing-mode least-connections-member
    members {
        /RBIT/10.24.123.10:82 {
            address 10.24.123.10
        }
        /RBIT/10.24.123.8:82 {
            address 10.24.123.8
        }
    }
    monitor /Common/http_82
}
ltm pool /RBIT/INOTP_POOL_AP {
    description "INOTP VIP, 2FA"
    members {
        /RBIT/10.23.96.8:80 {
            address 10.23.96.8
        }
    }
    monitor /Common/HTTP_INOTP_8
}
ltm pool /RBIT/INWA_POOL_AP {
    members {
        /RBIT/10.248.29.96:7003 {
            address 10.248.29.96
            monitor /RBIT/mon_INWA_AP_96
        }
        /RBIT/10.248.29.97:7003 {
            address 10.248.29.97
            monitor /RBIT/mon_INWA_AP_97
            session user-disabled
            state user-down
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INWA_POOL_AP_INTRA {
    description WebATM_INTRA
    members {
        /RBIT/10.248.29.96:7003 {
            address 10.248.29.96
            monitor /Common/tcp
        }
        /RBIT/10.248.29.97:7003 {
            address 10.248.29.97
            monitor /Common/tcp
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/INWA_POOL_WEB {
    members {
        /RBIT/10.24.123.12:80 {
            address 10.24.123.12
            monitor /Common/tcp
            session user-disabled
        }
        /RBIT/10.24.123.12:443 {
            address 10.24.123.12
            monitor /Common/tcp
            session user-disabled
        }
        /RBIT/192.168.168.35:80 {
            address 192.168.168.35
            session user-disabled
            state user-down
        }
        /RBIT/192.168.168.35:443 {
            address 192.168.168.35
            monitor /RBIT/mon_INWA_WEB
        }
        /RBIT/192.168.169.35:80 {
            address 192.168.169.35
            session user-disabled
            state user-down
        }
        /RBIT/192.168.169.35:443 {
            address 192.168.169.35
            monitor /RBIT/mon_INWA_WEB
        }
    }
    monitor /Common/http
}
ltm pool /RBIT/LOTTO_POOL_WEB {
    members {
        /Common/10.24.123.4:85 {
            address 10.24.123.4
        }
        /RBIT/10.24.123.8:85 {
            address 10.24.123.8
            session user-disabled
            state user-down
        }
    }
    monitor /RBIT/mon_INFH_WEB
}
ltm pool /RBIT/POOL_INEB_OP {
    monitor /Common/tcp
}
ltm pool /RBIT/POOL_INMW_AP {
    load-balancing-mode least-connections-member
    members {
        /Common/10.24.74.14:7403 {
            address 10.24.74.14
            monitor /RBIT/HTTP_monitor_INMW_AP_14
        }
        /RBIT/10.24.74.52:7403 {
            address 10.24.74.52
            monitor /RBIT/HTTP_monitor_INMW_AP_52
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/POOL_INMW_AP_Internal {
    members {
        /Common/10.24.74.14:7403 {
            address 10.24.74.14
            monitor /RBIT/HTTP_monitor_INMW_AP_14
        }
        /Common/10.24.74.15:7403 {
            address 10.24.74.15
            monitor /RBIT/HTTP_monitor_INMW_AP_15
        }
        /RBIT/10.24.74.52:7403 {
            address 10.24.74.52
            monitor /RBIT/HTTP_monitor_INMW_AP_52
        }
        /RBIT/10.24.74.53:7403 {
            address 10.24.74.53
            monitor /RBIT/HTTP_monitor_INMW_AP_53
        }
    }
    monitor /Common/tcp
}
ltm pool /RBIT/TrustPay_POOL_AP {
    members {
        /Common/10.24.74.14:7303 {
            address 10.24.74.14
            monitor /RBIT/MON_TrustPay_AP_14
        }
        /Common/10.24.74.15:7303 {
            address 10.24.74.15
            monitor /RBIT/MON_TrustPay_AP_15
        }
    }
}
ltm pool /RBIT/TrustPay_POOL_WEB {
    members {
        /Common/10.24.123.4:3080 {
            address 10.24.123.4
        }
        /Common/10.24.123.5:3080 {
            address 10.24.123.5
        }
    }
    monitor /Common/http
}
ltm pool /RBIT/test_icmp_2 {
    members {
        /Common/203.66.181.129:0 {
            address 203.66.181.129
        }
    }
}
ltm pool /RBIT/unit1 {
    members {
        /Common/203.66.181.129:0 {
            address 203.66.181.129
        }
    }
}
ltm pool /RBIT/unit1_intranet {
    members {
        /Common/192.168.212.14:0 {
            address 192.168.212.14
        }
    }
}
ltm pool /RBIT/unit2 {
    members {
        /Common/203.66.181.129:0 {
            address 203.66.181.129
        }
    }
}
ltm pool /RBIT/unit2_intranet {
    members {
        /Common/192.168.212.14:0 {
            address 192.168.212.14
        }
    }
}
ltm rule /RBIT/INWA_IRURL {
when HTTP_REQUEST {

  set startDate "0000"
  set endDate "1400" 
  set week "Saturday"

  scan [clock format [clock seconds] -format { %A %H%M}] %s%s curday curtime
  #log local0. "$curday , $curtime"
  if { ($startDate <= $curtime) && ($endDate >= $curtime) && ($week eq $curday) } {
       set ifileContent [ifile get CTBC_logo]
       HTTP::respond 200 content  $ifileContent
       unset ifileContent  
  }
}
}
ltm rule /RBIT/INWA_rediretc {
when HTTP_REQUEST {
if {[HTTP::uri] starts_with "/WebATM/"}
{
 HTTP::redirect "https://eatm.ctbcbank.com"
}
elseif {[HTTP::uri] starts_with "/WebATM/"}
{
 HTTP::redirect "https://eatm.ctbcbank.com"
}
}
}
ltm rule /RBIT/POOL_EBMW_WEB_ECOUPON {

}
ltm rule /RBIT/iRule_Block_MoneyBook {
when HTTP_REQUEST {
  set reqBlock 0
  if { [class match [HTTP::header "fingerprint"] contains MoneyBook_list] } {
  set reqBlock 1
  }
}
when ASM_REQUEST_DONE {
  if { $reqBlock == 1} {
    ASM::raise illegal_MoneyBook
  }
}
}
ltm rule /RBIT/iRule_CNINEB_RESPONSE {
when HTTP_RESPONSE {
HTTP::header remove Server
HTTP::header remove X-Powered-By
HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
}
}
ltm rule /RBIT/iRule_Dispatch_Accessiblilty_Int {
when HTTP_REQUEST {
  snat automap
  #persist cookie insert cookie_insert
  pool /EBMW/POOL_EBMW_AP_Internal
  #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
 }
}
ltm rule /RBIT/iRule_Dispatch_EBMW_Deny {
when HTTP_REQUEST {
if { ([class match [IP::client_addr] equals /RBIT/EBMW_IP_Deny ])} {
reject
}
}
}
ltm rule /RBIT/iRule_Dispatch_INFH_SG {
when HTTP_REQUEST {
 if { [HTTP::has_responded] } { return }; 
 if { [HTTP::host] contains "www.chinatrust.com.sg" }
{
 HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_CM_ebank_022001"
}
elseif { ([HTTP::uri] contains "/twrbo") or ([HTTP::uri] contains "/twcbo") }
{
  HTTP::respond 403
}
elseif  { ([HTTP::host] contains "www.ctbcholding.com") && ([HTTP::uri] starts_with "/lotto") }
{
  snat automap
  #snatpool SNAT_ctbcholding
  #pool LOTTO_POOL_WEB
  #HTTP::uri [string map -nocase {"/lotto" ""} [HTTP::uri]]
  #set uri [string map -nocase {"/lotto" ""} [HTTP::uri]]
  #HTTP::uri $uri
  HTTP::redirect "https://lotto.ctbcbank.com/"
} 
elseif  { [HTTP::host] contains "lotto.ctbcbank.com" }
{
  #snat automap
  pool /EBMW/POOL_LOTTO_WEB
  #pool LOTTO_POOL_WEB
#   HTTP::uri [string map -nocase {"" "/lotto"} [HTTP::uri]]
#   HTTP::redirect "https://lotto.ctbcbank.com/"
}
else {
  #snat automap
  #snatpool SNAT_ctbcholding
  #HTTP::redirect "http://www.ctbcholding.com/content/twhoo/zh_tw/index.html"
  pool /EBMW/POOL_INFH_WEB
  #pool INFH_POOL_WEB
  #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]_INFH"
}
}
}
ltm rule /RBIT/iRule_Dispatch_INFH_SG_80 {
when HTTP_REQUEST {
 if  { [HTTP::host] contains "www.chinatrust.com.sg" }
 {
 HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_CM_ebank_022001"
 }
 elseif  { [HTTP::host] contains "lotto.chinatrust.com.tw" }
 {
  snat none
  pool /EBMW/POOL_LOTTO_WEB
  #pool LOTTO_POOL_WEB
#   HTTP::uri [string map -nocase {"" "/lotto"} [HTTP::uri]]
    HTTP::redirect "http://lotto.ctbcbank.com/reindex.html"
 }
 elseif  { [HTTP::host] contains "lotto.ctbcbank.com" }
 {
  snat none
  pool /EBMW/POOL_LOTTO_WEB
  #pool LOTTO_POOL_WEB
#   HTTP::uri [string map -nocase {"" "/lotto"} [HTTP::uri]]
#    HTTP::redirect "http://lotto.ctbcbank.com/lotto/index.htm"
 }
 elseif { ([HTTP::uri] contains "/twrbo") or ([HTTP::uri] contains "/twcbo") }
{
  HTTP::respond 403
 }
 elseif  { [HTTP::host] contains "lotto.chinatrust.com.tw" }
 {
  snat none
  pool LOTTO_POOL_WEB
#   HTTP::uri [string map -nocase {"" "/lotto"} [HTTP::uri]]
#    HTTP::redirect "http://lotto.ctbcbank.com/lotto/index.htm"
 } 
 elseif  { [HTTP::host] contains "www.ctbcholding.com" }
{
	  snat none
    HTTP::redirect "https://[HTTP::host][HTTP::uri]"
  #pool /EBMW/POOL_INFH_WEB
  #pool INFH_POOL_WEB
  #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]_INFH"
}
}
#  OUT OF Service
when LB_FAILED {
 HTTP::redirect "https://www.ctbcholding.com/out_of_service.html"
}
}
ltm rule /RBIT/iRule_Dispatch_ctbc.tw {
when HTTP_REQUEST {
 if  { [HTTP::host] contains "ctbc.tw" }
 {
        set uri [string map -nocase {"/" "/ShortenerService/shortener?shorturl="} [HTTP::uri]]
        HTTP::uri $uri
   pool /RBIT/INEB_POOL_AP_mobilepage
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--ctbc.tw"
 }
 else {
  snat none
  pool /RBIT/INEB_POOL_WEB_mobilepage
}
}
#  OUT OF Service
when LB_FAILED {
 HTTP::redirect "https://ctbc.tw/out_of_service.html"
}
}
ltm rule /RBIT/iRule_Dispatch_lotto {
when HTTP_REQUEST {
 if  { [HTTP::host] contains "lotto.chinatrust.com.tw" }
 {
  snat none
  pool /EBMW/POOL_LOTTO_WEB
  #pool LOTTO_POOL_WEB
    HTTP::redirect "http://lotto.ctbcbank.com/reindex.html"
 }
 elseif  { [HTTP::host] contains "lotto.ctbcbank.com" }
 {
  snat none
  pool /EBMW/POOL_LOTTO_WEB
  #pool LOTTO_POOL_WEB
 }
 elseif { ([HTTP::uri] contains "/twrbo") or ([HTTP::uri] contains "/twcbo") or ([HTTP::uri] contains "/twhoo") }
{
  HTTP::respond 403
 }
 else {
  snat none
  pool /EBMW/POOL_LOTTO_WEB
}
}
#  OUT OF Service
when LB_FAILED {
 HTTP::redirect "https://www.ctbcholding.com/out_of_service.html"
}
}
ltm rule /RBIT/iRule_EBMWIB_MOBILE_SEO {
when HTTP_REQUEST {
 	if { [HTTP::path] eq "/" }
 	{
  		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbo/zh_tw/index.html"
  		#HTTP::respond 302 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010"
 	}
 	elseif { ([HTTP::uri] starts_with "/content/twrbo") && not(([string tolower [HTTP::header User-Agent]] contains "googlebot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "Baiduspider"))  }
 	{
			if { [HTTP::uri] contains "/twrbo/zh_tw/login.html" }
    	{
					HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010" 
    	}
      else
      {
   				set uri [string map -nocase {"/content/twrbo" "/twrbo"} [HTTP::uri]]
   				HTTP::uri $uri
   				HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
   		}
 }
 elseif {([HTTP::uri] starts_with "/twrbo")}
 {
      if {([string tolower [HTTP::header User-Agent]] contains "googlebot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "Baiduspider")}
      {
         	set uri [string map -nocase {"/twrbo" "/content/twrbo"} [HTTP::uri]]
         	HTTP::uri $uri
         	HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
      }
      else
      {
          if { [HTTP::uri] contains "/twrbo/zh_tw/login.html" }
          {
          		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010" 
          }
       }
  }
 	elseif { ([HTTP::uri] contains "/html/webMobile/contact.html") or ([HTTP::uri] contains "/html/webMobile/account.html")  }
 	{
   		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbo/zh_tw/index.html"
 	}

if { [HTTP::has_responded] } { return };
if { ([HTTP::uri] starts_with "/content/dam/minisite/long/creditcard/5000")  }
{
  HTTP::redirect "https://ob.ctbcbank.com/fsv/cp/index.html"
}
}
when HTTP_RESPONSE {
    HTTP::header insert Strict-Transport-Security "max-age=31536000; includeSubdomains; preload"
    HTTP::header insert Referrer-Policy "strict-origin-when-cross-origin"
    if { !([ HTTP::header exists "Permissions-Policy" ])} {
      HTTP::header insert "Permissions-Policy" "microphone=(), midi=()"  
    }
    else {
      HTTP::header replace "Permissions-Policy" "microphone=(), midi=()"
    }
	if { !([ HTTP::header exists "X-XSS-Protection" ])} {
      HTTP::header insert "X-XSS-Protection" "1; mode=block"  
    }
	if { !([ HTTP::header exists "Content-Security-Policy" ])} { 
	  HTTP::header insert "Content-Security-Policy" "default-src * 'unsafe-eval' 'unsafe-inline';script-src * 'unsafe-eval' 'unsafe-inline'; connect-src * 'unsafe-inline';style-src * 'unsafe-inline'  ;img-src * 'unsafe-inline' data: blob: ; frame-src * ; frame-ancestors * ;  object-src 'none'; font-src 'self' *.ctbcbank.com *.ctbcbank.com:18080 fonts.gstatic.com;"
#	  HTTP::header insert "Content-Security-Policy" "default-src 'self' *.ctbcbank.com *.ctbcbank.com:18080; script-src 'unsafe-eval' 'unsafe-inline' *.ctbcbank.com *.ctbcbank.com:18080 *.google.com *.google.com.tw *.google-analytics.com *.googleapis.com *.googletagmanager.com *.gstatic.com googleads.g.doubleclick.net connect.facebook.net d.line-scdn.net www.youtube.com www.googleadservices.com www.techsolutions.com.tw img.scupio.com jscdn.appier.net s.yimg.com bat.bing.com; connect-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://maxcdn.bootstrapcdn.com *.ctbcbank.com *.ctbcbank.com:18080 fonts.googleapis.com ;img-src 'self' 'unsafe-inline' data: blob: *.ctbcbank.com *.google.com *.google.com.tw *.google-analytics.com *.googletagmanager.com *.gstatic.com *.googleapis.com tr.line.me *.g.doubleclick.net *.analytics.google.com www.facebook.com sp.analytics.yahoo.com *.c.appier.net img.scupio.com; frame-src 'self' *.ctbcbank.com *.ctbcbank.com:18080 www.youtube.com www.youtube-nocookie.com www.googletagmanager.com bid.g.doubleclick.net img.scupio.com *.c.appier.net sp.analytics.yahoo.com www.facebook.com; frame-ancestors 'self' ;  object-src 'none'; font-src 'self' *.ctbcbank.com *.ctbcbank.com:18080 fonts.gstatic.com;"  
	}
    if { !([ HTTP::header exists "Cache-Control" ])} {
      HTTP::header insert "Cache-Control" "no-store, max-age=0"  
    }
    else {
      HTTP::header replace "Cache-Control" "no-store, max-age=0"
    }
}
}
ltm rule /RBIT/iRule_EBMWIB_SEO {
when HTTP_REQUEST {
 	if { [HTTP::path] eq "/" }
 	{
  		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbo/zh_tw/index.html"
  		#HTTP::respond 302 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010"
 	}
 	elseif { ([HTTP::uri] starts_with "/content/twrbo") && not(([string tolower [HTTP::header User-Agent]] contains "googlebot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "Baiduspider"))  }
 	{
			if { [HTTP::uri] contains "/twrbo/zh_tw/login.html" }
    	{
					HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010" 
    	}
      else
      {
   				set uri [string map -nocase {"/content/twrbo" "/twrbo"} [HTTP::uri]]
   				HTTP::uri $uri
   				HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
   		}
 }
 elseif {([HTTP::uri] starts_with "/twrbo")}
 {
      if {([string tolower [HTTP::header User-Agent]] contains "googlebot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "Baiduspider")}
      {
         	set uri [string map -nocase {"/twrbo" "/content/twrbo"} [HTTP::uri]]
         	HTTP::uri $uri
         	HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
      }
      else
      {
          if { [HTTP::uri] contains "/twrbo/zh_tw/login.html" }
          {
          		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010" 
          }
       }
  }
 	elseif { ([HTTP::uri] contains "/html/webMobile/contact.html") or ([HTTP::uri] contains "/html/webMobile/account.html")  }
 	{
   		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbo/zh_tw/index.html"
 	}

if { [HTTP::has_responded] } { return };
if { ([HTTP::uri] starts_with "/content/dam/minisite/long/creditcard/5000")  }
{
  HTTP::redirect "https://ob.ctbcbank.com/fsv/cp/index.html"
}
	# CDN CORS 
    if { ([HTTP::header exists Origin]) and (([HTTP::header Origin] ends_with "mkt.ctbcbank.com")) } {
        if { ( [HTTP::method] equals "OPTIONS" ) and ( [HTTP::header exists "Access-Control-Request-Method"] ) } {
            # CORS preflight request - return response immediately
            HTTP::respond 200 "Access-Control-Allow-Origin" [HTTP::header "Origin"] \
                              "Access-Control-Allow-Credentials" "true" \
                              "Access-Control-Allow-Methods" "POST" \
                              "Access-Control-Allow-Headers" [HTTP::header "Access-Control-Request-Headers"] \
                              "Access-Control-Max-Age" "600" \
                              "Vary" "Origin"
            return
        } else {
            # CORS POST requests - set cors_origin variable
            set cors_origin [HTTP::header "Origin"]
        }
    }
}

when HTTP_RESPONSE {
    if { !([ HTTP::header exists "Strict-Transport-Security" ])} {
    HTTP::header insert Strict-Transport-Security "max-age=31536000; includeSubdomains; preload"
    }
    if { !([ HTTP::header exists "Referrer-Policy" ])} {
      HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"  
    }
    if { !([ HTTP::header exists "Permissions-Policy" ])} {
      HTTP::header insert "Permissions-Policy" "microphone=(), midi=()"  
    }
    else {
      HTTP::header replace "Permissions-Policy" "microphone=(), midi=()"
    }
	if { !([ HTTP::header exists "X-XSS-Protection" ])} {
      HTTP::header insert "X-XSS-Protection" "1; mode=block"  
    }
	if { !([ HTTP::header exists "Content-Security-Policy" ])} { 
      HTTP::header insert "Content-Security-Policy" "default-src 'self' *.ctbcbank.com *.ctbcbank.com:18080; script-src 'unsafe-eval' 'unsafe-inline' *.ctbcbank.com *.ctbcbank.com:18080 *.google.com *.google.com.tw *.google-analytics.com *.googleapis.com *.googletagmanager.com *.gstatic.com googleads.g.doubleclick.net connect.facebook.net d.line-scdn.net www.youtube.com www.googleadservices.com www.techsolutions.com.tw img.scupio.com jscdn.appier.net bat.bing.com https://tagmanager.google.com https://www.google.com  https://static.line-scdn.net https://api.line.me ; connect-src * https://liffsdk.line-scdn.net https://access.line.me ; style-src 'self' 'unsafe-inline' https://maxcdn.bootstrapcdn.com *.ctbcbank.com *.ctbcbank.com:18080 fonts.googleapis.com https://tagmanager.google.com ;img-src 'self' data: blob: *.ctbcbank.com *.google.com *.google.com.tw *.google-analytics.com *.googletagmanager.com *.gstatic.com *.googleapis.com tr.line.me *.g.doubleclick.net *.analytics.google.com www.facebook.com *.c.appier.net img.scupio.com bat.bing.com https://ssl.gstatic.com www.google.co.jp www.google.ca www.google.co.th www.google.com.hk www.google.com.vn https://googleads.g.doubleclick.net https://www.google.com g.doubleclick.net https://*.taboola.com https://img.hbhousing.com.tw https://img.great-home.com.tw; frame-src 'self' *.ctbcbank.com *.ctbcbank.com:18080 www.youtube.com www.youtube-nocookie.com www.googletagmanager.com bid.g.doubleclick.net img.scupio.com *.c.appier.net sp.analytics.yahoo.com www.facebook.com ; frame-ancestors 'self' ;  object-src 'none'; font-src 'self' *.ctbcbank.com *.ctbcbank.com:18080 fonts.gstatic.com;"  
	}
    if { !([ HTTP::header exists "Cache-Control" ])} {
      HTTP::header insert "Cache-Control" "no-store, max-age=0"  
    }
	# CORS POST response - check cors_origin variable set in request
    if { [info exists cors_origin] } {
         HTTP::header insert "Access-Control-Allow-Origin" $cors_origin
         HTTP::header insert "Access-Control-Allow-Credentials" "true"
         HTTP::header insert "Access-Control-Allow-Methods" "POST"
         HTTP::header insert "Access-Control-Max-Age" "600"
         HTTP::header insert "Vary" "Origin"
    }
}
}
ltm rule /RBIT/iRule_EBMWIB_SEO_Div {
when HTTP_REQUEST {
 	if { [HTTP::path] eq "/" }
 	{
  		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbo/zh_tw/index.html"
  		#HTTP::respond 302 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010"
 	}
  elseif { [HTTP::uri] contains "/twrbo/zh_tw/onlinecounter_index/various_services/getleads_index/getleads_ploan1.html" }
  {
          HTTP::redirect "https://m.ctbcbank.com/MobileWeb/uc_Leads/loanLeads"
  }
 	elseif { ([HTTP::uri] starts_with "/content/twrbo") && not(([string tolower [HTTP::header User-Agent]] contains "googlebot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "Baiduspider"))  }
 	{
			if { [HTTP::uri] contains "/twrbo/zh_tw/login.html" }
    	{
					HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010" 
    	}
      else
      {
   				set uri [string map -nocase {"/content/twrbo" "/twrbo"} [HTTP::uri]]
   				HTTP::uri $uri
   				HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
   		}
 }
 elseif {([HTTP::uri] starts_with "/twrbo")}
 {
      if {([string tolower [HTTP::header User-Agent]] contains "googlebot") || ([string tolower [HTTP::header User-Agent]] contains "bingbot") || ([string tolower [HTTP::header User-Agent]] contains "Baiduspider")}
      {
         	set uri [string map -nocase {"/twrbo" "/content/twrbo"} [HTTP::uri]]
         	HTTP::uri $uri
         	HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
      }
      else
      {
          if { [HTTP::uri] contains "/twrbo/zh_tw/login.html" }
          {
          		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbc/twrbc-general/ot001/010" 
          }
       }
  }
 	elseif { ([HTTP::uri] contains "/html/webMobile/contact.html") or ([HTTP::uri] contains "/html/webMobile/account.html")  }
 	{
   		HTTP::respond 301 noserver Location "https://[HTTP::host]/twrbo/zh_tw/index.html"
 	}
}
}
ltm rule /RBIT/iRule_EBMW_ASM {
when HTTP_REQUEST {
if { ([HTTP::uri] contains "/IB/api/adapters/EBMW_Adapter/health")}
{
   HTTP::respond 403
   log "BRANDON1"
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
  ASM::enable /RBIT/SP_EBMWIB
  log "BRANDON2"
 }
elseif { ([HTTP::uri] starts_with "/webads") or ([HTTP::uri] starts_with "/jscollection") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
 ASM::enable /RBIT/SP_EBMWIB
 log "BRANDON3"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { ([HTTP::uri] starts_with "/content/twrbo") && not([string tolower [HTTP::header User-Agent]] contains "googlebot") }
{
   set uri [string map -nocase {"/content/twrbo" "/twrbo"} [HTTP::uri]]
   HTTP::uri $uri
   HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
      log "BRANDON4"
}
elseif {([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb") or ([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb_en") }
{
  snatpool SNAT_INEB
  pool /RBIT/INEB_POOL_AP
  ASM::enable /RBIT/SP_EBMWIB
       log "BRANDON5"
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
 ASM::enable /RBIT/SP_EBMWIB
  log "BRANDON6"
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /RBIT/INEB_POOL_WEB
 ASM::enable /RBIT/SP_EBMWIB
   log "BRANDON7"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB
 ASM::enable /RBIT/SP_EBMWIB
 log "BRANDON8"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/ctbc-ib/zh_rb/general/out_of_service.html"
     log "BRANDON9"
}
}
ltm rule /RBIT/iRule_EBMW_RESPONSE {
when HTTP_RESPONSE {
      if {!([HTTP::header exists "X-Frame-Options"])} {
          HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
          }
      if {!([HTTP::header exists "Permissions-Policy"])} {
          HTTP::header insert "Permissions-Policy "microphone=(),midi=()""
          }
      if { !([ HTTP::header exists "X-XSS-Protection" ])} {
          HTTP::header insert "X-XSS-Protection" "1; mode=block"  
          }     
      if { !([ HTTP::header exists "X-Content-Type-Options" ])} {
          HTTP::header insert "X-Content-Type-Options" "nosniff"  
          }    
      if { !([ HTTP::header exists "Cache-Control" ])} {
          HTTP::header insert "Cache-Control" "private  no-store"  
          } 
      if { !([ HTTP::header exists "Strict-Transport-Security" ])} {
          HTTP::header insert "Strict-Transport-Security" "max-age=31536000;includeSubDomains"  
          } 
      if { !([ HTTP::header exists "Referrer-Policy" ])} {
          HTTP::header insert Referrer-Policy "no-referrer-when-downgrade"  
          }
      if { ([ HTTP::header exists "Set-Cookie" ]) } {
          set cookies [HTTP::header values "Set-Cookie"]
          HTTP::header remove "Set-Cookie"
          foreach acookie $cookies {
             HTTP::header insert "Set-Cookie" "${acookie}; Secure; HttpOnly; SameSite=Lax;"
          }
      }
}
}
ltm rule /RBIT/iRule_EBMW_samesite_cookie_handling {
# iRule: samesite_cookie_handling
# author: Simon Kowallik
# version: 1.3
#
# History: version - author - description
#	 1.0 - Simon Kowallik - initial version 
#	 1.1 - Aaron Hooley - updated to add support for setting SameSite to Strict|Lax|None for BIG-IP and app cookies in Set-Cookie headers
#											- Add option to remove SameSite=None cookies for incompatible browsers
#	 1.2 - Aaron Hooley - Added option to rewrite all cookies without naming them explicitly or with prefixes
#	 1.3 - Aaron Hooley - set samesite_compatible to 0 by default instead of a null string 
#
# What the iRule does:
# Sets SameSite to Strict, Lax or None (and sets Secure when SameSite=None) for compatible user-agents
# Optionally removes SameSite attribute from all cookies for incompatible user-agents so they'll handle cookies as if they were SameSite=None
#
# The iRule should work for:
# - LTM for web app cookies and persistence cookies, except those that the web app sets via Javascript
# - ASM for web app cookies and all ASM cookies except those that ASM or the web app sets via Javascript
# - APM for web app cookies and all APM cookies you configure in the config variable $named_cookies, except those that the web app sets via Javascript
#
# The iRule requires BIG-IP v12 or greater to use the HTTP::cookie attribute command
#
# RFC "standards"
# https://tools.ietf.org/html/draft-west-cookie-incrementalism-00
# https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-05
# further reading:
# https://web.dev/samesite-cookies-explained/
# https://web.dev/samesite-cookie-recipes/
# https://blog.chromium.org/2019/10/developers-get-ready-for-new.html
# https://www.chromium.org/updates/same-site
# https://www.chromium.org/updates/same-site/incompatible-clients

proc checkSameSiteCompatible {user_agent} {
	# Procedure to check if a user-agent supports SameSite=None on cookies
	#
	# usage: 
	#		set isSameSiteCompatible [call checkSameSiteCompatible {User-Agent-String}]
	#
	# check for incompatible user-agents: https://www.chromium.org/updates/same-site/incompatible-clients
	# based on https://devcentral.f5.com/s/articles/HTTP-cookie-SameSite-test-detection-of-browsers-with-incompatible-SameSite-None-handling
	switch -glob -- [set user_agent [string tolower $user_agent]] {
		{*chrome/5[1-9].[0-9]*} -
		{*chrome/6[0-6].[0-9]*} -
		{*chromium/5[1-9].[0-9]*} -
		{*chromium/6[0-6].[0-9]*} -
		{*ip?*; cpu *os 12*applewebkit*} -
		{*macintosh;*mac os x 10_14*version*safari*} -
		{mozilla*macintosh;*mac os x 10_14*applewebkit*khtml, like gecko*} {
			# no samesite support
			return 0
		}
		{*ucbrowser/*} {
			switch -glob -- $user_agent {
				{*ucbrowser/[1-9].*} -
				{*ucbrowser/1[0-1].*} -
				{*ucbrowser/12.[0-9].*} -
				{*ucbrowser/12.1[0-1].*} -
				{*ucbrowser/12.12.*} -
				{*ucbrowser/12.13.[0-2]*} {
					# no samesite support
					return 0
				}
			}
		}
	}
	# If the current user-agent didn't match any known incompatible browser list, assume it can handle SameSite=None 
	return 1

	# CPU Cycles on Executing (>100k test runs)
	#	 Average								 22000-42000 (fastest to slowest path)
	#	 Maximum								214263
	#	 Minimum								 13763
}

# the iRule code
when CLIENT_ACCEPTED priority 100 {

	# Set BIG-IP and app cookies found in Set-Cookie headers using this iRule to:
	#
	# none: Cookies will be sent in both first-party context and cross-origin requests; 
	#		however, the value must be explicitly set to None and all browser requests must 
	#		follow the HTTPS protocol and include the Secure attribute which requires an encrypted 
	#		connection. Cookies that don't adhere to that requirement will be rejected.
	#		Both attributes are required together. If just None is specified without Secure or 
	#		if the HTTPS protocol is not used, the third-party cookie will be rejected.
	#
	# lax: Cookies will be sent automatically only in a first-party context and with HTTP GET requests. 
	#		SameSite cookies will be withheld on cross-site sub-requests, such as calls to load images or iframes, 
	#		but will be sent when a user navigates to the URL from an external site, e.g., by following a link.
	#
	# strict: browser never sends cookies in requests to third party domains
	#
	#		Above definitions from: https://docs.microsoft.com/en-us/microsoftteams/platform/resources/samesite-cookie-update 
	#
	# Note: this iRule does not modify cookies set on the client using Javascript or other methods outside of Set-Cookie headers!
	set samesite_security "none"

	# Uncomment when using this iRule on an APM-enabled virtual server so the MRHSession cookies will be rewritten
	# The iRule cannot be saved on a virtual server with this option uncommented if there is no Access profile also enabled
	#ACCESS::restrict_irule_events disable

	# 1. If you want to set SameSite on all BIG-IP and web application cookies for compliant user-agents, set this option to 1
	# Else, if you want to use the next two options for rewriting explicit named cookies or cookie prefixes, set this option to 0
	set set_samesite_on_all 0

	# 2. Rewrite SameSite on specific named cookies
	#
	# To enable this, list the specific named cookies in the list command and comment out the second set command below
	# To disable this, set this variable to {} and comment out the first set command below
	set named_cookies [list {MRHSession} {LastMRH_Session}]
	#set named_cookies {}

	# 3. Rewrite cookies with a prefix like BIG-IP persistence cookies
	# To enable this, list the cookie name prefixes in the list command and comment out the second set command below
	# To disable this, set this variable to {} and comment out the first set command below
	set cookie_prefixes [list {BIGipServer} {TS}]
	#set cookie_prefixes {}

	# For incompatible user-agents, this iRule can remove the SameSite attribute from all cookies sent to the client via Set-Cookie headers
	# This is only necessary if BIG-IP or the web application being load balanced sets SameSite=None for all clients
	# set to 1 to enable, 0 to disable
	set remove_samesite_for_incompatible_user_agents 1

	# Log debug to /var/log/ltm? 1=yes, 0=no
	# set to 0 after testing
	set samesite_debug 0

	# You shouldn't have to make changes to configuration below here

	# Track the user-agent and whether it supports the SameSite cookie attribute
	set samesite_compatible 0
	set user_agent {}

	if { $samesite_debug }{
		set prefix "[IP::client_addr]:[TCP::client_port]:"
		log local0. "$prefix [string repeat "=" 40]"
		log local0. "$prefix \$samesite_security=$samesite_security; \$set_samesite_on_all=$set_samesite_on_all; \$named_cookies=$named_cookies; \$cookie_prefixes=$cookie_prefixes, \
			\$remove_samesite_for_incompatible_user_agents=$remove_samesite_for_incompatible_user_agents"
	}
}

# Run this test event before any other iRule HTTP_REQUEST events to set the User-Agent header value
# Comment out this event when done testing user-agents
#when HTTP_REQUEST priority 2 {

	# known compatible 
#	HTTP::header replace user-agent {my compatible user agent string}
	# known INcompatible 
#	HTTP::header replace user-agent {chrome/51.10}
#}

# Run this iRule before any other iRule HTTP_REQUEST events
when HTTP_REQUEST priority 100 {

	# If we're setting samesite=none, we need to check the user-agent to see if it's compatible
	if { not [string equal -nocase $samesite_security "none"] }{

		# Not setting SameSite=None, so exit this event
		return
	}

	# Inspect user-agent once per TCP session for higher performance if the user-agent hasn't changed
	if { $samesite_compatible == 0 or $user_agent ne [HTTP::header value {User-Agent}]} {
		set user_agent [HTTP::header value {User-Agent}]
		set samesite_compatible [call checkSameSiteCompatible $user_agent]
		if { $samesite_debug }{
			log local0. "$prefix Got \$samesite_compatible=$samesite_compatible and saved current \$user_agent: $user_agent"
		}
	}
}
# Run this response event with priority 900 after all other iRules to parse the final cookies from the application and BIG-IP
when HTTP_RESPONSE_RELEASE priority 900 {

	# Log the pre-existing Set-Cookie header values
	if { $samesite_debug }{ log local0. "$prefix Set-Cookie value(s): [HTTP::header values {Set-Cookie}]" }

	if { $samesite_compatible } {
		# user-agent is compatible with SameSite=None, set SameSite on matching cookies

		if { $set_samesite_on_all }{
			if { $samesite_debug }{ log local0. "$prefix Setting SameSite=$samesite_security on all cookies and exiting" }
			foreach cookie [HTTP::cookie names] {

				if { $samesite_debug }{ log local0. "$prefix Set SameSite=$samesite_security on $cookie" }

				# Remove any prior instances of SameSite attributes
				HTTP::cookie attribute $cookie remove {samesite} 

				# Insert a new SameSite attribute
				HTTP::cookie attribute $cookie insert {samesite} $samesite_security

				# If samesite attribute is set to None, then the Secure flag must be set for browsers to accept the cookie
				if {[string equal -nocase $samesite_security "none"]} {
					HTTP::cookie secure $cookie enable
				}
			}
			# Exit this event in this iRule as we've already rewritten all cookies with SameSite
			return
		}
		# Match named cookies exactly
		if { $named_cookies ne {} }{
			foreach cookie $named_cookies {
				if { [HTTP::cookie exists $cookie] } {
					# Remove any pre-existing SameSite attributes from this cookie as most clients use the most strict value if multiple instances are set
					HTTP::cookie attribute $cookie remove {SameSite}

					# Insert the SameSite attribute
					HTTP::cookie attribute $cookie insert {SameSite} $samesite_security

					# If samesite attribute is set to None, then the Secure flag must be set for browsers to accept the cookie
					if {[string equal -nocase $samesite_security "none"]} {
						HTTP::cookie secure $cookie enable
					}
				if { $samesite_debug }{ log local0. "$prefix Matched explicitly named cookie $cookie, set SameSite=$samesite_security" }
				if { $samesite_debug }{ log local0. "$prefix " }
				}
			}
		}
		# Match a cookie prefix (cookie name starts with a prefix from the $cookie_prefixes list)
		if { $cookie_prefixes ne {} }{
			foreach cookie [HTTP::cookie names] {
				foreach cookie_prefix $cookie_prefixes {
					if { $cookie starts_with $cookie_prefix } {
						# Remove any pre-existing SameSite attributes from this cookie as most clients use the most strict value if multiple instances are set
						HTTP::cookie attribute $cookie remove {SameSite}

						# Insert the SameSite attribute
						HTTP::cookie attribute $cookie insert {SameSite} $samesite_security

						# If samesite attribute is set to None, then the Secure flag must be set for browsers to accept the cookie
						if { [string equal -nocase $samesite_security "none"] } {
							HTTP::cookie secure $cookie enable
						}
						if { $samesite_debug }{ log local0. "$prefix Matched prefixed cookie $cookie, with prefix $cookie_prefix, set SameSite=$samesite_security, breaking from loop" }
						break
					}
				}
			}
		}
	} else {

		# User-agent can't handle SameSite=None

		if { $remove_samesite_for_incompatible_user_agents }{

			# User-agent can't handle SameSite=None, so remove SameSite attribute from all cookies if SameSite=None
			# This will use CPU cycles on BIG-IP so only enable it if you know BIG-IP or the web application is setting 
			# SameSite=None for all clients including incompatible ones
			foreach cookie [HTTP::cookie names] {
				if { [string tolower [HTTP::cookie attribute $cookie value SameSite]] eq "none" }{
					HTTP::cookie attribute $cookie remove SameSite
					if { $samesite_debug }{ log local0. "$prefix Removing SameSite for incompatible client from cookie=$cookie" }
				}
			}
		}
	}
	# Log the modified Set-Cookie header values
	if { $samesite_debug }{ log local0. "$prefix Final Set-Cookies: [HTTP::header values {Set-Cookie}]" }
}
}
ltm rule /RBIT/iRule_HKINEB_301_redirect_ctbcbank {
when HTTP_REQUEST {
  if { ([HTTP::uri] equals "/hk") or ([HTTP::uri] equals "/hk/") } {
        HTTP::header replace Host "hk.ctbcbank.com"
        HTTP::respond 301 Location "https://hk.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/hk"
    }
 elseif { [HTTP::uri] starts_with "/hk/" } {
        set uri [string map -nocase {"/hk/" "/CTCBPortalWeb/"} [HTTP::uri]]
    #log local0. "New URI = $uri"
        HTTP::uri $uri
        HTTP::header replace Host "hk.ctbcbank.com"
        HTTP::respond 301 Location "https://hk.ctbcbank.com[HTTP::uri]"
    }
  elseif { ([HTTP::host] contains "www.chinatrust.com.hk") }
  {
        HTTP::header replace Host "hk.ctbcbank.com"
        HTTP::respond 301 Location "https://hk.ctbcbank.com[HTTP::uri]"
  }
}
when HTTP_RESPONSE {

    set allcookie [HTTP::header values "Set-Cookie"]
    HTTP::header remove "Set-Cookie"
    foreach thecookie $allcookie {
         HTTP::header insert "Set-Cookie" "${thecookie}; HttpOnly; SameSite=Lax;"

    }
}
}
ltm rule /RBIT/iRule_HKINEB_RESPONSE {
when HTTP_RESPONSE {
  if { [HTTP::has_responded] } { return };
  HTTP::header remove Server
  HTTP::header remove X-Powered-By
    if { !([ HTTP::header exists "Cache-Control" ])} {
      HTTP::header insert "Cache-Control" "no-store, max-age=0"  
    }
    else {
      HTTP::header replace "Cache-Control" "no-store, max-age=0"
    }
  HTTP::header insert "Strict-Transport-Security" "max-age=31536000; includeSubdomains; preload"
  #HTTP::header insert Content-Security-Policy "default-src * 'unsafe-inline' 'unsafe-eval'; script-src * 'unsafe-inline' 'unsafe-eval'; connect-src * 'unsafe-inline'; img-src * data: blob: 'unsafe-inline'; frame-src * data: blob:; style-src * 'unsafe-inline'; frame-ancestors 'self'"
  HTTP::header insert Content-Security-Policy "default-src 'self'; object-src 'none'; frame-ancestors 'self' ; script-src 'self' 'unsafe-inline' 'unsafe-eval' *.ctbcbank.com *.chinatrust.com.hk; style-src 'self' 'unsafe-inline' data: *.ctbcbank.com *.chinatrust.com.hk; img-src 'self' data:"
  HTTP::header insert "X-XSS-Protection" "1; mode=block"
  HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"
  HTTP::header insert "X-Content-Type-Options" "nosniff"
    if { !([ HTTP::header exists "Permissions-Policy" ])} {
      HTTP::header insert "Permissions-Policy" "camera=(), microphone=(), geolocation=(), midi=()"  
    }
    else {
      HTTP::header replace "Permissions-Policy" "camera=(), microphone=(), geolocation=(), midi=()"
    }
    if { !( [HTTP::header exists "X-Frame-Options"]) }{
  HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
    }
  set allcookie [HTTP::header values "Set-Cookie"]
  HTTP::header remove "Set-Cookie"

  foreach thecookie $allcookie {
      if {$thecookie starts_with "JSESSIONID"} {
         HTTP::header insert "Set-Cookie" "$thecookie"
      } else {
         HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly"
      }
  }

}
}
ltm rule /RBIT/iRule_HTTP_RESPONSE {
when HTTP_RESPONSE {
    HTTP::header remove Server
    HTTP::header remove Range
    HTTP::header remove Request-Range
    HTTP::header insert "X-XSS-Protection" "1; mode=block" 
    HTTP::header insert "X-Content-Security-Policy" "default-src 'self'"
    HTTP::header insert "Strict-Transport-Security" "max-age=31536000; includeSubDomains; preload"
	HTTP::header insert "Permissions-Policy" "microphone=(),midi=()"
    HTTP::header insert Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' ajax.googleapis.com; connect-src 'self' 'unsafe-inline'; frame-src *; connect-src 'safe' 'unsafe-inline'; media-src 'self' https://www.youtube.com/embed/ https://www.youtube-nocookie.com/embed/; img-src 'self' data: blob: 'unsafe-inline'; style-src 'self' 'unsafe-inline'"
    HTTP::header insert "Referrer-Policy" "origin"
    HTTP::header remove X-Powered-By
    HTTP::header remove Server
    HTTP::header replace Cache-Control no-store
    set allcookie [HTTP::header values "Set-Cookie"]
    HTTP::header remove "Set-Cookie"
    foreach thecookie $allcookie {
      if {$thecookie starts_with "JSESSIONID"} {
         HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly; SameSite=Lax"
      }
      else {
         HTTP::header insert "Set-Cookie" "$thecookie"
      }
   }
}
}
ltm rule /RBIT/iRule_HTTP_RESPONSE_INFH {
when HTTP_REQUEST {
    switch -glob -- [string tolower [HTTP::uri]] { 
    "/" 
    {
    HTTP::respond 301 Location "https://www.ctbcholding.com/content/twhoo/zh_tw/index.html" Cache-Control "no-store, max-age=0" Referrer-Policy "strict-origin-when-cross-origin" Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" Permissions-Policy "camera=(), microphone=(), geolocation=()"
    }
  }
}
when HTTP_RESPONSE {
    HTTP::header remove Server
    HTTP::header remove Range
    HTTP::header remove Request-Range
    HTTP::header insert "X-XSS-Protection" "1; mode=block"
    HTTP::header insert "X-Content-Security-Policy" "default-src 'self'"
    HTTP::header insert "Strict-Transport-Security" "max-age=31536000; includeSubDomains; preload"
    HTTP::header insert "Permissions-Policy" "camera=(), microphone=(), geolocation=()"
    #HTTP::header insert Content-Security-Policy "default-src 'self' *.ctbcholding.com *.ctbcbank.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' *.ctbcholding.com *.ctbcbank.com *.google.com *.google.com.tw connect.facebook.net www.youtube.com; connect-src 'self' 'unsafe-inline'; frame-src 'self' *.ctbcbank.com *.ctbcholding.com www.youtube.com www.youtube-nocookie.com; media-src 'self' www.youtube.com www.youtube-nocookie.com; img-src 'self' data: blob: 'unsafe-inline' *.ctbcholding.com *.ctbcbank.com *.google.com *.google.com.tw; style-src 'self' 'unsafe-inline' *.ctbcbank.com *.ctbcholding.com"
    #HTTP::header insert "Content-Security-Policy" "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' ajax.googleapis.com; connect-src 'self' 'unsafe-inline'; frame-src *; connect-src 'safe' 'unsafe-inline'; media-src 'self' https://www.youtube.com/embed/ https://www.youtube-nocookie.com/embed/; img-src 'self' data: blob: 'unsafe-inline'; sHTTP::header insert "Referrer-Policy" "origin"
    HTTP::header remove X-Powered-By
    HTTP::header remove Server
    if { !([ HTTP::header exists "Content-Security-Policy" ])} {
          HTTP::header insert "Content-Security-Policy" "default-src 'self' *.ctbcbank.com *.ctbcbank.com:18080 *.ctbcholding.com; script-src 'unsafe-eval' 'unsafe-inline' *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 *.google.com *.google.com.tw *.google-analytics.com *.googleapis.com *.googletagmanager.com *.gstatic.com googleads.g.doubleclick.net connect.facebook.net d.line-scdn.net www.youtube.com www.googleadservices.com www.techsolutions.com.tw img.scupio.com jscdn.appier.net bat.bing.com https://tagmanager.google.com https://www.google.com; connect-src * 'unsafe-inline' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com https://*.g.doubleclick.net *.google.com.tw https://cdn.taboola.com; style-src 'self' 'unsafe-inline' https://maxcdn.bootstrapcdn.com *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 fonts.googleapis.com https://tagmanager.google.com ;img-src 'self' 'unsafe-inline' data: blob: *.ctbcholding.com *.ctbcbank.com *.google.com *.google.com.tw *.google-analytics.com *.googletagmanager.com *.gstatic.com *.googleapis.com tr.line.me *.g.doubleclick.net *.analytics.google.com www.facebook.com *.c.appier.net img.scupio.com bat.bing.com https://ssl.gstatic.com www.google.co.jp www.google.ca www.google.co.th www.google.com.hk www.google.com.vn https://googleads.g.doubleclick.net https://www.google.com g.doubleclick.net https://*.taboola.com https://img.hbhousing.com.tw https://img.great-home.com.tw; frame-src 'self' *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 www.youtube.com www.youtube-nocookie.com www.googletagmanager.com bid.g.doubleclick.net img.scupio.com *.c.appier.net sp.analytics.yahoo.com www.facebook.com ; frame-ancestors 'self' ;  object-src 'none'; font-src 'self' *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 fonts.gstatic.com;"  
    }
    else {
          HTTP::header replace "Content-Security-Policy" "default-src 'self' *.ctbcbank.com *.ctbcbank.com:18080 *.ctbcholding.com; script-src 'unsafe-eval' 'unsafe-inline' *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 *.google.com *.google.com.tw *.google-analytics.com *.googleapis.com *.googletagmanager.com *.gstatic.com googleads.g.doubleclick.net connect.facebook.net d.line-scdn.net www.youtube.com www.googleadservices.com www.techsolutions.com.tw img.scupio.com jscdn.appier.net bat.bing.com https://tagmanager.google.com https://www.google.com; connect-src * 'unsafe-inline' https://*.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com https://*.g.doubleclick.net *.google.com.tw https://cdn.taboola.com; style-src 'self' 'unsafe-inline' https://maxcdn.bootstrapcdn.com *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 fonts.googleapis.com https://tagmanager.google.com ;img-src 'self' 'unsafe-inline' data: blob: *.ctbcholding.com *.ctbcbank.com *.google.com *.google.com.tw *.google-analytics.com *.googletagmanager.com *.gstatic.com *.googleapis.com tr.line.me *.g.doubleclick.net *.analytics.google.com www.facebook.com *.c.appier.net img.scupio.com bat.bing.com https://ssl.gstatic.com www.google.co.jp www.google.ca www.google.co.th www.google.com.hk www.google.com.vn https://googleads.g.doubleclick.net https://www.google.com g.doubleclick.net https://*.taboola.com https://img.hbhousing.com.tw https://img.great-home.com.tw; frame-src 'self' *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 www.youtube.com www.youtube-nocookie.com www.googletagmanager.com bid.g.doubleclick.net img.scupio.com *.c.appier.net sp.analytics.yahoo.com www.facebook.com ; frame-ancestors 'self' ;  object-src 'none'; font-src 'self' *.ctbcholding.com *.ctbcbank.com *.ctbcbank.com:18080 fonts.gstatic.com;"  
    }
    if { !([ HTTP::header exists "X-XSS-Protection" ])} {
          HTTP::header insert "X-XSS-Protection" "1; mode=block"  
    }
    if { !([ HTTP::header exists "X-Frame-Options" ])} {
          HTTP::header insert "X-Frame-Options" "SAMEORIGIN"  
    }
    if { !([ HTTP::header exists "Referrer-Policy" ])} {
      HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"  
    }
    else {
      HTTP::header replace "Referrer-Policy" "strict-origin-when-cross-origin"
    }
    if { !([ HTTP::header exists "Cache-Control" ])} {
      HTTP::header insert "Cache-Control" "no-store, max-age=0"  
    }
    else {
      HTTP::header replace "Cache-Control" "no-store, max-age=0"
    }
    set allcookie [HTTP::header values "Set-Cookie"]
    HTTP::header remove "Set-Cookie"
    foreach thecookie $allcookie {
      if {$thecookie starts_with "JSESSIONID"} {
         HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly; SameSite=Lax"
      }
      else {
         HTTP::header insert "Set-Cookie" "$thecookie"
      }
   }
}
}
ltm rule /RBIT/iRule_HTTP_RESPONSE_INMW {
when HTTP_RESPONSE {
 set allcookie [HTTP::header values "Set-Cookie"]
    HTTP::header remove "Set-Cookie"
    HTTP::header remove Range
    HTTP::header remove Request-Range
    HTTP::header insert "X-XSS-Protection" "1; mode=block" 
    HTTP::header insert "X-Content-Security-Policy" "default-src 'self'"
    HTTP::header insert "Strict-Transport-Security" "max-age=31536000; includeSubDomains"
    HTTP::header insert "Referrer-Policy" "origin"
    HTTP::header remove X-Powered-By
    HTTP::header remove Server
    HTTP::header replace Cache-Control no-store
    HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
    foreach thecookie $allcookie {
      if {$thecookie starts_with "TrackedProfileId"} {
         HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly"
      }
       elseif {$thecookie starts_with "ineb_login_token"} {
         HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly"
    } else {
         HTTP::header insert "Set-Cookie" "$thecookie"
      }
   }
}
}
ltm rule /RBIT/iRule_INCM_Bypass {
when HTTP_REQUEST {
 if { [string tolower [HTTP::uri]] starts_with "/mobilebanking/entry?" } {
  if { [string tolower [HTTP::uri]] contains "filename=" } {
    ASM::disable 
    log local0. "[IP::local_addr][HTTP::uri] ASM disabled."
  } else {
     #ASM::enable /RBIT/SP_INHB_Prod
    }
 } else {
    #ASM::enable /RBIT/SP_INHB_Prod
   }
}
}
ltm rule /RBIT/iRule_INCN_dispatch_AP {
when HTTP_REQUEST {
  if { [string tolower [HTTP::host]] contains "ctbcbank.com" } {
   if {  ([string tolower [HTTP::header Referer]]  contains "ctbcbank.com" ) or ( ( [string tolower [HTTP::header Referer]]  =="" ) ) } {

 if { [HTTP::uri] starts_with "/ap/" and ([class match [IP::remote_addr] equals /RBIT/INCN_X5B_ALLOW])}
 {
  HTTP::uri [string map -nocase {"/ap/" "/CTCB_CN/"} [HTTP::uri]]
  snat automap
  pool /RBIT/INCN_POOL_AP_X5B
 } elseif { [HTTP::uri] starts_with "/ap/" }
 {
  HTTP::uri [string map -nocase {"/ap/" "/CTCB_CN/"} [HTTP::uri]]
  snat automap
  pool INCN_POOL_AP
  log local0. "[HTTP::uri] [HTTP::header Referer] to server [LB::server addr][IP::remote_addr]--LeontoX5b"
 }
 elseif { [HTTP::uri] starts_with "/CTCB_CN/" and ([class match [IP::remote_addr] equals /RBIT/INCN_X5B_ALLOW])}
 {
  snat automap
  pool /RBIT/INCN_POOL_AP_X5B
  log local0. "[HTTP::uri] [HTTP::header Referer] to server [LB::server addr] port [LB::server port]--LeontoX5b-CTCB_CN"
 }
 elseif { [HTTP::uri] starts_with "/CTCB_CN/" }
 {
  snat automap
  pool INCN_POOL_AP
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb/" }
 {
  snat automap
  pool INCN_POOL_Portal
 }
 elseif { ([class match [IP::remote_addr] equals /RBIT/INCN_X5B_ALLOW])}
 {
  snat automap
  pool INCN_POOL_WEB_X5B
  #log local0. "[HTTP::uri] [HTTP::header Referer] to server [LB::server addr] port [LB::server port]--LeontoX5b-Web"
 }
 else
 {
  snat automap
  pool INCN_POOL_WEB
    }
   }
 }
}
when LB_FAILED {
 #HTTP::redirect "https://www.chinatrust.com.cn/out_of_service.html"
 HTTP::redirect "https://www.chinatrust.com.cn/cn/html/alert/outOfServicePop.html"
}
}
ltm rule /RBIT/iRule_INEBOP {
when HTTP_REQUEST {
if { [HTTP::uri] starts_with "/EBMW_OP" }
{
    snatpool /EBMW/SNAT_EBMW
    pool /EBMW/POOL_EBMW_OP
}
else
{
    HTTP::respond 403
}
}
when HTTP_RESPONSE {
 set COOKIE_VAL [HTTP::header values "Set-Cookie"]
 HTTP::header remove "Set-Cookie"

 foreach COOKIE_NAME $COOKIE_VAL {
  HTTP::header insert "Set-Cookie" "${COOKIE_NAME};SameSite=None; Secure"
 }
}
}
ltm rule /RBIT/iRule_INEB_2DEV {
when HTTP_REQUEST {

     if { ([HTTP::uri] starts_with "/CTCBPortalWeb/pages/webchat") or ([HTTP::uri] starts_with "/CTCBPortalWeb/servlets/WebchatPicGenServlet") }
 {
        HTTP::respond 301 Location "https://webchat.ctbcbank.com[HTTP::uri]"
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" and ([class match [IP::remote_addr] equals /RBIT/INEB_X5B_ALLOW])}
 {
  snat automap
  pool INEB_POOL_AP_X5B
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" and (![class match [IP::remote_addr] equals /RBIT/INEB_REJECT])}
 {
  snat automap
  pool INEB_POOL_AP_IPsOnly
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }
 {
  snat automap
  pool INEB_POOL_AP
 }
 elseif { [HTTP::uri] equals "/hk" }
 {
        HTTP::respond 302 Location "https://hk.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/hk"
 }
 elseif {([class match [IP::remote_addr] equals /RBIT/INEB_X5B_ALLOW])}
 {
  snat none
  pool INEB_POOL_WEB_X5B
 }
 else {
  snat none
  pool INEB_POOL_WEB_IPsOnly
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}

#  OUT OF Service
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/out_of_service.html"
 #HTTP::redirect "https://www.ctbcbank.com/tw/html/miscellaneous/out_of_service2.html"
}
}
ltm rule /RBIT/iRule_INEB_ACCESS_ADD_HTTP_HEADER {
when HTTP_RESPONSE {
    HTTP::header remove Server
       #X-Frame-Options
       #&#20027;&#27231;&#23553;&#21253;&#27161;&#38957;&#36039;&#35338;&#27945;&#28431;&#20027;&#27231;&#12289;&#22871;&#20214;&#29256;&#26412; X-Powered-By
#       if { [string match -nocase X-* $header_name] }
#       {
#           HTTP::header remove $header_name
#       }
    HTTP::header insert "X-XSS-Protection" "1; mode=block" 
    HTTP::header insert "X-Content-Security-Policy" "default-src 'self'"
    HTTP::header insert "Strict-Transport-Security" "max-age=31536000; includeSubDomains"
      if { !([ HTTP::header exists "Referrer-Policy" ])} {
      HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"  
    }
      else {
      HTTP::header replace "Referrer-Policy" "strict-origin-when-cross-origin"
    }
    #HTTP::header insert "Cache-Control" "no-store, max-age=0"
      if { !([ HTTP::header exists "Cache-Control" ])} {
      HTTP::header insert "Cache-Control" "no-store, max-age=0"  
    }
    HTTP::header insert "X-Content-Type-Options" "nosniff"
    if { !( [HTTP::header exists "X-Frame-Options"]) }{
    HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
    }
    HTTP::header insert "Content-Security-Policy" "default-src 'self' 'unsafe-inline' 'unsafe-eval' *.ctbcbank.com *.google.com *.google.com.tw *.google-analytics.com *.googleapis.com *.googletagmanager.com fonts.gstatic.com; script-src 'unsafe-eval' 'unsafe-inline' *.ctbcbank.com *.google.com *.google.com.tw *.google-analytics.com *.googleapis.com *.googletagmanager.com www.gstatic.com googleads.g.doubleclick.net connect.facebook.net d.line-scdn.net; connect-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline' maxcdn.bootstrapcdn.com *.ctbcbank.com fonts.googleapis.com; img-src 'self' 'unsafe-inline' data: blob: *.ctbcbank.com *.google.com *.google.com.tw *.google-analytics.com *.googletagmanager.com maps.google.com maps.gstatic.com maps.googleapis.com; frame-src 'self' data: blob: *.ctbcbank.com; frame-ancestors 'self'; object-src 'none';"  
    #HTTP::header insert Content-Security-Policy "default-src * 'unsafe-inline' 'unsafe-eval'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; connect-src * 'unsafe-inline'; img-src * data: blob: 'unsafe-inline'; frame-src * data: blob:; style-src * 'unsafe-inline'; frame-ancestors 'self'"
      if { !([ HTTP::header exists "Permissions-Policy" ])} {
      HTTP::header insert "Permissions-Policy" "camera=(), microphone=(), geolocation=(), midi=()"  
    }
      else {
      HTTP::header replace "Permissions-Policy" "camera=(), microphone=(), geolocation=(), midi=()"
    }
	set allcookie [HTTP::header values "Set-Cookie"]
	HTTP::header remove "Set-cookie"
	foreach thecookie $allcookie {
	   #HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly; SameSite=Lax"
	   HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly; SameSite=Strict"
	}
}
}
ltm rule /RBIT/iRule_INEB_Blocked_IP {
when HTTP_REQUEST {
if { ([class match [IP::client_addr] equals /RBIT/INEB_REJECT])} {
reject
log local0. "[IP::client_addr] INEB Block IP Address!!"
}
}
}
ltm rule /RBIT/iRule_INEB_dispatch_without_persist {
when HTTP_REQUEST {
	 if { [HTTP::has_responded] } { return }; 
     if { ([HTTP::uri] starts_with "/CTCBPortalWeb/pages/webchat") or ([HTTP::uri] starts_with "/CTCBPortalWeb/servlets/WebchatPicGenServlet") }
 {
        HTTP::respond 301 Location "https://webchat.ctbcbank.com[HTTP::uri]"
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }
 {
  snat automap
  pool INEB_POOL_AP
 }
 elseif { [HTTP::uri] equals "/hk" }
 {
        HTTP::respond 302 Location "https://hk.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/hk"
 } else {
  snat none
  pool INEB_POOL_WEB
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}

#  OUT OF Service
when LB_FAILED {
  #HTTP::redirect "https://www.ctbcbank.com/out_of_service.html"
  HTTP::redirect "https://www.ctbcbank.com/tw/html/miscellaneous/out_of_service2.html"
}
}
ltm rule /RBIT/iRule_INHB_dispatch_without_persist_internal {
when HTTP_REQUEST {
 if { [HTTP::uri] starts_with "/MobileBanking" }
 {
 	snat automap
 	#pool INHB_POOL_AP
        pool /RBIT/INHB_POOL_AP_Internal
        #pool /RBIT/INHB_POOL_AP_X5B
  #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--LeonAP"
 }
 elseif { [HTTP::uri] starts_with "/WEB" }
 {
   HTTP::uri [string map -nocase {"/WEB" ""} [HTTP::uri]]
 	snat automap
 	pool /RBIT/INHB_POOL_WEB
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--WEB"
 }
 elseif { [HTTP::uri] starts_with "/WSM_Gateway" }
 {

 	snat automap
 	pool /RBIT/INOTP_POOL_AP
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--INOTP_POOL_AP"
 }
 else
 {
   snat automap
   pool /RBIT/INHB_POOL_WEB
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
 }
}

when LB_FAILED {
 HTTP::redirect "https://mb.chinatrust.com.tw/error123.html"
}
}
ltm rule /RBIT/iRule_INHB_dispatch_without_persist_mb {
when HTTP_REQUEST {
 if { [HTTP::uri] starts_with "/MobileBanking" }
 {
 	snat automap
 	pool INHB_POOL_AP
  #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--LeonAP"
 }
 elseif { [HTTP::uri] starts_with "/WEB" }
 {
   HTTP::uri [string map -nocase {"/WEB" ""} [HTTP::uri]]
 	snat automap
 	pool INHB_POOL_WEB
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--WEB"
 }
 elseif { [HTTP::uri] starts_with "/WSM_Gateway" }
 {

 	snat automap
 	pool INOTP_POOL_AP
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--INOTP_POOL_AP"
 }
 else
 {
   snat automap
   pool INHB_POOL_WEB
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
 }
}

when LB_FAILED {
 HTTP::redirect "https://mb.chinatrust.com.tw/error123.html"
}
}
ltm rule /RBIT/iRule_INHK_dispatch_AP {
when HTTP_REQUEST {
	if { [HTTP::has_responded] } { return };
    if { [HTTP::uri] starts_with "/CTCBPortalWeb" }
 {
  snat automap
  pool INHK_POOL_AP
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
 }
 else {
  snat automap
  #snat none
  pool /EBMW/POOL_EBMW_WEB_inhk
  #pool INHK_POOL_WEB
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
when LB_FAILED {
 #HTTP::redirect "https://www.chinatrust.com.hk/out_of_service.html"
 HTTP::redirect "https://www.chinatrust.com.hk/tw/html/common/hk_out_of_service.htm"
}
}
ltm rule /RBIT/iRule_INHK_dispatch_AP_internal {
when HTTP_REQUEST {
	if { [HTTP::has_responded] } { return };
    if { [HTTP::uri] starts_with "/CTCBPortalWeb" and ([class match [IP::remote_addr] equals /RBIT/INHK_X5B_ALLOW]) }
 {
  #snat automap
  snatpool SNAT_HKINEB
  pool /RBIT/INHK_POOL_AP_X5B
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }
 {
  #snat automap
  snatpool SNAT_HKINEB
  pool INHK_POOL_AP
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
 }
 else {
  #snat automap
  snatpool SNAT_HKINEB
  #snat none
  pool /EBMW/POOL_EBMW_WEB_inhk
#  pool INHK_POOL_WEB
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
when LB_FAILED {
 #HTTP::redirect "https://www.chinatrust.com.hk/out_of_service.html"
 HTTP::redirect "https://www.chinatrust.com.hk/tw/html/common/hk_out_of_service.htm"
}
}
ltm rule /RBIT/iRule_INMW_301_redirect_Production {
when HTTP_REQUEST {
if { [HTTP::has_responded] } { return };
if { [HTTP::uri] starts_with "/MobileWeb/c_FlexCash/ccInstlmtCfg2/init" }
{
        HTTP::respond 302 Location "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/cc_service/cc_service_finances_index/cc_service_finances_fca.html"
}
if { [HTTP::uri] starts_with "/MobileWeb/c_Loan/otpCreditLoan/init" }
{
        HTTP::respond 302 Location "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/loan_service_ploan_apply.html"
}
}
}
ltm rule /RBIT/iRule_INMW_301_redirect_Production_close {
when HTTP_REQUEST {
if { [HTTP::uri] starts_with "/MobileWeb/c_FlexCash/ccInstlmtCfg2/init" }
{
        HTTP::respond 302 Location "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/cc_service/cc_service_finances_index/cc_service_finances_fca.html"
}
elseif { [HTTP::uri] starts_with "/MobileWeb/c_Loan/otpCreditLoan/init" }
{
        HTTP::respond 302 Location "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/loan_service_ploan_apply.html"
}
elseif { [HTTP::uri] starts_with "/MobileWeb/uc_Leads/loanLeads" }
{
        HTTP::respond 302 Location "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/various_services/getleads_index/getleads_ploan1.html"
} 
}
}
ltm rule /RBIT/iRule_INMW_Internal {
when HTTP_REQUEST {

  if  { ([class match [IP::remote_addr] equals /RBIT/INEB_X5B_ALLOW]) }
 {
  #snat automap
  pool  POOL_INMW_AP_Internal 
 }
 else {
  #snat none
  pool POOL_INMW_AP
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
}
ltm rule /RBIT/iRule_INMW_remove_X_Header {
when HTTP_RESPONSE {
HTTP::header insert "X-Frame-Options" "SAMEORIGIN"
HTTP::header remove X-Powered-By
HTTP::header remove Server
HTTP::header replace Cache-Control no-store
}
}
ltm rule /RBIT/iRule_INWA_dispatch {
when HTTP_REQUEST {
   if { [HTTP::has_responded] } { return };
     if {[HTTP::uri] equals "/WebATM/help/user01.htm" }
     {
        HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/digital_service/digital_service_webatm.html"
     }elseif {[HTTP::uri] equals "/WebATM/help/safe.htm" }
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/help/safe.html"
     }elseif {[HTTP::uri] equals "/WebATM/help/question01.htm" }
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/help/QA.html"
     }elseif {[HTTP::uri] equals "/WebATM/help/download.htm" }
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/help/download.html"
     }elseif { ([HTTP::uri] starts_with "/WebATM") or ([HTTP::uri] equals "/") or ([HTTP::uri] equals "") } 
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/login.jsp"
     } elseif {[HTTP::uri] starts_with "/AccessibleWebATM" }
     {
        pool INAWA_POOL_AP
     } else {
        HTTP::respond 403
        return;
     }
}
}
ltm rule /RBIT/iRule_INWA_dispatch_Intra {
when HTTP_REQUEST {
   if { [HTTP::has_responded] } { return };
     if {[HTTP::uri] equals "/WebATM/help/user01.htm" }
     {
        HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/digital_service/digital_service_webatm.html"
     }elseif {[HTTP::uri] equals "/WebATM/help/safe.htm" }
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/help/safe.html"
     }elseif {[HTTP::uri] equals "/WebATM/help/question01.htm" }
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/help/QA.html"
     }elseif {[HTTP::uri] equals "/WebATM/help/download.htm" }
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/help/download.html"
     }elseif { ([HTTP::uri] starts_with "/WebATM") or ([HTTP::uri] equals "/") or ([HTTP::uri] equals "") } 
     {
        HTTP::redirect "https://eatm.ctbcbank.com/AccessibleWebATM/login.jsp"
     } elseif {[HTTP::uri] starts_with "/AccessibleWebATM" }
     {
        pool INAWA_POOL_AP_INTRA
     } else {
        HTTP::respond 403
        return;
     }
}
}
ltm rule /RBIT/iRule_INWA_dispatch_RemoveHeader {
when HTTP_REQUEST {
    # remove Range requests for CVE-2011-3192
    HTTP::header remove Range
    HTTP::header remove Request-Range
}
}
ltm rule /RBIT/iRule_INWA_dispatch_setCookie {
when HTTP_RESPONSE {
   HTTP::header insert "X-Frame-Options" "SAMEORIGIN"

   if {  !([ HTTP::header exists "Cache-Control" ])} {
      HTTP::header insert "Cache-Control" "no-store, no-cache"  
   }  

   if {  !([ HTTP::header exists "X-XSS-Protection" ])} {
      HTTP::header insert "X-XSS-Protection" "1; mode=block"  
   }

   if { !([ HTTP::header exists "content-security-policy " ])} { 
      HTTP::header insert "content-security-policy" "default-src 'self';style-src 'self' 'unsafe-inline';connect-src https://localhost:48220 https://localhost:48221 https://localhost:48222 https://*.ctbcbank.com 'unsafe-inline';frame-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; object-src 'none'; base-uri 'none';frame-ancestors 'self' https://eatm.ctbcbank.com" 
   }

   if {  !([ HTTP::header exists "Referrer-Policy" ])} {
   HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"
   }  

   if {  !([ HTTP::header exists "X-Content-Type-Options" ])} {
      HTTP::header insert "X-Content-Type-Options" "nosniff"
   }  

   if { !([HTTP::header exists "Strict-Transport-Security"])} {
      HTTP::header insert "Strict-Transport-Security" "max-age=31536000; includeSubdomains"
   }

   if {  !([ HTTP::header exists "Permissions-Policy" ])} {
      HTTP::header insert "Permissions-Policy" "geolocation=(),microphone=(),camera=()"
   }  

   set allcookie [HTTP::header values "Set-Cookie"]
   HTTP::header remove "Set-Cookie"

   foreach thecookie $allcookie {
      if {$thecookie starts_with "JSESSIONID"} {
         HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly;SameSite=Strict"
      } else {
         HTTP::header insert "Set-Cookie" "$thecookie;SameSite=Strict"
      }
   }
}
}
ltm rule /RBIT/iRule_INWA_dispatch_without_persist {
when HTTP_REQUEST {
     if {[HTTP::uri] equals "/" } {
         HTTP::redirect "https://eatm.ctbcbank.com/WebATM/login.jsp"
     } elseif {[HTTP::uri] equals "/WebATM"}{
         HTTP::redirect "https://eatm.ctbcbank.com/WebATM/login.jsp"
     } elseif {[HTTP::uri] equals ""}{
         HTTP::redirect "https://eatm.ctbcbank.com/WebATM/login.jsp"
     } else {
  pool INWA_POOL_AP_INTRA
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
#  OUT OF Service
when LB_FAILED {
 #HTTP::redirect "https://www.ctbcbank.com/out_of_service.html"
 HTTP::redirect "https://www.ctbcbank.com/tw/html/miscellaneous/out_of_service2.html"
}
when HTTP_RESPONSE {
if { [HTTP::is_redirect] && [string tolower [HTTP::header Location]] starts_with "http://"} {
        HTTP::respond 302 Location [string map -nocase {http:// https://} [HTTP::header Location]]
    }
}
}
ltm rule /RBIT/iRule_Lotto_HTTP_RESPONSE {
when HTTP_RESPONSE {
    HTTP::header remove Server
    HTTP::header remove Range
    HTTP::header remove Request-Range
    HTTP::header insert "X-Content-Security-Policy" "default-src 'self'"
    HTTP::header insert "Strict-Transport-Security" "max-age=31536000; includeSubDomains; preload"
    HTTP::header insert "Permissions-Policy" "camera=(), microphone=(), geolocation=()"
    #HTTP::header insert "Content-Security-Policy" "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' ajax.googleapis.com; connect-src 'self' 'unsafe-inline'; frame-src *; connect-src 'safe' 'unsafe-inline'; media-src 'self' https://www.youtube.com/embed/ https://www.youtube-nocookie.com/embed/; img-src 'self' data: blob: 'unsafe-inline'; style-src 'self' 'unsafe-inline'"
    HTTP::header insert "Content-Security-Policy" "default-src 'self'; object-src 'none'; frame-ancestors 'self'"
    HTTP::header insert "Referrer-Policy" "strict-origin-when-cross-origin"
    HTTP::header remove X-Powered-By
    HTTP::header remove Server
### Cache-Control
    if { !([ HTTP::header exists "X-XSS-Protection" ])} {
          HTTP::header insert "X-XSS-Protection" "1; mode=block"  
    }
    if { !([ HTTP::header exists "Cache-Control" ])} {
      HTTP::header insert "Cache-Control" "no-store, max-age=0"  
    }
    else {
      HTTP::header replace "Cache-Control" "no-store, max-age=0"
    }
    set allcookie [HTTP::header values "Set-Cookie"]
    HTTP::header remove "Set-Cookie"
    foreach thecookie $allcookie {
      if {$thecookie starts_with "JSESSIONID"} {
         HTTP::header insert "Set-Cookie" "${thecookie}; secure; HttpOnly; SameSite=Lax"
      }
      else {
         HTTP::header insert "Set-Cookie" "$thecookie"
      }
   }
}
}
ltm rule /RBIT/iRule_Redirect_http2https {
when HTTP_REQUEST {
      HTTP::redirect "https://[HTTP::host][HTTP::uri]"
}
}
ltm rule /RBIT/iRule_Redirect_mobilepage {
when CLIENT_ACCEPTED {
#        log local0. "OOOXXXX  [IP::client_addr]  [IP::remote_addr] [IP::local_addr]"
}
when HTTP_REQUEST {
   if {[HTTP::uri] starts_with "/CTCBPortalWeb/appmanager/ebank/mb"}
 {
        HTTP::redirect "https://mobilepage.ctbcbank.com[HTTP::uri]"
#        HTTP::redirect "https://mobilepage.ctbcbank.com/reindex_mobilepage.html"
}
}
}
ltm rule /RBIT/iRule_TEST {
when HTTP_REQUEST {
if { ([HTTP::uri] ends_with "/adapters/EBMW_Adapter/health")}
{
   HTTP::respond 403
   log "BRANDON1"
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
  log "BRANDON2"
 }
elseif { ([HTTP::uri] starts_with "/webads") or ([HTTP::uri] starts_with "/jscollection") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
   log "BRANDON3"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { ([HTTP::uri] starts_with "/content/twrbo") && not([string tolower [HTTP::header User-Agent]] contains "googlebot") }
{
   set uri [string map -nocase {"/content/twrbo" "/twrbo"} [HTTP::uri]]
   HTTP::uri $uri
   HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
      log "BRANDON4"
}
elseif {([HTTP::uri] ends_with "/appmanager/ebank/cb") or ([HTTP::uri] ends_with "/appmanager/ebank/cb_en") }
{
  snatpool SNAT_INEB
  pool /RBIT/INEB_POOL_AP
       log "BRANDON5"
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
  log "BRANDON6"
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /RBIT/INEB_POOL_WEB
   log "BRANDON7"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB
    log "BRANDON8"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/twrbo/out_of_service.html"
     log "BRANDON9"
}
}
ltm rule /RBIT/iRule_TEST2 {
when HTTP_REQUEST {
if { ([HTTP::uri] contains "/IB/api/adapters/EBMW_Adapter/health")}
{
   HTTP::respond 403
   log "BRANDON1"
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
  log "BRANDON2"
 }
elseif { ([HTTP::uri] starts_with "/webads") or ([HTTP::uri] starts_with "/jscollection") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
   log "BRANDON3"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { ([HTTP::uri] starts_with "/content/twrbo") && not([string tolower [HTTP::header User-Agent]] contains "googlebot") }
{
   set uri [string map -nocase {"/content/twrbo" "/twrbo"} [HTTP::uri]]
   HTTP::uri $uri
   HTTP::respond 302 noserver Location "https://[HTTP::host][HTTP::uri]"
      log "BRANDON4"
}
elseif {([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb") or ([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb_en") }
{
  snatpool SNAT_INEB
  pool /RBIT/INEB_POOL_AP
       log "BRANDON5"
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
  log "BRANDON6"
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /RBIT/INEB_POOL_WEB
   log "BRANDON7"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB
    log "BRANDON8"
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/ctbc-ib/zh_rb/general/out_of_service.html"
     log "BRANDON9"
}
}
ltm rule /RBIT/iRule_deny_010001 {
when HTTP_REQUEST {
 if { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_gold_010001" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_gold_010001&_windowLabel=T19207110471340782242248" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_windowLabel=T19207110471340782242248&_pageLabel=TW_RB_TX_gold_010001" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_gold_010001&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_gold_010001&_windowLabel=T19207110471340782242248&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T19207110471340782242248&_pageLabel=TW_RB_TX_gold_010001&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_gold_010001&_nfpb=true&_windowLabel=T19207110471340782242248" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T19207110471340782242248&_nfpb=true&_pageLabel=TW_RB_TX_gold_010001" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } 
}
}
ltm rule /RBIT/iRule_deny_300013 {
when HTTP_REQUEST {
 if { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_mfund_300013" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_mfund_300013&_windowLabel=T16809267151337676433036" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_windowLabel=T16809267151337676433036&_pageLabel=TW_RB_TX_mfund_300013" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_mfund_300013&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_mfund_300013&_windowLabel=T16809267151337676433036&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T16809267151337676433036&_pageLabel=TW_RB_TX_mfund_300013&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_mfund_300013&_nfpb=true&_windowLabel=T16809267151337676433036" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T16809267151337676433036&_nfpb=true&_pageLabel=TW_RB_TX_mfund_300013" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } 
}
}
ltm rule /RBIT/iRule_deny_300021 {
when HTTP_REQUEST {
 if { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_mfund_300021" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_mfund_300021&_windowLabel=T16820167151337739599088" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_windowLabel=T16820167151337739599088&_pageLabel=TW_RB_TX_mfund_300021" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_mfund_300021&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_mfund_300021&_windowLabel=T16820167151337739599088&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T16820167151337739599088&_pageLabel=TW_RB_TX_mfund_300021&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_mfund_300021&_nfpb=true&_windowLabel=T16820167151337739599088" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T16820167151337739599088&_nfpb=true&_pageLabel=TW_RB_TX_mfund_300021" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } 
}
}
ltm rule /RBIT/iRule_deny_470195 {
when HTTP_REQUEST {
 if { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_ebank_470195" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_ebank_470195&_windowLabel=T24004547331358759163564" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_windowLabel=T24004547331358759163564&_pageLabel=TW_RB_TX_ebank_470195" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_ebank_470195&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_ebank_470195&_windowLabel=T24004547331358759163564&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T24004547331358759163564&_pageLabel=TW_RB_TX_ebank_470195&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_ebank_470195&_nfpb=true&_windowLabel=T24004547331358759163564" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T24004547331358759163564&_nfpb=true&_pageLabel=TW_RB_TX_ebank_470195" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } 
}
}
ltm rule /RBIT/iRule_deny_830005 {
when HTTP_REQUEST {
 if { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_ebank_830005" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_pageLabel=TW_RB_TX_ebank_830005&_windowLabel=T40800130941486552236546" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_nfpb=true&_windowLabel=T40800130941486552236546&_pageLabel=TW_RB_TX_ebank_830005" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_ebank_830005&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_ebank_830005&_windowLabel=T40800130941486552236546&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T40800130941486552236546&_pageLabel=TW_RB_TX_ebank_830005&_nfpb=true" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_pageLabel=TW_RB_TX_ebank_830005&_nfpb=true&_windowLabel=T40800130941486552236546" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"

 } elseif { [HTTP::uri] equals "/CTCBPortalWeb/appmanager/ebank/rb?_windowLabel=T40800130941486552236546&_nfpb=true&_pageLabel=TW_RB_TX_ebank_830005" }
 {
        HTTP::redirect "https://www.ctbcbank.com/CTCBPortalWeb/appmanager/ebank/rb"
 } 
}
}
ltm rule /RBIT/iRule_deny_InebCacheManagerServlet {
when HTTP_REQUEST {
 if { [HTTP::uri] contains "InebCacheManagerServlet" }
 {
        HTTP::redirect "https://www.ctbcbank.com/"
 }
}
}
ltm rule /RBIT/iRule_deny_captchaServlet {
when HTTP_REQUEST {
 if { [HTTP::uri] contains "RandomFontServlet" or [HTTP::uri] contains "LoginShearCaptchaServlet" or [HTTP::uri] contains "LoginBotdetectCaptchaServlet" }
 {
        HTTP::redirect "https://www.ctbcbank.com/"
 }
}
}
ltm rule /RBIT/iRule_deny_mobilepage {
when HTTP_REQUEST {
    if { [HTTP::uri] contains "TW_MB_TX_" }
 {
        HTTP::redirect "https://www.ctbcbank.com/redirect2mobilepage.html"
 }
}
}
ltm rule /RBIT/iRule_dispatch_EBMWIB {
when HTTP_REQUEST {
if { ([HTTP::uri] contains "/IB/api/adapters/IB_Adapter/resource/health/check")}
{
   HTTP::respond 403
 }
 elseif { ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/ebmwResource-covid") or ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/preLogin-covid")}
 {
        snatpool SNAT_INEB
        pool /EBMW/POOL_EBMW_WEB_COVID
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
 }
elseif { ([HTTP::uri] starts_with "/webads") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { ( [HTTP::uri] starts_with "/twrbo" ) && not (( [HTTP::uri] contains "/twrbo/zh_tw/index.html" ) || ( [HTTP::uri] contains "/twrbo/zh_tw/dep_index/dep_ratequery" )) }
{
    snatpool SNAT_INEB
    pool /EBMW/POOL_EBMW_WEB
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/") }
{
    snatpool SNAT_INEB
    rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { [HTTP::uri] starts_with "/eCoupon" }
{
    snatpool SNAT_INEB
    rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_ECOUPON
}
elseif {([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb") or ([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb_en") }
{
  #snatpool SNAT_INEB
  HTTP::redirect "https://www.ctbcbank.com/content/twcbo/zh_tw/index.html"
  #pool /RBIT/INEB_POOL_AP
 }
elseif { [HTTP::uri] contains "/twhoo" }
{
  HTTP::respond 403
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /RBIT/INEB_POOL_WEB
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/ctbc-ib/zh_rb/general/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_EBMWIB_Div {
when HTTP_REQUEST {
if { [HTTP::has_responded] } { return };
if { ([HTTP::uri] contains "/IB/api/adapters/IB_Adapter/resource/health/check")}
{
   HTTP::respond 403
 }
 elseif { ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/ebmwResource-covid") or ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/preLogin-covid")}
 {
        snatpool SNAT_INEB
        pool /EBMW/POOL_EBMW_WEB_COVID
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
 }
elseif { ([HTTP::uri] starts_with "/webads") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { [HTTP::uri] starts_with "/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/labor2021.html" }
{
  HTTP::redirect "https://m.ctbcbank.com/MobileWeb/uc_Leads/loanLeads"
}
elseif { ( [HTTP::uri] starts_with "/twrbo" ) && not (( [HTTP::uri] contains "/twrbo/zh_tw/index.html" ) || ( [HTTP::uri] contains "/twrbo/zh_tw/dep_index/dep_ratequery" )) }
{
    snatpool SNAT_INEB
    pool /EBMW/POOL_EBMW_WEB
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/") }
{
    snatpool SNAT_INEB
    rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { [HTTP::uri] starts_with "/eCoupon" }
{
    snatpool SNAT_INEB
    rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_ECOUPON
}
elseif {([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb") or ([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb_en") }
{
  #snatpool SNAT_INEB
  HTTP::redirect "https://www.ctbcbank.com/content/twcbo/zh_tw/index.html"
  #pool /RBIT/INEB_POOL_AP
 }
elseif { [HTTP::uri] contains "/twhoo" }
{
  HTTP::respond 403
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /RBIT/INEB_POOL_WEB
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/ctbc-ib/zh_rb/general/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_EBMWIB_close_door {
when HTTP_REQUEST {
if { [HTTP::has_responded] } { return };
if { ([HTTP::uri] contains "/IB/api/adapters/IB_Adapter/resource/health/check")}
{
   HTTP::respond 403
 }
 elseif { ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/ebmwResource-covid") or ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/preLogin-covid")}
 {
        snatpool SNAT_INEB
        pool /EBMW/POOL_EBMW_WEB_COVID
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  HTTP::header insert Client-Port [TCP::client_port]
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
 }
elseif { ([HTTP::uri] starts_with "/webads") }
{
 # &#27298;&#26597;&#26159;&#21542;&#24050;&#32147;&#26377; Cookies
 if { [HTTP::cookie exists "v1st"] } {
       # &#22914;&#26524;&#24050;&#23384;&#22312;&#65292;&#21487;&#20197;&#22312;&#36889;&#35041;&#36914;&#34892;&#30456;&#25033;&#34389;&#29702;
   } else {
       # &#29983;&#25104;&#19968;&#20491;&#38263;&#24230;&#28858; 16 &#30340;&#38568;&#27231;&#23383;&#20018;&#65292;&#21253;&#21547; 0-9 &#21644; A-F
       set characters "123456789ABCDEF"
       set random_value ""
       for {set i 0} {$i < 16} {incr i} {
           append random_value [string index $characters [expr {int(rand() * [string length $characters])}]]
       }
       # &#26032;&#22686;&#21517;&#28858; "v1st" &#30340; Cookies&#65292;&#20540;&#28858;&#38568;&#27231;&#23383;&#20018;
       HTTP::respond 200 "Set-Cookie" "v1st=$random_value; Path=/; Secure; SameSite=None; HttpOnly; expires=Fri, 31 Dec 2123 23:59:59 GMT"
 }

 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { [HTTP::uri] starts_with "/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/labor2021.html" }
{
  HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/various_services/getleads_index/getleads_ploan1.html"
}
elseif { ( [HTTP::uri] starts_with "/twrbo" ) && not (( [HTTP::uri] contains "/twrbo/zh_tw/index.html" ) || ( [HTTP::uri] contains "/twrbo/zh_tw/dep_index/dep_ratequery" )) }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_300m
    pool /EBMW/POOL_EBMW_WEB
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/imessage/") }
{
    snatpool SNAT_INEB
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/") }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { [HTTP::uri] starts_with "/eCoupon" }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_ECOUPON
}
elseif {([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb") or ([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb_en") }
{
  #snatpool SNAT_INEB
  HTTP::redirect "https://www.ctbcbank.com/content/twcbo/zh_tw/index.html"
  #pool /RBIT/INEB_POOL_AP
 }
elseif { [HTTP::uri] contains "/twhoo" }
{
  HTTP::respond 403
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB_ineb
 #pool /RBIT/INEB_POOL_WEB
}
elseif { ([HTTP::uri] starts_with "/mfe") }
{
   snatpool SNAT_INEB
   pool /EBMW/POOL_MFE_AP
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/ctbc-ib/zh_rb/general/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_EBMWIB_close_door2 {
when HTTP_REQUEST {
if { [HTTP::has_responded] } { return };
if { ([HTTP::uri] contains "/IB/api/adapters/IB_Adapter/resource/health/check")}
{
   HTTP::respond 403
 }
 elseif { ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/ebmwResource-covid") or ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/preLogin-covid")}
 {
        snatpool SNAT_INEB
        pool /EBMW/POOL_EBMW_WEB_COVID
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  HTTP::header insert Client-Port [TCP::client_port]
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
 }
elseif { ([HTTP::uri] starts_with "/webads") }
{
 # &#27298;&#26597;&#26159;&#21542;&#24050;&#32147;&#26377; Cookies
 if { [HTTP::cookie exists "v1st"] } {
       # &#22914;&#26524;&#24050;&#23384;&#22312;&#65292;&#21487;&#20197;&#22312;&#36889;&#35041;&#36914;&#34892;&#30456;&#25033;&#34389;&#29702;
   } else {
       # &#29983;&#25104;&#19968;&#20491;&#38263;&#24230;&#28858; 16 &#30340;&#38568;&#27231;&#23383;&#20018;&#65292;&#21253;&#21547; 0-9 &#21644; A-F
       set characters "123456789ABCDEF"
       set random_value ""
       for {set i 0} {$i < 16} {incr i} {
           append random_value [string index $characters [expr {int(rand() * [string length $characters])}]]
       }
       # &#26032;&#22686;&#21517;&#28858; "v1st" &#30340; Cookies&#65292;&#20540;&#28858;&#38568;&#27231;&#23383;&#20018;
       HTTP::respond 200 "Set-Cookie" "v1st=$random_value; Path=/; Secure; SameSite=None; HttpOnly; expires=Fri, 31 Dec 2123 23:59:59 GMT"
 }

 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { [HTTP::uri] starts_with "/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/labor2021.html" }
{
  HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/various_services/getleads_index/getleads_ploan1.html"
}
elseif { ([HTTP::uri] starts_with "/twrbo/zh_tw/onlinecounter_index/digital_service/security.html") }
{
    HTTP::redirect https://[HTTP::host]/twrbo/zh_tw/esg_index/esg_anti-fraud/security.html
}
elseif { ([HTTP::uri] starts_with "/twrbo/zh_tw/esg_index/esg_accessibility/fraud_prevention.html") }
{
    HTTP::redirect https://[HTTP::host]/twrbo/zh_tw/esg_index/esg_anti-fraud/fraud_prevention.html
}
elseif { ( [HTTP::uri] starts_with "/twrbo" ) && not (( [HTTP::uri] contains "/twrbo/zh_tw/index.html" ) || ( [HTTP::uri] contains "/twrbo/zh_tw/dep_index/dep_ratequery" )) }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_300m
    pool /EBMW/POOL_EBMW_WEB_65
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/imessage/") }
{
    snatpool SNAT_INEB
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/") }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { [HTTP::uri] starts_with "/eCoupon" }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_ECOUPON
}
elseif {([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb") or ([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb_en") }
{
  #snatpool SNAT_INEB
  HTTP::redirect "https://www.ctbcbank.com/content/twcbo/zh_tw/index.html"
  #pool /RBIT/INEB_POOL_AP
 }
elseif { [HTTP::uri] contains "/twhoo" }
{
  HTTP::respond 403
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB_ineb
 #pool /RBIT/INEB_POOL_WEB
}
elseif { ([HTTP::uri] starts_with "/mfe") }
{
   snatpool SNAT_INEB
   pool /EBMW/POOL_MFE_AP
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB_65
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/ctbc-ib/zh_rb/general/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_EBMWIB_close_door_20240429 {
when HTTP_REQUEST {
if { [HTTP::has_responded] } { return };
if { ([HTTP::uri] contains "/IB/api/adapters/IB_Adapter/resource/health/check")}
{
   HTTP::respond 403
 }
 elseif { ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/ebmwResource-covid") or ([HTTP::uri] starts_with "/IB/api/adapters/IB_Adapter/resource/preLogin-covid")}
 {
        snatpool SNAT_INEB
        pool /EBMW/POOL_EBMW_WEB_COVID
 }
 elseif { [HTTP::uri] starts_with "/IB/api" }{
  HTTP::header insert Client-Port [TCP::client_port]
  snatpool SNAT_INEB
  pool /EBMW/POOL_EBMWIB_AP
 }
elseif { ([HTTP::uri] starts_with "/webads") }
{
 # &#27298;&#26597;&#26159;&#21542;&#24050;&#32147;&#26377; Cookies
 if { [HTTP::cookie exists "v1st"] } {
       # &#22914;&#26524;&#24050;&#23384;&#22312;&#65292;&#21487;&#20197;&#22312;&#36889;&#35041;&#36914;&#34892;&#30456;&#25033;&#34389;&#29702;
   } else {
       # &#29983;&#25104;&#19968;&#20491;&#38263;&#24230;&#28858; 16 &#30340;&#38568;&#27231;&#23383;&#20018;&#65292;&#21253;&#21547; 0-9 &#21644; A-F
       set characters "123456789ABCDEF"
       set random_value ""
       for {set i 0} {$i < 16} {incr i} {
           append random_value [string index $characters [expr {int(rand() * [string length $characters])}]]
       }
       # &#26032;&#22686;&#21517;&#28858; "v1st" &#30340; Cookies&#65292;&#20540;&#28858;&#38568;&#27231;&#23383;&#20018;
       HTTP::respond 200 "Set-Cookie" "v1st=$random_value; Path=/; Secure; SameSite=None; HttpOnly; expires=Fri, 31 Dec 2123 23:59:59 GMT"
 }

 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_TAG
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
elseif { [HTTP::uri] starts_with "/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/labor2021.html" }
{
  HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/various_services/getleads_index/getleads_ploan1.html"
}
elseif { ([HTTP::uri] starts_with "/twrbo/zh_tw/onlinecounter_index/digital_service/security.html") }
{
    HTTP::redirect https://[HTTP::host]/twrbo/zh_tw/esg_index/esg_anti-fraud/security.html
}
elseif { ([HTTP::uri] starts_with "/twrbo/zh_tw/esg_index/esg_accessibility/fraud_prevention.html") }
{
    HTTP::redirect https://[HTTP::host]/twrbo/zh_tw/esg_index/esg_anti-fraud/fraud_prevention.html
}
elseif { ( [HTTP::uri] starts_with "/twrbo" ) && not (( [HTTP::uri] contains "/twrbo/zh_tw/index.html" ) || ( [HTTP::uri] contains "/twrbo/zh_tw/dep_index/dep_ratequery" )) }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_300m
    pool /EBMW/POOL_EBMW_WEB
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/imessage/") }
{
    snatpool SNAT_INEB
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { ([HTTP::uri] contains "/content/dam/minisite/") }
{
    snatpool SNAT_INEB
    #rateclass /Common/Rate_Class_EBMWIB_200m
    pool /EBMW/POOL_EBMW_WEB_minisite
}
elseif { [HTTP::uri] starts_with "/eCoupon" }
{
    snatpool SNAT_INEB
    rateclass /Common/Rate_Class_EBMWIB_800m
    pool /EBMW/POOL_EBMW_WEB_ECOUPON
}
elseif {([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb") or ([HTTP::uri] contains "/CTCBPortalWeb/appmanager/ebank/cb_en") }
{
  #snatpool SNAT_INEB
  HTTP::redirect "https://www.ctbcbank.com/content/twcbo/zh_tw/index.html"
  #pool /RBIT/INEB_POOL_AP
 }
elseif { [HTTP::uri] contains "/twhoo" }
{
  HTTP::respond 403
 }
elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMWIB_AP_REDIRECT
}
elseif { ([HTTP::uri] starts_with "/html/") or ([HTTP::uri] starts_with "/images/") or ([HTTP::uri] starts_with "/tw/")
   or ([HTTP::uri] starts_with "/css/") or ([HTTP::uri] starts_with "/js/") or ([HTTP::uri] starts_with "/jsfResources/")  
   or ([HTTP::uri] starts_with "/font/") or ([HTTP::uri] starts_with "/cb/") or ([HTTP::uri] starts_with "/en/")
   or ([HTTP::uri] starts_with "/enterprise/") or ([HTTP::uri] starts_with "/download/") or ([HTTP::uri] starts_with "/flash/") 
   or ([HTTP::uri] starts_with "/Applet/") }
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB_ineb
 #pool /RBIT/INEB_POOL_WEB
}
elseif { ([HTTP::uri] starts_with "/mfe") }
{
   snatpool SNAT_INEB
   pool /EBMW/POOL_MFE_AP
}
else
{
 snatpool SNAT_INEB
 pool /EBMW/POOL_EBMW_WEB
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/ctbc-ib/zh_rb/general/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_ctbc.tw_EBMW {
when HTTP_REQUEST {
if { [HTTP::host] contains "ctbc.tw" }
{
 #set uri [string map -nocase {"/" "/IB/rd/"} [HTTP::uri]]
 set uri [string map -nocase {"/" "/shortener/redirect/"} [HTTP::uri]]
  HTTP::header insert Authorization "Basic MWI2OTNkZmQ6MGZjMGYxNzgyNmM3M2Q1ZmU0Y2Q4YzFmOTgzOTY3ZDk="
  HTTP::uri $uri
 snatpool SNAT_CTBC.TW
 #pool /EBMW/POOL_EBMWIB_AP
 pool /EBMW/POOL_EBMW_OPENAPI
}
elseif { ([HTTP::uri] starts_with "/content/ctbc-ib") or ([HTTP::uri] starts_with "/content/dam") }
{
   snatpool SNAT_CTBC.TW
   pool /EBMW/POOL_EBMW_WEB
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
else {
 HTTP::redirect "https://www.ctbcbank.com"
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/twrbo/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_ctbc.tw_EBMW_Div {
when HTTP_REQUEST {
if { ([HTTP::host] contains "ctbc.tw") && ([HTTP::uri] starts_with "/laborN")  }
{
  HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/labor2021covid.html"
}
elseif { ([HTTP::host] contains "ctbc.tw") && (([HTTP::uri] starts_with "/laborA") || ([HTTP::uri] contains "/sRm2mj") || ([HTTP::uri] contains "/YJyfaq")) }
{
  HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/labor2021.html"
}
elseif { ([HTTP::host] contains "ctbc.tw") && (([HTTP::uri] starts_with "/TjyY8U") || ([HTTP::uri] contains "/6yUlkY") || ([HTTP::uri] contains "/laborQ")) }
{
  HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/loan_service_ploan_query.html"
}
elseif { ([HTTP::host] contains "ctbc.tw") && ([HTTP::uri] starts_with "/NT5000")  }
{
  HTTP::redirect "https://ob.ctbcbank.com/fsv/cp/index.html"
}
elseif { ([HTTP::host] contains "ctbc.tw") && ([HTTP::uri] starts_with "/DyO7aQ")  }
{
  HTTP::redirect "https://webchat.ctbcbank.com/webchat/index?Skill=c_easy&Channel=SMS&KeywordEnabled=Y&FromPageId=TW_SMS_WPC01"
}
elseif { [HTTP::host] contains "ctbc.tw" }
{
 set uri [string map -nocase {"/" "/IB/rd/"} [HTTP::uri]]
 HTTP::uri $uri
 snatpool SNAT_CTBC.TW
 pool /EBMW/POOL_EBMWIB_AP
 #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]--ctbc.tw"
}
elseif { [HTTP::uri] starts_with "laborN" }
{
  HTTP::redirect "https://www.ctbcbank.com/twrbo/zh_tw/onlinecounter_index/loan_service/loan_ploan/labor2021covid.html"
}
elseif { ([HTTP::uri] starts_with "/content/ctbc-ib") or ([HTTP::uri] starts_with "/content/dam") }
{
   snatpool SNAT_CTBC.TW
   pool /EBMW/POOL_EBMW_WEB
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
else {
 HTTP::redirect "https://www.ctbcbank.com"
}
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/twrbo/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_mobilepage_EBMW {
when HTTP_REQUEST {
if { [HTTP::uri] contains "/twrbc/twrbc-line/" }
 {
  snatpool SNAT_MobilePage 
  pool /EBMW/POOL_EBMWIB_AP
 }
elseif { ([HTTP::uri] starts_with "/content/ctbc-ib") or ([HTTP::uri] starts_with "/content/dam") }
{
   snatpool SNAT_MobilePage
   pool /EBMW/POOL_EBMW_WEB
   #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
else {
 HTTP::host www.ctbcbank.com
 HTTP::respond 301 noserver Location "https://[HTTP::host][HTTP::uri]"
  #log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
 }
}
when LB_FAILED {
 HTTP::redirect "https://www.ctbcbank.com/twrbo/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_without_persist_accessibility_ext {
when HTTP_REQUEST {
  if { ([HTTP::uri] starts_with "/CTCBPortalWeb") } {
        HTTP::respond 301 Location "https://accessibility.ctbcbank.com/INEBAccessibleWeb/"
    }
elseif { [HTTP::uri] equals "/" } {
        HTTP::respond 301 Location "https://accessibility.ctbcbank.com/INEBAccessibleWeb/"
    }
elseif { ([HTTP::uri] starts_with "/INEBAccessibleWeb") or ([HTTP::uri] starts_with "/AccessibleIndex") }
{
        snat automap
        pool /EBMW/POOL_EBMW_AP_ACCESS_extenral
}
}
}
ltm rule /RBIT/iRule_dispatch_without_persist_accessibility_int {
when HTTP_REQUEST {
  if { ([HTTP::uri] starts_with "/CTCBPortalWeb") } {
        HTTP::respond 301 Location "https://accessibility.ctbcbank.com/INEBAccessibleWeb/"
    }
elseif { [HTTP::uri] equals "/" } {
        HTTP::respond 301 Location "https://accessibility.ctbcbank.com/INEBAccessibleWeb/"
    }
elseif { ([HTTP::uri] starts_with "/INEBAccessibleWeb") or ([HTTP::uri] starts_with "/AccessibleIndex") }
{
        snat automap
        pool /EBMW/POOL_EBMW_AP_ACCESS_Internal
}
}
}
ltm rule /RBIT/iRule_dispatch_without_persist_mobilepage {
when HTTP_REQUEST {
if { [HTTP::uri] contains "TW_MB_TX_" }
 {
  snat automap
  pool INEB_POOL_AP_mobilepage
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb/servlets/LoginCaptchaServlet" }
 {
  snat automap
  pool INEB_POOL_AP_mobilepage
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }
 {
   snat automap
   HTTP::redirect "https://www.ctbcbank.com/"
 }
 else {
  snat none
  pool INEB_POOL_WEB_mobilepage
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
#  OUT OF Service
when LB_FAILED {
 #HTTP::redirect "https://www.ctbcbank.com"
 HTTP::redirect "https://mobilepage.ctbcbank.com/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_without_persist_webchat {
when HTTP_REQUEST {
     if { ([HTTP::uri] starts_with "/CTCBPortalWeb/pages/webchat") or ([HTTP::uri] starts_with "/CTCBPortalWeb/servlets/WebchatPicGenServlet") }
 {
  snat automap
  pool INEB_POOL_AP_mobilepage
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }
 {
   snat automap
   HTTP::redirect "https://www.ctbcbank.com/"
 }
 else {
  snat none
  pool INEB_POOL_WEB_mobilepage
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
#  OUT OF Service
when LB_FAILED {
 #HTTP::redirect "https://www.ctbcbank.com"
 HTTP::redirect "https://webchat.ctbcbank.com/out_of_service.html"
}
}
ltm rule /RBIT/iRule_dispatch_without_persist_webchat_internal {
when HTTP_REQUEST {
     if { ([HTTP::uri] starts_with "/CTCBPortalWeb/pages/webchat") or ([HTTP::uri] starts_with "/CTCBPortalWeb/servlets/WebchatPicGenServlet") }
 {
  snat automap
  pool INEB_POOL_AP_mobilepage_internal
 }
 elseif { [HTTP::uri] starts_with "/CTCBPortalWeb" }
 {
   snat automap
   HTTP::redirect "https://www.ctbcbank.com/"
 }
 else {
  snat none
  pool INEB_POOL_WEB_mobilepage
#  log local0. "[HTTP::uri] [HTTP::header Referer] [HTTP::cookie JESSIONID] to server [LB::server addr] port [LB::server port]"
}
}
#  OUT OF Service
when LB_FAILED {
 #HTTP::redirect "https://www.ctbcbank.com"
 HTTP::redirect "https://webchat.ctbcbank.com/out_of_service.html"
}
}
ltm rule /RBIT/iRule_india_redirect {
when HTTP_REQUEST {
 HTTP::redirect "https://www.ctbcbank.com/content/dam/cbminisite/IN/index.html"
}
}
ltm rule /RBIT/iRule_redirect_www.ctbcbank.com_homepage {
when HTTP_REQUEST {
     HTTP::redirect "https://www.ctbcbank.com"
}
when HTTP_RESPONSE {
     HTTP::header insert Strict-Transport-Security "max-age=31536000; includeSubDomains"
}
}
ltm rule /RBIT/iRule_redirect_www.ctbcbank.com_keepURI {
when HTTP_REQUEST {
     HTTP::redirect "https://www.ctbcbank.com[HTTP::uri]"
}
when HTTP_RESPONSE {
     HTTP::header insert Strict-Transport-Security "max-age=31536000; includeSubDomains"
}
}
ltm snat-translation /RBIT/10.23.96.93 {
    address 10.23.96.93
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /RBIT/10.23.96.95 {
    address 10.23.96.95
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /RBIT/10.23.96.96 {
    address 10.23.96.96
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /RBIT/10.23.96.104 {
    address 10.23.96.104
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /RBIT/10.23.96.105 {
    address 10.23.96.105
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /RBIT/192.168.212.8 {
    address 192.168.212.8
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snat-translation /RBIT/192.168.212.26 {
    address 192.168.212.26
    inherited-traffic-group true
    traffic-group /Common/traffic-group-1
}
ltm snatpool /RBIT/SNAT_CTBC.TW {
    members {
        /RBIT/10.23.96.95
    }
}
ltm snatpool /RBIT/SNAT_HKINEB {
    members {
        /RBIT/192.168.212.8
    }
}
ltm snatpool /RBIT/SNAT_INHB {
    members {
        /RBIT/192.168.212.26
    }
}
ltm snatpool /RBIT/SNAT_INMW {
    members {
        /RBIT/10.23.96.96
    }
}
ltm snatpool /RBIT/SNAT_MobilePage {
    members {
        /RBIT/10.23.96.93
    }
}
ltm snatpool /RBIT/SNAT_ctbcholding {
    members {
        /RBIT/10.23.96.104
    }
}
ltm snatpool /RBIT/SNAT_lotto {
    members {
        /RBIT/10.23.96.105
    }
}
ltm virtual /RBIT/VS_INEB_accessibility_EXT_443 {
    description 網銀無障礙網站
    destination /Common/175.184.240.216:443
    ip-protocol tcp
    last-modified-time 2022-11-20:12:47:49
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_AP_ACCESS_extenral
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_Response_Unchunk { }
        /Common/INEB_accessibility_SSL_profile {
            context clientside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
    }
    rules {
        /RBIT/iRule_INEB_ACCESS_ADD_HTTP_HEADER
        /RBIT/iRule_dispatch_without_persist_accessibility_ext
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
    vlans {
        /Common/IWEB_Vlan_2593
    }
    vlans-enabled
}
ltm virtual /RBIT/VS_INEB_accessibility_INT_443 {
    description 網銀無障礙網站
    destination /RBIT/10.23.96.89:443
    ip-protocol tcp
    last-modified-time 2022-11-20:12:48:10
    mask 255.255.255.255
    persist {
        /RBIT/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/INEB_accessibility_SSL_profile {
            context clientside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
    }
    rules {
        /RBIT/iRule_INEB_ACCESS_ADD_HTTP_HEADER
        /RBIT/iRule_dispatch_without_persist_accessibility_int
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_INMW_External_175.184.243.187_443 {
    destination /Common/10.23.96.96:8443
    ip-protocol tcp
    last-modified-time 2024-02-23:18:00:24
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_inmw {
            default yes
        }
    }
    profiles {
        /Common/http { }
        /Common/tcp { }
        /RBIT/INMW_SSL_Profile {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_INMW_remove_X_Header
        /RBIT/iRule_INMW_301_redirect_Production_close
        /Common/iRule_Reject_wsat
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_INMW
        type snat
    }
    translate-address enabled
    translate-port enabled
    vlans {
        /Common/IWEB_Vlan_2593
    }
    vlans-enabled
}
ltm virtual /RBIT/VS_INMW_Internal_10.23.96.96_80 {
    destination /Common/10.23.96.96:443
    ip-protocol tcp
    last-modified-time 2023-12-09:04:15:00
    mask 255.255.255.255
    persist {
        /Common/source_addr {
            default yes
        }
    }
    pool /RBIT/POOL_INMW_AP_Internal
    profiles {
        /Common/EBMW_ebmwop_SSL_profile {
            context clientside
        }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
    }
    rules {
        /RBIT/iRule_INEBOP
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_INMW
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_INWA_EXT_443 {
    destination /Common/175.184.240.195:443
    ip-protocol tcp
    last-modified-time 2022-11-20:12:57:01
    mask 255.255.255.255
    persist {
        /Common/source_addr {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_INWA_EXT_443 { }
    }
    pool /RBIT/INWA_POOL_AP
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/WLS-PROXY_Response_Unchunk { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INWA { }
        /RBIT/INWA_SSL_profile {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_INWA_dispatch_setCookie
        /RBIT/iRule_INWA_dispatch_RemoveHeader
        /RBIT/iRule_INWA_dispatch
        /Common/iRule_INWA_dispatch_login
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_INWA_Intra_443 {
    destination /Common/192.168.212.21:443
    ip-protocol tcp
    last-modified-time 2022-11-20:12:56:48
    mask 255.255.255.255
    persist {
        /Common/source_addr {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_INWA_Intra_443 { }
    }
    pool /RBIT/INWA_POOL_AP_INTRA
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/WLS-PROXY_Response_Unchunk { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INWA { }
        /RBIT/INWA_SSL_profile {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_INWA_dispatch_setCookie
        /RBIT/iRule_INWA_dispatch_RemoveHeader
        /RBIT/iRule_INWA_dispatch_Intra
        /Common/iRule_INWA_dispatch_login
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_MOBILE_INEB_EXT_443 {
    creation-time 2023-09-11:18:19:14
    destination /Common/203.66.181.135:443
    ip-protocol tcp
    last-modified-time 2023-10-11:11:06:13
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_MOBILE_INEB_EXT_18080 { }
    }
    pool /RBIT/INEB_POOL_AP
    profiles {
        /Common/DDOS-profile_20170428 { }
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/INEB_ctbcbank_SSL_profile {
            context clientside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_EBMWIB { }
    }
    rules {
        /RBIT/iRule_EBMWIB_MOBILE_SEO
        /RBIT/iRule_dispatch_EBMWIB_close_door_20240429
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_MOBILE_INEB_EXT_18080 {
    destination /Common/203.66.181.135:18080
    ip-protocol tcp
    last-modified-time 2022-11-20:12:49:25
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_MOBILE_INEB_EXT_18080 { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/DDOS-profile_20170428 { }
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/INEB_ctbcbank_SSL_profile {
            context clientside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_EBMWIB { }
    }
    rules {
        /RBIT/iRule_EBMWIB_SEO
        /RBIT/iRule_dispatch_EBMWIB_close_door_20240429
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_MOBILE_INMW_EXT_18080 {
    destination /Common/203.66.181.134:18080
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_inmw {
            default yes
        }
    }
    pool /RBIT/POOL_INMW_AP
    profiles {
        /Common/http { }
        /Common/tcp { }
        /RBIT/INMW_SSL_Profile {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_INMW_remove_X_Header
        /RBIT/iRule_INMW_301_redirect_Production
        /Common/iRule_Reject_wsat
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_INMW
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_consumer_external_443 {
    destination /Common/203.66.181.191:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/consumer_ssl_p_TWCA {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_redirect_www.ctbcbank.com_homepage
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_consumer_external_443_DR {
    destination /Common/175.184.243.210:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/consumer_ssl_p_TWCA {
            context clientside
        }
    }
    rules {
        /Common/iRule_INEB_301_cgi_redirect_ctbcbank
        /Common/iRule_INEB_dispatch_without_persist
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_consumer_internal_443 {
    destination /Common/192.168.212.9:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/consumer_ssl_p_TWCA {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_redirect_www.ctbcbank.com_homepage
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
    vlans {
        /Common/IWEB_Vlan_2592
    }
    vlans-enabled
}
ltm virtual /RBIT/VS_ctbc.tw_EXT_443 {
    destination /RBIT/175.184.243.186:443
    ip-protocol tcp
    last-modified-time 2022-11-25:18:23:59
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ctbc.tw {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB_mobilepage
    profiles {
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/http-EBMW-compression { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/ctbc.tw_SSL_profile {
            context clientside
        }
        /RBIT/rewrite-openapi { }
    }
    rules {
        /RBIT/iRule_dispatch_ctbc.tw_EBMW
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_ctbc.tw_INT_443 {
    destination /RBIT/10.23.96.95:443
    ip-protocol tcp
    last-modified-time 2023-07-28:19:18:55
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ctbc.tw {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB_mobilepage
    profiles {
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/http-EBMW-compression { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/ctbc.tw_SSL_profile {
            context clientside
        }
        /RBIT/rewrite-openapi { }
    }
    rules {
        /RBIT/iRule_HTTP_RESPONSE
        /RBIT/iRule_dispatch_ctbc.tw_EBMW
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_CTBC.TW
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_ctbcbank.com.tw_ext_443_DR {
    destination /Common/175.184.243.208:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/INEB_ctbcbank_SSL_profile {
            context clientside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
    }
    rules {
        /RBIT/iRule_EBMW_RESPONSE
        /RBIT/iRule_redirect_www.ctbcbank.com_keepURI
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_ctbcbank.com.tw_int_443_DR {
    destination /Common/192.168.212.23:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/INEB_ctbcbank_SSL_profile {
            context clientside
        }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
    }
    rules {
        /RBIT/iRule_EBMW_RESPONSE
        /RBIT/iRule_redirect_www.ctbcbank.com_keepURI
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_ctbcbank.com_ext_443_DR {
    destination /Common/175.184.243.207:443
    ip-protocol tcp
    last-modified-time 2024-07-28:05:23:26
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_ctbcbank.com_ext_443_DR { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/DDOS-profile_20170428 { }
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/INEB_ctbcbank_SSL_profile {
            context clientside
        }
        /Common/rewrite-mfe { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_EBMWIB { }
    }
    rules {
        /RBIT/iRule_Dispatch_EBMW_Deny
        /RBIT/iRule_EBMWIB_SEO
        /RBIT/iRule_dispatch_EBMWIB_close_door_20240429
        /RBIT/iRule_EBMW_samesite_cookie_handling
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
    vlans {
        /Common/IWEB_Vlan_2593
    }
    vlans-enabled
}
ltm virtual /RBIT/VS_ctbcbank.com_int_443_DR {
    destination /Common/192.168.212.22:443
    ip-protocol tcp
    last-modified-time 2022-11-20:12:32:36
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_ctbcbank.com_int_443_DR { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/INEB_ctbcbank_SSL_profile {
            context clientside
        }
        /Common/http-EBMW-compression { }
        /Common/rewrite-mfe { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_EBMWIB { }
    }
    rules {
        /RBIT/iRule_Dispatch_EBMW_Deny
        /RBIT/iRule_EBMWIB_SEO
        /RBIT/iRule_dispatch_EBMWIB_close_door_20240429
        /RBIT/iRule_EBMW_samesite_cookie_handling
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_lotto.ctbcbank.com_443 {
    destination /Common/175.184.240.188:443
    ip-protocol tcp
    last-modified-time 2023-07-21:20:26:09
    mask 255.255.255.255
    persist {
        /RBIT/cookie_insert_infh {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_lotto.ctbcbank.com_443 { }
    }
    pool /RBIT/INFH_POOL_WEB
    profiles {
        /Common/EBMW_lotto_SSL_Profile {
            context clientside
        }
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INFH { }
    }
    rules {
        /RBIT/iRule_Lotto_HTTP_RESPONSE
        /RBIT/iRule_Dispatch_INFH_SG
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_lotto
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_www.chinatrustindia.com_ext_80 {
    address-status no
    destination /RBIT/175.184.243.184:80
    ip-protocol tcp
    mask 255.255.255.255
    policies {
        /RBIT/asm_auto_l7_policy__VS_www.chinatrustindia.com_ext_80 { }
    }
    profiles {
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_EBMWIB { }
    }
    rules {
        /RBIT/iRule_india_redirect
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_www.ctbcholding.com_ext_443 {
    destination /RBIT/175.184.243.183:443
    ip-protocol tcp
    last-modified-time 2023-07-21:20:24:05
    mask 255.255.255.255
    persist {
        /RBIT/cookie_insert_infh {
            default yes
        }
    }
    policies {
        /RBIT/asm_auto_l7_policy__VS_www.ctbcholding.com_ext_443 { }
    }
    pool /RBIT/INFH_POOL_WEB
    profiles {
        /Common/EBMW_ctbcholding_SSL_Profile {
            context clientside
        }
        /Common/HTTP_X_forward_Response_Unchunk { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INFH { }
    }
    rules {
        /RBIT/iRule_HTTP_RESPONSE_INFH
        /RBIT/iRule_Dispatch_INFH_SG
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_ctbcholding
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_www_external_443 {
    destination /Common/203.66.181.190:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/www_ssl_p_TWCA {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_redirect_www.ctbcbank.com_keepURI
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_www_external_443_DR {
    destination /Common/175.184.243.209:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/consumer_ssl_p_TWCA {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_redirect_www.ctbcbank.com_keepURI
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/VS_www_internal_443 {
    destination /Common/192.168.212.18:443
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_ineb {
            default yes
        }
    }
    policies {
        /RBIT/SP_INEB { }
    }
    pool /RBIT/INEB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/ASM_SP_INEB { }
        /RBIT/consumer_ssl_p_TWCA {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_redirect_www.ctbcbank.com_keepURI
    }
    security-log-profiles {
        /Common/Arcsight_LOG_P
        /Common/Arcsight_LOG_P_local
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/vs_incn_external_443 {
    destination /Common/175.184.240.188:8443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert {
            default yes
        }
    }
    pool /RBIT/INCN_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward_CN { }
        /Common/incn_ssl_profile {
            context clientside
        }
        /Common/tcp { }
    }
    rules {
        /Common/iRule_INCN_dispatch_AP
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/vs_incn_internal_443 {
    destination /Common/192.168.212.7:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_incn {
            default yes
        }
    }
    pool /RBIT/INCN_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward_CN { }
        /Common/incn_ssl_profile {
            context clientside
        }
        /Common/tcp { }
    }
    rules {
        /RBIT/iRule_INCN_dispatch_AP
        /RBIT/iRule_CNINEB_RESPONSE
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        type automap
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/vs_inhb_external_443 {
    destination /Common/175.184.240.194:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_incm {
            default yes
        }
    }
    pool /RBIT/INHBCC_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/incm_ctbcbank_ssl_profile {
            context clientside
        }
        /Common/tcp { }
        /Common/websecurity { }
    }
    rules {
        /RBIT/iRule_INCM_Bypass
        /Common/iRule_INHBCC_dispatch_without_persist
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/vs_inhb_internal_443 {
    destination /RBIT/175.184.243.200:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_incm {
            default yes
        }
    }
    pool /RBIT/INHBCC_POOL_AP
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/incm_ctbcbank_ssl_profile_TWCA {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_INCM_Bypass
        /Common/iRule_INHBCC_dispatch_without_persist
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/vs_mb.ctbcbank.com.tw_ext_443 {
    destination /RBIT/175.184.243.203:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_inhb {
            default yes
        }
    }
    pool /RBIT/INHB_POOL_WEB
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /RBIT/inhb_ssl_profile_TWCA {
            context clientside
        }
    }
    rules {
        /Common/iRule_INHB_dispatch_without_persist
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_INHB
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/vs_mb.ctbcbank.com.tw_int_443 {
    destination /RBIT/192.168.212.26:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_inhb {
            default yes
        }
    }
    pool /RBIT/INHB_POOL_AP_X5B
    profiles {
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /RBIT/inhb_ssl_profile_TWCA {
            context clientside
        }
    }
    rules {
        /Common/iRule_INHB_dispatch_without_persist
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    source-address-translation {
        pool /RBIT/SNAT_INHB
        type snat
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /RBIT/vs_mcard.ctbcbank.com_int_443 {
    destination /Common/192.168.212.6:443
    disabled
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie_insert_incm {
            default yes
        }
    }
    pool /RBIT/INHBCC_POOL_AP_X5B
    profiles {
        /Common/HTTP-Comp_CTBC { }
        /Common/HTTP_X_forward { }
        /Common/tcp { }
        /Common/websecurity { }
        /RBIT/incm_ctbcbank_ssl_profile_TWCA {
            context clientside
        }
    }
    rules {
        /RBIT/iRule_INCM_Bypass
        /Common/iRule_INHBCC_dispatch_without_persist_internal
    }
    serverssl-use-sni disabled
    source 0.0.0.0/0
    translate-address enabled
    translate-port enabled
}
ltm virtual-address /RBIT/10.23.96.89 {
    address 10.23.96.89
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/10.23.96.95 {
    address 10.23.96.95
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/175.184.243.183 {
    address 175.184.243.183
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/175.184.243.184 {
    address 175.184.243.184
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/175.184.243.186 {
    address 175.184.243.186
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/175.184.243.200 {
    address 175.184.243.200
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/175.184.243.203 {
    address 175.184.243.203
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/175.184.243.244 {
    address 175.184.243.244
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /RBIT/192.168.212.26 {
    address 192.168.212.26
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm data-group internal /RBIT/EBMW_IP_Deny {
    records {
        2.58.241.0/24 { }
        5.30.210.19/32 { }
        31.221.140.217/32 { }
        62.216.92.51/32 { }
        84.239.14.157/32 { }
        89.187.162.0/24 { }
        89.187.163.0/24 { }
        94.59.220.210/32 { }
        94.204.207.234/32 { }
        103.164.81.0/24 { }
        103.164.81.195/32 { }
        146.75.187.53/32 { }
        165.154.224.0/24 { }
        165.154.225.0/24 { }
        165.154.225.193/32 { }
        165.154.226.0/24 { }
        165.154.227.0/24 { }
        165.154.228.0/24 { }
        165.154.229.0/24 { }
        165.154.230.0/24 { }
        165.154.231.0/24 { }
        165.154.232.0/24 { }
        165.154.233.0/24 { }
        165.154.234.0/24 { }
        165.154.235.0/24 { }
        165.154.236.0/24 { }
        165.154.237.0/24 { }
        165.154.238.0/24 { }
        165.154.239.0/24 { }
        165.154.240.0/24 { }
        165.154.241.0/24 { }
        165.154.242.0/24 { }
        165.154.243.0/24 { }
        182.239.114.166/32 { }
        196.217.167.118/32 { }
        212.166.222.192/32 { }
    }
    type ip
}
ltm data-group internal /RBIT/INCN_X5B_ALLOW {
    type ip
}
ltm data-group internal /RBIT/INEB_2DEV {
    records {
        1.165.232.45/32 { }
        1.165.232.124/32 { }
        1.165.232.136/32 { }
        1.165.233.7/32 { }
        1.165.233.11/32 { }
        1.165.233.31/32 { }
        1.165.233.106/32 { }
        1.165.233.116/32 { }
        1.165.233.140/32 { }
        1.165.234.50/32 { }
        1.165.234.53/32 { }
        1.165.234.92/32 { }
        1.165.234.101/32 { }
        1.165.234.127/32 { }
        1.165.234.166/32 { }
        1.165.234.196/32 { }
        1.165.234.209/32 { }
        1.165.234.218/32 { }
        1.165.235.33/32 { }
        1.165.235.48/32 { }
        1.165.235.62/32 { }
        1.165.235.149/32 { }
        1.165.235.201/32 { }
        1.165.235.210/32 { }
        1.171.138.241/32 { }
        36.232.184.22/32 { }
        36.232.184.43/32 { }
        36.232.184.98/32 { }
        36.232.184.103/32 { }
        36.232.184.108/32 { }
        36.232.184.114/32 { }
        36.232.184.115/32 { }
        36.232.184.170/32 { }
        36.232.185.14/32 { }
        36.232.185.42/32 { }
        36.232.185.97/32 { }
        36.232.185.113/32 { }
        36.232.185.118/32 { }
        36.232.185.145/32 { }
        36.232.185.177/32 { }
        36.232.185.179/32 { }
        36.232.186.59/32 { }
        36.232.186.62/32 { }
        36.232.186.73/32 { }
        36.232.186.163/32 { }
        36.232.186.172/32 { }
        36.232.186.197/32 { }
        36.232.187.1/32 { }
        36.232.187.24/32 { }
        36.232.187.29/32 { }
        36.232.187.35/32 { }
        36.232.187.54/32 { }
        36.232.187.86/32 { }
        36.232.187.103/32 { }
        36.232.187.105/32 { }
        36.232.187.152/32 { }
        36.232.187.211/32 { }
        36.232.188.52/32 { }
        36.232.188.55/32 { }
        36.232.188.65/32 { }
        36.232.188.82/32 { }
        36.232.188.134/32 { }
        36.232.188.135/32 { }
        36.232.188.153/32 { }
        36.232.188.166/32 { }
        36.232.188.226/32 { }
        36.232.188.236/32 { }
        36.232.188.241/32 { }
        36.232.188.246/32 { }
        36.232.189.8/32 { }
        36.232.189.28/32 { }
        36.232.189.39/32 { }
        36.232.189.43/32 { }
        36.232.189.45/32 { }
        36.232.189.69/32 { }
        36.232.189.105/32 { }
        36.232.189.139/32 { }
        36.232.189.147/32 { }
        36.232.189.201/32 { }
        36.232.190.21/32 { }
        36.232.190.99/32 { }
        36.232.190.111/32 { }
        36.232.190.147/32 { }
        36.232.190.164/32 { }
        36.232.190.174/32 { }
        36.232.190.182/32 { }
        36.232.190.200/32 { }
        36.232.190.214/32 { }
        36.232.191.20/32 { }
        36.232.191.116/32 { }
        36.232.191.141/32 { }
        36.232.191.144/32 { }
        36.232.191.170/32 { }
        36.232.191.172/32 { }
        36.232.191.187/32 { }
        36.232.191.190/32 { }
        36.232.191.206/32 { }
        36.232.191.207/32 { }
        36.232.191.210/32 { }
        36.232.191.240/32 { }
        36.233.48.4/32 { }
        36.233.48.7/32 { }
        36.233.48.16/32 { }
        36.233.48.34/32 { }
        36.233.48.52/32 { }
        36.233.48.55/32 { }
        36.233.48.96/32 { }
        36.233.48.97/32 { }
        36.233.48.172/32 { }
        36.233.48.218/32 { }
        36.233.48.225/32 { }
        36.233.48.236/32 { }
        36.233.49.31/32 { }
        36.233.49.40/32 { }
        36.233.49.46/32 { }
        36.233.49.86/32 { }
        36.233.49.87/32 { }
        36.233.49.88/32 { }
        36.233.49.145/32 { }
        36.233.49.201/32 { }
        36.233.49.214/32 { }
        36.233.50.112/32 { }
        36.233.50.128/32 { }
        36.233.50.178/32 { }
        36.233.51.2/32 { }
        36.233.51.61/32 { }
        36.233.51.66/32 { }
        36.233.51.74/32 { }
        36.233.51.147/32 { }
        36.233.51.174/32 { }
        36.233.51.175/32 { }
        36.233.51.249/32 { }
        36.233.80.4/32 { }
        36.233.80.7/32 { }
        36.233.80.21/32 { }
        36.233.80.45/32 { }
        36.233.80.134/32 { }
        36.233.80.215/32 { }
        36.233.81.78/32 { }
        36.233.81.101/32 { }
        36.233.81.124/32 { }
        36.233.81.136/32 { }
        36.233.81.165/32 { }
        36.233.81.169/32 { }
        36.233.81.176/32 { }
        36.233.81.196/32 { }
        36.233.81.219/32 { }
        36.233.81.235/32 { }
        36.233.81.238/32 { }
        36.233.81.240/32 { }
        36.233.81.251/32 { }
        36.233.82.6/32 { }
        36.233.82.20/32 { }
        36.233.82.68/32 { }
        36.233.82.141/32 { }
        36.233.82.149/32 { }
        36.233.82.158/32 { }
        36.233.82.172/32 { }
        36.233.82.204/32 { }
        36.233.82.217/32 { }
        36.233.83.16/32 { }
        36.233.83.19/32 { }
        36.233.83.109/32 { }
        36.233.83.123/32 { }
        36.233.83.133/32 { }
        36.233.83.155/32 { }
        36.233.83.166/32 { }
        36.233.83.175/32 { }
        36.233.83.200/32 { }
        36.233.83.209/32 { }
        36.233.83.214/32 { }
        36.233.88.140/32 { }
        36.233.136.42/32 { }
        36.233.136.89/32 { }
        36.233.136.191/32 { }
        36.233.136.196/32 { }
        36.233.136.205/32 { }
        36.233.137.1/32 { }
        36.233.137.32/32 { }
        36.233.137.54/32 { }
        36.233.137.83/32 { }
        36.233.137.92/32 { }
        36.233.137.134/32 { }
        36.233.137.135/32 { }
        36.233.137.167/32 { }
        36.234.42.120/32 { }
        36.234.112.8/32 { }
        36.234.112.159/32 { }
        36.234.112.219/32 { }
        36.234.113.35/32 { }
        36.234.113.38/32 { }
        36.234.113.74/32 { }
        36.234.113.94/32 { }
        36.234.113.102/32 { }
        36.234.113.111/32 { }
        36.234.113.167/32 { }
        36.234.113.213/32 { }
        36.234.113.252/32 { }
        36.234.114.23/32 { }
        36.234.114.37/32 { }
        36.234.114.71/32 { }
        36.234.114.83/32 { }
        36.234.114.90/32 { }
        36.234.114.102/32 { }
        36.234.114.146/32 { }
        36.234.114.172/32 { }
        36.234.114.196/32 { }
        36.234.114.213/32 { }
        36.234.114.247/32 { }
        36.234.115.29/32 { }
        36.234.115.39/32 { }
        36.234.115.58/32 { }
        36.234.115.62/32 { }
        36.234.115.88/32 { }
        36.234.115.98/32 { }
        36.234.115.105/32 { }
        36.234.115.142/32 { }
        36.234.115.146/32 { }
        36.234.115.161/32 { }
        36.234.115.162/32 { }
        36.234.115.174/32 { }
        36.234.115.185/32 { }
        36.234.115.188/32 { }
        36.234.115.198/32 { }
        36.234.115.219/32 { }
        36.234.116.27/32 { }
        36.234.116.43/32 { }
        36.234.116.63/32 { }
        36.234.116.71/32 { }
        36.234.116.116/32 { }
        36.234.116.208/32 { }
        36.234.116.226/32 { }
        36.234.117.44/32 { }
        36.234.117.142/32 { }
        36.234.117.177/32 { }
        36.234.117.196/32 { }
        36.234.117.223/32 { }
        36.234.118.6/32 { }
        36.234.118.35/32 { }
        36.234.118.51/32 { }
        36.234.118.107/32 { }
        36.234.118.123/32 { }
        36.234.118.159/32 { }
        36.234.118.179/32 { }
        36.234.118.181/32 { }
        36.234.118.203/32 { }
        36.234.118.211/32 { }
        36.234.118.229/32 { }
        36.234.119.155/32 { }
        36.234.119.159/32 { }
        36.234.176.67/32 { }
        36.234.176.81/32 { }
        36.234.176.93/32 { }
        36.234.176.172/32 { }
        36.234.176.229/32 { }
        36.234.176.241/32 { }
        36.234.177.56/32 { }
        36.234.177.72/32 { }
        36.234.177.76/32 { }
        36.234.177.101/32 { }
        36.234.177.115/32 { }
        36.234.177.162/32 { }
        36.234.177.171/32 { }
        36.234.177.182/32 { }
        36.234.178.74/32 { }
        36.234.178.79/32 { }
        36.234.178.97/32 { }
        36.234.178.125/32 { }
        36.234.178.214/32 { }
        36.234.178.231/32 { }
        36.234.179.6/32 { }
        36.234.179.24/32 { }
        36.234.179.47/32 { }
        36.234.179.71/32 { }
        36.234.179.106/32 { }
        36.234.179.180/32 { }
        36.234.179.185/32 { }
        36.234.179.205/32 { }
        36.235.40.86/32 { }
        36.235.40.105/32 { }
        36.235.40.188/32 { }
        36.235.40.227/32 { }
        36.235.40.228/32 { }
        36.235.41.23/32 { }
        36.235.41.52/32 { }
        36.235.41.196/32 { }
        36.235.41.199/32 { }
        36.235.41.244/32 { }
        36.235.42.26/32 { }
        36.235.42.64/32 { }
        36.235.42.158/32 { }
        36.235.42.190/32 { }
        36.235.42.202/32 { }
        36.235.42.240/32 { }
        36.235.43.32/32 { }
        36.235.43.48/32 { }
        36.235.43.115/32 { }
        36.235.43.120/32 { }
        36.235.43.212/32 { }
        36.235.44.43/32 { }
        36.235.44.136/32 { }
        36.235.44.138/32 { }
        36.235.44.180/32 { }
        36.235.44.184/32 { }
        36.235.44.196/32 { }
        36.235.44.203/32 { }
        36.235.44.205/32 { }
        36.235.44.206/32 { }
        36.235.44.231/32 { }
        36.235.44.247/32 { }
        36.235.45.6/32 { }
        36.235.45.173/32 { }
        36.235.45.196/32 { }
        36.235.45.220/32 { }
        36.235.45.225/32 { }
        36.235.46.18/32 { }
        36.235.46.29/32 { }
        36.235.46.66/32 { }
        36.235.46.135/32 { }
        36.235.46.147/32 { }
        36.235.46.160/32 { }
        36.235.46.169/32 { }
        36.235.46.211/32 { }
        36.235.46.216/32 { }
        36.235.47.6/32 { }
        36.235.47.29/32 { }
        36.235.47.37/32 { }
        36.235.47.158/32 { }
        36.235.47.200/32 { }
        36.235.47.228/32 { }
        36.235.90.73/32 { }
        36.235.90.100/32 { }
        36.235.90.107/32 { }
        36.235.90.135/32 { }
        36.235.90.145/32 { }
        36.235.90.150/32 { }
        36.235.90.155/32 { }
        36.235.90.175/32 { }
        36.235.90.178/32 { }
        36.235.91.73/32 { }
        36.235.91.83/32 { }
        36.235.91.130/32 { }
        36.235.91.207/32 { }
        36.235.91.216/32 { }
        36.237.16.136/32 { }
        49.159.134.4/32 { }
        61.63.14.60/32 { }
        61.224.80.6/32 { }
        61.224.80.73/32 { }
        61.224.80.104/32 { }
        61.224.80.110/32 { }
        61.224.80.123/32 { }
        61.224.80.132/32 { }
        61.224.80.157/32 { }
        61.224.80.176/32 { }
        61.224.80.205/32 { }
        61.224.80.213/32 { }
        61.224.80.244/32 { }
        61.224.81.16/32 { }
        61.224.81.110/32 { }
        61.224.81.119/32 { }
        61.224.81.178/32 { }
        61.224.81.180/32 { }
        61.224.82.30/32 { }
        61.224.82.89/32 { }
        61.224.82.129/32 { }
        61.224.82.143/32 { }
        61.224.82.176/32 { }
        61.224.82.192/32 { }
        61.224.82.210/32 { }
        61.224.82.231/32 { }
        61.224.82.242/32 { }
        61.224.83.23/32 { }
        61.224.83.85/32 { }
        61.224.83.89/32 { }
        61.224.83.94/32 { }
        61.224.83.117/32 { }
        61.224.83.118/32 { }
        61.224.83.145/32 { }
        61.224.83.165/32 { }
        61.224.83.208/32 { }
        61.224.83.213/32 { }
        61.224.84.19/32 { }
        61.224.84.32/32 { }
        61.224.84.54/32 { }
        61.224.84.78/32 { }
        61.224.84.122/32 { }
        61.224.84.229/32 { }
        61.224.84.230/32 { }
        61.224.85.36/32 { }
        61.224.85.41/32 { }
        61.224.85.53/32 { }
        61.224.85.87/32 { }
        61.224.85.105/32 { }
        61.224.85.134/32 { }
        61.224.85.140/32 { }
        61.224.85.149/32 { }
        61.224.85.156/32 { }
        61.224.85.203/32 { }
        61.224.85.205/32 { }
        61.224.85.210/32 { }
        61.224.85.220/32 { }
        61.224.86.44/32 { }
        61.224.86.51/32 { }
        61.224.86.112/32 { }
        61.224.86.152/32 { }
        61.224.86.164/32 { }
        61.224.86.183/32 { }
        61.224.86.200/32 { }
        61.224.86.229/32 { }
        61.224.86.251/32 { }
        61.224.87.11/32 { }
        61.224.87.95/32 { }
        61.224.87.104/32 { }
        61.224.87.121/32 { }
        61.224.87.125/32 { }
        61.224.87.127/32 { }
        61.224.87.220/32 { }
        61.224.88.142/32 { }
        61.224.88.169/32 { }
        61.224.88.171/32 { }
        61.224.88.174/32 { }
        61.224.89.121/32 { }
        61.224.89.164/32 { }
        61.224.89.188/32 { }
        61.224.89.193/32 { }
        61.224.89.198/32 { }
        61.224.89.231/32 { }
        61.224.90.12/32 { }
        61.224.90.45/32 { }
        61.224.90.84/32 { }
        61.224.90.101/32 { }
        61.224.90.104/32 { }
        61.224.90.119/32 { }
        61.224.90.158/32 { }
        61.224.90.160/32 { }
        61.224.91.28/32 { }
        61.224.91.122/32 { }
        61.224.91.138/32 { }
        61.224.91.178/32 { }
        61.224.91.219/32 { }
        61.224.91.221/32 { }
        61.224.91.252/32 { }
        61.224.92.4/32 { }
        61.224.92.55/32 { }
        61.224.92.86/32 { }
        61.224.92.110/32 { }
        61.224.92.132/32 { }
        61.224.92.138/32 { }
        61.224.92.190/32 { }
        61.224.92.214/32 { }
        61.224.92.219/32 { }
        61.224.92.228/32 { }
        61.224.92.241/32 { }
        61.224.93.23/32 { }
        61.224.93.82/32 { }
        61.224.93.113/32 { }
        61.224.93.144/32 { }
        61.224.93.156/32 { }
        61.224.93.157/32 { }
        61.224.93.170/32 { }
        61.224.93.188/32 { }
        61.224.94.10/32 { }
        61.224.94.92/32 { }
        61.224.94.113/32 { }
        61.224.94.142/32 { }
        61.224.94.159/32 { }
        61.224.94.189/32 { }
        61.224.94.233/32 { }
        61.224.95.16/32 { }
        61.224.95.42/32 { }
        61.224.95.46/32 { }
        61.224.240.9/32 { }
        61.224.240.112/32 { }
        61.224.240.183/32 { }
        61.224.240.233/32 { }
        61.224.241.56/32 { }
        61.224.241.84/32 { }
        61.224.241.171/32 { }
        61.224.241.222/32 { }
        61.224.241.227/32 { }
        61.224.241.233/32 { }
        61.224.242.37/32 { }
        61.224.242.45/32 { }
        61.224.242.68/32 { }
        61.224.242.190/32 { }
        61.224.243.42/32 { }
        61.224.243.65/32 { }
        61.224.243.136/32 { }
        61.224.243.143/32 { }
        61.224.243.152/32 { }
        61.224.243.174/32 { }
        61.224.243.223/32 { }
        61.224.243.237/32 { }
        61.224.244.27/32 { }
        61.224.244.50/32 { }
        61.224.244.54/32 { }
        61.224.244.226/32 { }
        61.224.245.21/32 { }
        61.224.245.45/32 { }
        61.224.245.54/32 { }
        61.224.245.88/32 { }
        61.224.245.149/32 { }
        61.224.245.179/32 { }
        61.224.245.184/32 { }
        61.224.246.12/32 { }
        61.224.246.81/32 { }
        61.224.246.123/32 { }
        61.224.246.133/32 { }
        61.224.246.179/32 { }
        61.224.246.182/32 { }
        61.224.247.6/32 { }
        61.224.247.93/32 { }
        61.224.247.95/32 { }
        61.224.247.129/32 { }
        61.224.247.178/32 { }
        61.224.247.183/32 { }
        61.224.247.185/32 { }
        61.224.247.186/32 { }
        61.224.247.237/32 { }
        61.224.248.37/32 { }
        61.224.248.38/32 { }
        61.224.248.91/32 { }
        61.224.248.96/32 { }
        61.224.248.138/32 { }
        61.224.248.179/32 { }
        61.224.248.233/32 { }
        61.224.249.86/32 { }
        61.224.249.198/32 { }
        61.224.249.201/32 { }
        61.224.249.220/32 { }
        61.224.249.241/32 { }
        61.224.250.61/32 { }
        61.224.250.91/32 { }
        61.224.250.95/32 { }
        61.224.250.101/32 { }
        61.224.250.116/32 { }
        61.224.250.133/32 { }
        61.224.250.158/32 { }
        61.224.250.169/32 { }
        61.224.250.185/32 { }
        61.224.250.205/32 { }
        61.224.250.216/32 { }
        61.224.251.14/32 { }
        61.224.251.20/32 { }
        61.224.251.28/32 { }
        61.224.251.171/32 { }
        61.224.251.188/32 { }
        61.224.251.198/32 { }
        61.224.251.209/32 { }
        61.224.251.214/32 { }
        61.224.251.239/32 { }
        61.224.251.243/32 { }
        61.224.252.11/32 { }
        61.224.252.25/32 { }
        61.224.252.29/32 { }
        61.224.252.41/32 { }
        61.224.252.55/32 { }
        61.224.252.76/32 { }
        61.224.252.200/32 { }
        61.224.252.201/32 { }
        61.224.252.246/32 { }
        61.224.253.105/32 { }
        61.224.253.112/32 { }
        61.224.253.142/32 { }
        61.224.253.190/32 { }
        61.224.253.208/32 { }
        61.224.253.250/32 { }
        61.230.158.229/32 { }
        111.246.24.155/32 { }
        111.246.25.74/32 { }
        111.246.26.140/32 { }
        111.246.27.91/32 { }
        111.246.27.211/32 { }
        111.246.28.56/32 { }
        111.246.29.190/32 { }
        111.246.31.28/32 { }
        111.246.31.52/32 { }
        111.246.31.245/32 { }
        111.246.252.44/32 { }
        111.246.252.95/32 { }
        111.246.252.204/32 { }
        111.246.253.59/32 { }
        111.246.253.89/32 { }
        111.246.253.92/32 { }
        111.246.253.239/32 { }
        111.246.254.4/32 { }
        111.246.254.63/32 { }
        111.246.254.142/32 { }
        111.250.209.27/32 { }
        111.253.89.152/32 { }
        114.38.32.6/32 { }
        114.38.32.29/32 { }
        114.38.32.31/32 { }
        114.38.32.75/32 { }
        114.38.32.90/32 { }
        114.38.32.102/32 { }
        114.38.32.153/32 { }
        114.38.32.190/32 { }
        114.38.32.214/32 { }
        114.38.33.23/32 { }
        114.38.33.42/32 { }
        114.38.33.59/32 { }
        114.38.33.65/32 { }
        114.38.33.110/32 { }
        114.38.33.129/32 { }
        114.38.33.142/32 { }
        114.38.33.186/32 { }
        114.38.33.219/32 { }
        114.38.33.238/32 { }
        114.38.34.23/32 { }
        114.38.34.39/32 { }
        114.38.34.44/32 { }
        114.38.34.47/32 { }
        114.38.34.52/32 { }
        114.38.34.61/32 { }
        114.38.34.69/32 { }
        114.38.34.71/32 { }
        114.38.34.72/32 { }
        114.38.34.85/32 { }
        114.38.34.86/32 { }
        114.38.34.100/32 { }
        114.38.34.105/32 { }
        114.38.34.116/32 { }
        114.38.34.120/32 { }
        114.38.34.132/32 { }
        114.38.34.136/32 { }
        114.38.34.150/32 { }
        114.38.34.201/32 { }
        114.38.34.246/32 { }
        114.38.35.8/32 { }
        114.38.35.9/32 { }
        114.38.35.29/32 { }
        114.38.35.40/32 { }
        114.38.35.103/32 { }
        114.38.35.111/32 { }
        114.38.35.115/32 { }
        114.38.35.129/32 { }
        114.38.35.130/32 { }
        114.38.35.168/32 { }
        114.38.35.170/32 { }
        114.38.35.188/32 { }
        114.38.35.191/32 { }
        114.38.35.214/32 { }
        114.38.35.217/32 { }
        114.38.35.228/32 { }
        114.38.36.59/32 { }
        114.38.36.63/32 { }
        114.38.36.96/32 { }
        114.38.36.120/32 { }
        114.38.36.130/32 { }
        114.38.36.151/32 { }
        114.38.36.157/32 { }
        114.38.36.160/32 { }
        114.38.36.164/32 { }
        114.38.36.210/32 { }
        114.38.36.232/32 { }
        114.38.37.2/32 { }
        114.38.37.13/32 { }
        114.38.37.39/32 { }
        114.38.37.71/32 { }
        114.38.37.96/32 { }
        114.38.37.97/32 { }
        114.38.37.110/32 { }
        114.38.37.121/32 { }
        114.38.37.130/32 { }
        114.38.37.142/32 { }
        114.38.37.153/32 { }
        114.38.37.161/32 { }
        114.38.37.164/32 { }
        114.38.37.166/32 { }
        114.38.37.197/32 { }
        114.38.37.203/32 { }
        114.38.37.226/32 { }
        114.38.37.233/32 { }
        114.38.37.243/32 { }
        114.38.37.249/32 { }
        114.38.38.7/32 { }
        114.38.38.10/32 { }
        114.38.38.21/32 { }
        114.38.38.28/32 { }
        114.38.38.44/32 { }
        114.38.38.64/32 { }
        114.38.38.79/32 { }
        114.38.38.83/32 { }
        114.38.38.84/32 { }
        114.38.38.90/32 { }
        114.38.38.104/32 { }
        114.38.38.107/32 { }
        114.38.38.123/32 { }
        114.38.38.136/32 { }
        114.38.38.153/32 { }
        114.38.38.167/32 { }
        114.38.38.185/32 { }
        114.38.38.199/32 { }
        114.38.38.212/32 { }
        114.38.38.220/32 { }
        114.38.38.226/32 { }
        114.38.38.232/32 { }
        114.38.38.236/32 { }
        114.38.38.242/32 { }
        114.38.38.251/32 { }
        114.38.38.253/32 { }
        114.38.39.20/32 { }
        114.38.39.55/32 { }
        114.38.39.78/32 { }
        114.38.39.101/32 { }
        114.38.39.106/32 { }
        114.38.39.109/32 { }
        114.38.39.152/32 { }
        114.38.39.163/32 { }
        114.38.39.167/32 { }
        114.38.39.198/32 { }
        114.38.39.214/32 { }
        114.38.39.218/32 { }
        114.38.128.85/32 { }
        114.38.128.186/32 { }
        114.38.129.26/32 { }
        114.38.129.34/32 { }
        114.38.129.153/32 { }
        114.38.129.167/32 { }
        114.38.129.235/32 { }
        114.38.129.246/32 { }
        114.38.129.248/32 { }
        114.38.130.25/32 { }
        114.38.130.76/32 { }
        114.38.130.151/32 { }
        114.38.130.155/32 { }
        114.38.130.241/32 { }
        114.38.131.27/32 { }
        114.38.131.65/32 { }
        114.38.131.89/32 { }
        114.38.131.105/32 { }
        114.38.131.119/32 { }
        114.38.131.166/32 { }
        114.38.131.206/32 { }
        114.38.131.215/32 { }
        114.38.132.129/32 { }
        114.38.132.213/32 { }
        114.38.132.232/32 { }
        114.38.133.13/32 { }
        114.38.133.14/32 { }
        114.38.133.26/32 { }
        114.38.133.158/32 { }
        114.38.133.245/32 { }
        114.38.133.248/32 { }
        114.38.134.35/32 { }
        114.38.134.87/32 { }
        114.38.134.94/32 { }
        114.38.134.222/32 { }
        114.38.135.15/32 { }
        114.38.135.31/32 { }
        114.38.135.66/32 { }
        114.38.135.93/32 { }
        114.38.135.111/32 { }
        114.38.135.169/32 { }
        114.38.148.14/32 { }
        114.38.149.101/32 { }
        114.38.149.144/32 { }
        114.38.149.147/32 { }
        114.38.149.172/32 { }
        114.38.149.192/32 { }
        114.38.151.34/32 { }
        114.38.151.64/32 { }
        114.38.151.119/32 { }
        114.38.151.161/32 { }
        114.38.252.7/32 { }
        114.38.252.20/32 { }
        114.38.252.79/32 { }
        114.38.252.87/32 { }
        114.38.252.106/32 { }
        114.38.252.133/32 { }
        114.38.252.170/32 { }
        114.38.253.9/32 { }
        114.38.253.114/32 { }
        114.38.253.132/32 { }
        114.38.253.202/32 { }
        114.38.254.12/32 { }
        114.38.254.73/32 { }
        114.38.254.88/32 { }
        114.38.254.116/32 { }
        114.38.254.173/32 { }
        114.38.254.177/32 { }
        114.38.254.187/32 { }
        114.38.254.193/32 { }
        114.41.252.142/32 { }
        114.41.253.57/32 { }
        114.46.176.31/32 { }
        114.46.176.55/32 { }
        114.46.176.172/32 { }
        114.46.177.5/32 { }
        114.46.177.21/32 { }
        114.46.177.30/32 { }
        114.46.177.138/32 { }
        114.46.177.146/32 { }
        114.46.177.158/32 { }
        114.46.177.190/32 { }
        114.46.177.199/32 { }
        114.46.177.211/32 { }
        114.46.178.66/32 { }
        114.46.178.91/32 { }
        114.46.178.181/32 { }
        114.46.178.227/32 { }
        114.46.179.35/32 { }
        114.46.179.53/32 { }
        114.46.179.92/32 { }
        114.46.179.101/32 { }
        114.46.179.215/32 { }
        114.46.179.222/32 { }
        114.46.180.43/32 { }
        114.46.180.55/32 { }
        114.46.180.59/32 { }
        114.46.180.81/32 { }
        114.46.180.86/32 { }
        114.46.180.127/32 { }
        114.46.180.178/32 { }
        114.46.180.221/32 { }
        114.46.181.9/32 { }
        114.46.181.74/32 { }
        114.46.181.87/32 { }
        114.46.181.98/32 { }
        114.46.181.128/32 { }
        114.46.181.149/32 { }
        114.46.181.205/32 { }
        114.46.181.235/32 { }
        114.46.182.1/32 { }
        114.46.182.3/32 { }
        114.46.182.6/32 { }
        114.46.182.19/32 { }
        114.46.182.31/32 { }
        114.46.182.56/32 { }
        114.46.182.63/32 { }
        114.46.182.93/32 { }
        114.46.182.94/32 { }
        114.46.182.123/32 { }
        114.46.182.124/32 { }
        114.46.182.130/32 { }
        114.46.182.159/32 { }
        114.46.182.204/32 { }
        114.46.183.6/32 { }
        114.46.183.9/32 { }
        114.46.183.11/32 { }
        114.46.183.63/32 { }
        114.46.183.68/32 { }
        114.46.183.89/32 { }
        114.46.183.114/32 { }
        114.46.183.142/32 { }
        114.46.183.148/32 { }
        114.46.183.182/32 { }
        114.46.183.204/32 { }
        114.46.183.222/32 { }
        114.46.183.235/32 { }
        114.46.183.245/32 { }
        114.46.183.252/32 { }
        114.46.192.14/32 { }
        114.46.192.93/32 { }
        114.46.192.205/32 { }
        114.46.192.231/32 { }
        114.46.193.235/32 { }
        114.46.194.4/32 { }
        114.46.194.66/32 { }
        114.46.194.97/32 { }
        114.46.195.201/32 { }
        114.46.195.230/32 { }
        114.46.196.17/32 { }
        114.46.196.210/32 { }
        114.46.197.44/32 { }
        114.46.197.93/32 { }
        114.46.197.165/32 { }
        114.46.197.190/32 { }
        114.46.197.249/32 { }
        114.46.198.137/32 { }
        114.46.198.220/32 { }
        114.46.199.32/32 { }
        114.46.199.133/32 { }
        114.46.200.68/32 { }
        114.46.200.73/32 { }
        114.46.200.105/32 { }
        114.46.200.114/32 { }
        114.46.200.142/32 { }
        114.46.202.70/32 { }
        114.46.202.100/32 { }
        114.46.202.233/32 { }
        114.46.203.105/32 { }
        114.46.203.151/32 { }
        114.46.203.159/32 { }
        114.46.203.238/32 { }
        114.46.204.42/32 { }
        114.46.205.31/32 { }
        114.46.205.40/32 { }
        114.46.206.82/32 { }
        114.46.206.158/32 { }
        114.46.207.30/32 { }
        114.46.207.58/32 { }
        114.46.207.136/32 { }
        114.46.207.181/32 { }
        114.46.207.235/32 { }
        114.46.208.64/32 { }
        114.46.208.106/32 { }
        114.46.208.210/32 { }
        114.46.209.39/32 { }
        114.46.209.42/32 { }
        114.46.209.155/32 { }
        114.46.209.247/32 { }
        114.46.211.16/32 { }
        114.46.211.18/32 { }
        114.46.211.46/32 { }
        114.46.211.94/32 { }
        114.46.211.110/32 { }
        114.46.211.129/32 { }
        114.46.211.154/32 { }
        114.46.212.78/32 { }
        114.46.212.135/32 { }
        114.46.212.200/32 { }
        114.46.212.249/32 { }
        114.46.213.92/32 { }
        114.46.214.101/32 { }
        114.46.215.157/32 { }
        114.46.216.37/32 { }
        114.46.216.76/32 { }
        114.46.216.213/32 { }
        114.46.216.219/32 { }
        114.46.216.229/32 { }
        114.46.217.22/32 { }
        114.46.217.200/32 { }
        114.46.217.240/32 { }
        114.46.217.248/32 { }
        114.46.218.13/32 { }
        114.46.219.8/32 { }
        114.46.219.73/32 { }
        114.46.219.146/32 { }
        114.46.219.167/32 { }
        114.46.219.248/32 { }
        114.46.220.233/32 { }
        114.46.220.242/32 { }
        114.46.220.244/32 { }
        114.46.221.27/32 { }
        114.46.221.78/32 { }
        114.46.221.108/32 { }
        114.46.221.211/32 { }
        114.46.222.75/32 { }
        114.46.222.152/32 { }
        114.46.222.153/32 { }
        114.46.223.110/32 { }
        114.46.224.217/32 { }
        114.46.224.230/32 { }
        114.46.224.242/32 { }
        114.46.225.66/32 { }
        114.46.225.179/32 { }
        114.46.227.2/32 { }
        114.46.227.193/32 { }
        114.46.228.204/32 { }
        114.46.229.102/32 { }
        114.46.229.143/32 { }
        114.46.229.173/32 { }
        114.46.229.180/32 { }
        114.46.230.7/32 { }
        114.46.230.75/32 { }
        114.46.230.185/32 { }
        114.46.230.206/32 { }
        114.46.230.247/32 { }
        114.46.231.11/32 { }
        114.46.231.21/32 { }
        114.46.231.40/32 { }
        114.46.231.108/32 { }
        114.46.231.121/32 { }
        114.46.231.135/32 { }
        114.46.231.186/32 { }
        114.46.231.224/32 { }
        114.47.128.23/32 { }
        118.170.32.26/32 { }
        118.170.32.32/32 { }
        118.170.32.34/32 { }
        118.170.32.65/32 { }
        118.170.32.66/32 { }
        118.170.32.71/32 { }
        118.170.32.81/32 { }
        118.170.32.82/32 { }
        118.170.32.97/32 { }
        118.170.32.132/32 { }
        118.170.32.201/32 { }
        118.170.32.206/32 { }
        118.170.32.242/32 { }
        118.170.32.244/32 { }
        118.170.32.251/32 { }
        118.170.32.252/32 { }
        118.170.33.84/32 { }
        118.170.33.114/32 { }
        118.170.33.166/32 { }
        118.170.33.214/32 { }
        118.170.33.224/32 { }
        118.170.33.237/32 { }
        118.170.33.253/32 { }
        118.170.34.2/32 { }
        118.170.34.3/32 { }
        118.170.34.58/32 { }
        118.170.34.78/32 { }
        118.170.34.95/32 { }
        118.170.34.101/32 { }
        118.170.34.146/32 { }
        118.170.34.147/32 { }
        118.170.34.158/32 { }
        118.170.34.165/32 { }
        118.170.34.179/32 { }
        118.170.34.186/32 { }
        118.170.34.192/32 { }
        118.170.35.6/32 { }
        118.170.35.15/32 { }
        118.170.35.68/32 { }
        118.170.35.98/32 { }
        118.170.35.111/32 { }
        118.170.35.112/32 { }
        118.170.35.142/32 { }
        118.170.35.171/32 { }
        118.170.36.8/32 { }
        118.170.36.84/32 { }
        118.170.36.92/32 { }
        118.170.36.93/32 { }
        118.170.36.96/32 { }
        118.170.36.99/32 { }
        118.170.36.155/32 { }
        118.170.36.158/32 { }
        118.170.36.173/32 { }
        118.170.36.182/32 { }
        118.170.36.195/32 { }
        118.170.36.205/32 { }
        118.170.36.208/32 { }
        118.170.36.224/32 { }
        118.170.36.231/32 { }
        118.170.36.235/32 { }
        118.170.36.238/32 { }
        118.170.36.243/32 { }
        118.170.37.7/32 { }
        118.170.37.19/32 { }
        118.170.37.41/32 { }
        118.170.37.49/32 { }
        118.170.37.93/32 { }
        118.170.37.100/32 { }
        118.170.37.118/32 { }
        118.170.37.131/32 { }
        118.170.37.132/32 { }
        118.170.37.151/32 { }
        118.170.37.153/32 { }
        118.170.37.159/32 { }
        118.170.37.170/32 { }
        118.170.37.172/32 { }
        118.170.37.173/32 { }
        118.170.37.182/32 { }
        118.170.37.184/32 { }
        118.170.37.189/32 { }
        118.170.37.190/32 { }
        118.170.37.196/32 { }
        118.170.37.198/32 { }
        118.170.37.201/32 { }
        118.170.37.207/32 { }
        118.170.37.212/32 { }
        118.170.37.218/32 { }
        118.170.37.244/32 { }
        118.170.38.12/32 { }
        118.170.38.19/32 { }
        118.170.38.50/32 { }
        118.170.38.69/32 { }
        118.170.38.134/32 { }
        118.170.38.160/32 { }
        118.170.38.199/32 { }
        118.170.38.200/32 { }
        118.170.38.202/32 { }
        118.170.38.237/32 { }
        118.170.38.239/32 { }
        118.170.39.31/32 { }
        118.170.39.83/32 { }
        118.170.39.93/32 { }
        118.170.39.118/32 { }
        118.170.39.124/32 { }
        118.170.39.152/32 { }
        118.170.39.160/32 { }
        118.170.39.161/32 { }
        118.170.39.196/32 { }
        118.170.39.209/32 { }
        118.170.40.15/32 { }
        118.170.40.21/32 { }
        118.170.40.44/32 { }
        118.170.40.48/32 { }
        118.170.40.65/32 { }
        118.170.40.73/32 { }
        118.170.40.78/32 { }
        118.170.40.88/32 { }
        118.170.40.121/32 { }
        118.170.40.122/32 { }
        118.170.40.125/32 { }
        118.170.40.136/32 { }
        118.170.40.150/32 { }
        118.170.40.152/32 { }
        118.170.40.192/32 { }
        118.170.40.202/32 { }
        118.170.40.220/32 { }
        118.170.40.221/32 { }
        118.170.40.222/32 { }
        118.170.40.227/32 { }
        118.170.40.236/32 { }
        118.170.40.248/32 { }
        118.170.40.251/32 { }
        118.170.41.22/32 { }
        118.170.41.24/32 { }
        118.170.41.40/32 { }
        118.170.41.51/32 { }
        118.170.41.53/32 { }
        118.170.41.83/32 { }
        118.170.41.161/32 { }
        118.170.41.165/32 { }
        118.170.41.176/32 { }
        118.170.41.200/32 { }
        118.170.41.230/32 { }
        118.170.42.22/32 { }
        118.170.42.24/32 { }
        118.170.42.30/32 { }
        118.170.42.46/32 { }
        118.170.42.55/32 { }
        118.170.42.85/32 { }
        118.170.42.93/32 { }
        118.170.42.103/32 { }
        118.170.42.152/32 { }
        118.170.42.159/32 { }
        118.170.42.163/32 { }
        118.170.42.168/32 { }
        118.170.42.173/32 { }
        118.170.42.179/32 { }
        118.170.42.181/32 { }
        118.170.42.220/32 { }
        118.170.42.231/32 { }
        118.170.42.244/32 { }
        118.170.42.245/32 { }
        118.170.43.15/32 { }
        118.170.43.21/32 { }
        118.170.43.33/32 { }
        118.170.43.76/32 { }
        118.170.43.80/32 { }
        118.170.43.99/32 { }
        118.170.43.115/32 { }
        118.170.43.121/32 { }
        118.170.43.123/32 { }
        118.170.43.135/32 { }
        118.170.43.171/32 { }
        118.170.43.172/32 { }
        118.170.43.175/32 { }
        118.170.43.197/32 { }
        118.170.43.237/32 { }
        118.170.43.247/32 { }
        118.170.44.11/32 { }
        118.170.44.15/32 { }
        118.170.44.24/32 { }
        118.170.44.30/32 { }
        118.170.44.34/32 { }
        118.170.44.49/32 { }
        118.170.44.65/32 { }
        118.170.44.67/32 { }
        118.170.44.79/32 { }
        118.170.44.88/32 { }
        118.170.44.111/32 { }
        118.170.44.129/32 { }
        118.170.44.155/32 { }
        118.170.44.160/32 { }
        118.170.44.226/32 { }
        118.170.44.231/32 { }
        118.170.45.50/32 { }
        118.170.45.54/32 { }
        118.170.45.57/32 { }
        118.170.45.70/32 { }
        118.170.45.76/32 { }
        118.170.45.91/32 { }
        118.170.45.92/32 { }
        118.170.45.131/32 { }
        118.170.45.157/32 { }
        118.170.45.164/32 { }
        118.170.45.230/32 { }
        118.170.45.234/32 { }
        118.170.45.236/32 { }
        118.170.46.90/32 { }
        118.170.46.91/32 { }
        118.170.46.167/32 { }
        118.170.46.217/32 { }
        118.170.46.222/32 { }
        118.170.47.30/32 { }
        118.170.47.91/32 { }
        118.170.47.146/32 { }
        118.170.48.96/32 { }
        118.170.48.201/32 { }
        118.170.49.46/32 { }
        118.170.49.158/32 { }
        118.170.49.190/32 { }
        118.170.49.200/32 { }
        118.170.49.229/32 { }
        118.170.49.235/32 { }
        118.170.49.239/32 { }
        118.170.50.108/32 { }
        118.170.50.130/32 { }
        118.170.50.163/32 { }
        118.170.50.246/32 { }
        118.170.51.113/32 { }
        118.170.51.134/32 { }
        118.170.52.67/32 { }
        118.170.52.224/32 { }
        122.118.0.37/32 { }
        122.118.0.82/32 { }
        122.118.0.249/32 { }
        122.118.1.36/32 { }
        122.118.1.37/32 { }
        122.118.1.47/32 { }
        122.118.1.166/32 { }
        122.118.2.46/32 { }
        122.118.2.94/32 { }
        122.118.2.105/32 { }
        122.118.2.147/32 { }
        122.118.2.230/32 { }
        122.118.2.234/32 { }
        122.118.3.5/32 { }
        122.118.3.51/32 { }
        122.118.3.201/32 { }
        122.118.4.110/32 { }
        122.118.4.115/32 { }
        122.118.5.117/32 { }
        122.118.6.54/32 { }
        122.118.6.68/32 { }
        122.118.6.70/32 { }
        122.118.6.75/32 { }
        122.118.6.123/32 { }
        122.118.7.5/32 { }
        122.118.7.82/32 { }
        122.118.7.90/32 { }
        122.118.7.156/32 { }
        122.118.7.208/32 { }
        122.118.8.142/32 { }
        122.118.8.143/32 { }
        122.118.8.161/32 { }
        122.118.8.180/32 { }
        122.118.9.32/32 { }
        122.118.9.74/32 { }
        122.118.9.126/32 { }
        122.118.9.215/32 { }
        122.118.10.5/32 { }
        122.118.10.98/32 { }
        122.118.10.111/32 { }
        122.118.10.143/32 { }
        122.118.10.148/32 { }
        122.118.10.200/32 { }
        122.118.10.216/32 { }
        122.118.10.223/32 { }
        122.118.10.232/32 { }
        122.118.11.34/32 { }
        122.118.11.99/32 { }
        122.118.11.106/32 { }
        122.118.11.136/32 { }
        122.118.11.155/32 { }
        122.118.11.249/32 { }
        122.118.12.31/32 { }
        122.118.12.46/32 { }
        122.118.12.137/32 { }
        122.118.12.212/32 { }
        122.118.12.227/32 { }
        122.118.13.5/32 { }
        122.118.13.6/32 { }
        122.118.13.53/32 { }
        122.118.13.60/32 { }
        122.118.13.71/32 { }
        122.118.13.104/32 { }
        122.118.13.122/32 { }
        122.118.13.144/32 { }
        122.118.13.164/32 { }
        122.118.13.218/32 { }
        122.118.13.249/32 { }
        122.118.14.1/32 { }
        122.118.14.14/32 { }
        122.118.14.23/32 { }
        122.118.14.26/32 { }
        122.118.14.28/32 { }
        122.118.14.29/32 { }
        122.118.14.59/32 { }
        122.118.14.71/32 { }
        122.118.14.84/32 { }
        122.118.14.99/32 { }
        122.118.14.113/32 { }
        122.118.14.131/32 { }
        122.118.14.139/32 { }
        122.118.14.171/32 { }
        122.118.14.183/32 { }
        122.118.14.195/32 { }
        122.118.14.211/32 { }
        122.118.14.221/32 { }
        122.118.15.34/32 { }
        122.118.15.36/32 { }
        122.118.15.52/32 { }
        122.118.15.70/32 { }
        122.118.15.81/32 { }
        122.118.15.102/32 { }
        122.118.15.114/32 { }
        122.118.15.118/32 { }
        122.118.15.126/32 { }
        122.118.15.128/32 { }
        122.118.15.140/32 { }
        122.118.15.144/32 { }
        122.118.15.155/32 { }
        122.118.15.174/32 { }
        122.118.15.183/32 { }
        122.118.15.189/32 { }
        122.118.15.194/32 { }
        122.118.15.200/32 { }
        122.118.15.206/32 { }
        122.118.15.212/32 { }
        122.118.15.224/32 { }
        122.118.15.227/32 { }
        122.118.15.233/32 { }
        122.118.15.252/32 { }
        122.118.16.21/32 { }
        122.118.16.24/32 { }
        122.118.16.27/32 { }
        122.118.16.29/32 { }
        122.118.16.52/32 { }
        122.118.16.62/32 { }
        122.118.16.110/32 { }
        122.118.16.139/32 { }
        122.118.16.159/32 { }
        122.118.16.165/32 { }
        122.118.16.173/32 { }
        122.118.16.182/32 { }
        122.118.16.185/32 { }
        122.118.16.192/32 { }
        122.118.16.195/32 { }
        122.118.16.235/32 { }
        122.118.17.21/32 { }
        122.118.17.37/32 { }
        122.118.17.65/32 { }
        122.118.17.74/32 { }
        122.118.17.82/32 { }
        122.118.17.85/32 { }
        122.118.17.103/32 { }
        122.118.17.107/32 { }
        122.118.17.128/32 { }
        122.118.17.130/32 { }
        122.118.17.140/32 { }
        122.118.17.156/32 { }
        122.118.17.160/32 { }
        122.118.17.170/32 { }
        122.118.17.213/32 { }
        122.118.18.16/32 { }
        122.118.18.17/32 { }
        122.118.18.44/32 { }
        122.118.18.47/32 { }
        122.118.18.55/32 { }
        122.118.18.80/32 { }
        122.118.18.114/32 { }
        122.118.18.118/32 { }
        122.118.18.138/32 { }
        122.118.18.173/32 { }
        122.118.18.182/32 { }
        122.118.18.188/32 { }
        122.118.18.191/32 { }
        122.118.18.201/32 { }
        122.118.18.223/32 { }
        122.118.18.229/32 { }
        122.118.18.250/32 { }
        122.118.19.27/32 { }
        122.118.19.31/32 { }
        122.118.19.78/32 { }
        122.118.19.114/32 { }
        122.118.19.120/32 { }
        122.118.19.174/32 { }
        122.118.19.194/32 { }
        122.118.19.205/32 { }
        122.118.19.239/32 { }
        122.118.20.18/32 { }
        122.118.20.47/32 { }
        122.118.20.82/32 { }
        122.118.20.137/32 { }
        122.118.20.146/32 { }
        122.118.20.158/32 { }
        122.118.20.159/32 { }
        122.118.20.168/32 { }
        122.118.20.169/32 { }
        122.118.20.219/32 { }
        122.118.20.235/32 { }
        122.118.21.7/32 { }
        122.118.21.26/32 { }
        122.118.21.36/32 { }
        122.118.21.41/32 { }
        122.118.21.77/32 { }
        122.118.21.79/32 { }
        122.118.21.120/32 { }
        122.118.21.121/32 { }
        122.118.21.168/32 { }
        122.118.21.172/32 { }
        122.118.21.182/32 { }
        122.118.21.186/32 { }
        122.118.21.208/32 { }
        122.118.21.217/32 { }
        122.118.22.2/32 { }
        122.118.22.11/32 { }
        122.118.22.43/32 { }
        122.118.22.114/32 { }
        122.118.22.121/32 { }
        122.118.22.145/32 { }
        122.118.22.150/32 { }
        122.118.22.156/32 { }
        122.118.22.157/32 { }
        122.118.22.163/32 { }
        122.118.22.165/32 { }
        122.118.22.174/32 { }
        122.118.22.185/32 { }
        122.118.22.189/32 { }
        122.118.22.193/32 { }
        122.118.22.215/32 { }
        122.118.22.219/32 { }
        122.118.22.225/32 { }
        122.118.22.228/32 { }
        122.118.22.238/32 { }
        122.118.22.246/32 { }
        122.118.22.251/32 { }
        122.118.23.10/32 { }
        122.118.23.28/32 { }
        122.118.23.95/32 { }
        122.118.23.103/32 { }
        122.118.23.108/32 { }
        122.118.23.113/32 { }
        122.118.23.141/32 { }
        122.118.23.144/32 { }
        122.118.23.166/32 { }
        122.118.23.178/32 { }
        122.118.23.212/32 { }
        122.118.23.213/32 { }
        122.118.23.214/32 { }
        122.118.23.230/32 { }
        122.118.23.239/32 { }
        122.118.23.243/32 { }
        122.118.23.253/32 { }
        122.118.32.2/32 { }
        122.118.32.23/32 { }
        122.118.32.26/32 { }
        122.118.32.63/32 { }
        122.118.32.86/32 { }
        122.118.32.87/32 { }
        122.118.32.89/32 { }
        122.118.32.104/32 { }
        122.118.32.138/32 { }
        122.118.32.175/32 { }
        122.118.32.197/32 { }
        122.118.32.237/32 { }
        122.118.32.238/32 { }
        122.118.32.250/32 { }
        122.118.33.10/32 { }
        122.118.33.12/32 { }
        122.118.33.15/32 { }
        122.118.33.39/32 { }
        122.118.33.63/32 { }
        122.118.33.83/32 { }
        122.118.33.112/32 { }
        122.118.33.132/32 { }
        122.118.33.192/32 { }
        122.118.33.194/32 { }
        122.118.33.228/32 { }
        122.118.33.251/32 { }
        122.118.33.252/32 { }
        122.118.34.4/32 { }
        122.118.34.10/32 { }
        122.118.34.19/32 { }
        122.118.34.36/32 { }
        122.118.34.52/32 { }
        122.118.34.66/32 { }
        122.118.34.99/32 { }
        122.118.34.112/32 { }
        122.118.34.118/32 { }
        122.118.34.119/32 { }
        122.118.34.163/32 { }
        122.118.34.169/32 { }
        122.118.34.202/32 { }
        122.118.34.212/32 { }
        122.118.34.218/32 { }
        122.118.34.235/32 { }
        122.118.34.240/32 { }
        122.118.35.27/32 { }
        122.118.35.29/32 { }
        122.118.35.60/32 { }
        122.118.35.72/32 { }
        122.118.35.83/32 { }
        122.118.35.91/32 { }
        122.118.35.97/32 { }
        122.118.35.109/32 { }
        122.118.35.123/32 { }
        122.118.35.127/32 { }
        122.118.35.158/32 { }
        122.118.35.162/32 { }
        122.118.35.184/32 { }
        122.118.35.185/32 { }
        122.118.35.211/32 { }
        122.118.35.243/32 { }
        122.118.35.245/32 { }
        122.118.36.28/32 { }
        122.118.36.51/32 { }
        122.118.36.79/32 { }
        122.118.36.101/32 { }
        122.118.36.104/32 { }
        122.118.36.114/32 { }
        122.118.36.118/32 { }
        122.118.36.121/32 { }
        122.118.36.141/32 { }
        122.118.36.162/32 { }
        122.118.36.177/32 { }
        122.118.36.215/32 { }
        122.118.36.240/32 { }
        122.118.37.16/32 { }
        122.118.37.22/32 { }
        122.118.37.30/32 { }
        122.118.37.31/32 { }
        122.118.37.36/32 { }
        122.118.37.42/32 { }
        122.118.37.66/32 { }
        122.118.37.69/32 { }
        122.118.37.93/32 { }
        122.118.37.105/32 { }
        122.118.37.127/32 { }
        122.118.37.140/32 { }
        122.118.37.149/32 { }
        122.118.37.157/32 { }
        122.118.37.164/32 { }
        122.118.37.173/32 { }
        122.118.37.175/32 { }
        122.118.37.197/32 { }
        122.118.37.198/32 { }
        122.118.37.201/32 { }
        122.118.37.221/32 { }
        122.118.37.248/32 { }
        122.118.38.12/32 { }
        122.118.38.14/32 { }
        122.118.38.24/32 { }
        122.118.38.63/32 { }
        122.118.38.65/32 { }
        122.118.38.74/32 { }
        122.118.38.102/32 { }
        122.118.38.138/32 { }
        122.118.38.140/32 { }
        122.118.38.162/32 { }
        122.118.38.192/32 { }
        122.118.38.193/32 { }
        122.118.38.235/32 { }
        122.118.39.5/32 { }
        122.118.39.20/32 { }
        122.118.39.43/32 { }
        122.118.39.45/32 { }
        122.118.39.54/32 { }
        122.118.39.67/32 { }
        122.118.39.135/32 { }
        122.118.39.143/32 { }
        122.118.39.158/32 { }
        122.118.39.166/32 { }
        122.118.39.197/32 { }
        122.118.39.203/32 { }
        122.118.39.235/32 { }
        122.118.39.245/32 { }
        122.118.39.247/32 { }
        122.118.40.3/32 { }
        122.118.40.21/32 { }
        122.118.40.43/32 { }
        122.118.40.67/32 { }
        122.118.40.87/32 { }
        122.118.40.113/32 { }
        122.118.40.130/32 { }
        122.118.40.134/32 { }
        122.118.40.135/32 { }
        122.118.40.138/32 { }
        122.118.40.139/32 { }
        122.118.40.197/32 { }
        122.118.40.208/32 { }
        122.118.40.218/32 { }
        122.118.40.238/32 { }
        122.118.41.18/32 { }
        122.118.41.26/32 { }
        122.118.41.47/32 { }
        122.118.41.53/32 { }
        122.118.41.89/32 { }
        122.118.41.99/32 { }
        122.118.41.103/32 { }
        122.118.41.108/32 { }
        122.118.41.147/32 { }
        122.118.41.168/32 { }
        122.118.41.232/32 { }
        122.118.42.27/32 { }
        122.118.42.50/32 { }
        122.118.42.66/32 { }
        122.118.42.98/32 { }
        122.118.42.108/32 { }
        122.118.42.148/32 { }
        122.118.42.172/32 { }
        122.118.42.186/32 { }
        122.118.42.200/32 { }
        122.118.42.222/32 { }
        122.118.43.18/32 { }
        122.118.43.28/32 { }
        122.118.43.44/32 { }
        122.118.43.55/32 { }
        122.118.43.80/32 { }
        122.118.43.102/32 { }
        122.118.43.128/32 { }
        122.118.43.159/32 { }
        122.118.43.174/32 { }
        122.118.43.183/32 { }
        122.118.43.189/32 { }
        122.118.43.221/32 { }
        122.118.43.244/32 { }
        122.118.44.9/32 { }
        122.118.44.14/32 { }
        122.118.44.74/32 { }
        122.118.45.78/32 { }
        122.118.45.93/32 { }
        122.118.45.95/32 { }
        122.118.45.145/32 { }
        122.118.45.168/32 { }
        122.118.46.8/32 { }
        122.118.46.21/32 { }
        122.118.46.62/32 { }
        122.118.46.151/32 { }
        122.118.46.173/32 { }
        122.118.46.184/32 { }
        122.118.46.212/32 { }
        122.118.46.248/32 { }
        122.118.47.9/32 { }
        122.118.47.51/32 { }
        122.118.47.54/32 { }
        122.118.47.74/32 { }
        122.118.47.86/32 { }
        122.118.47.99/32 { }
        122.118.47.154/32 { }
        122.118.47.185/32 { }
        122.118.47.193/32 { }
        122.118.47.222/32 { }
        122.118.96.5/32 { }
        122.118.96.17/32 { }
        122.118.96.25/32 { }
        122.118.96.53/32 { }
        122.118.96.74/32 { }
        122.118.96.145/32 { }
        122.118.96.159/32 { }
        122.118.96.186/32 { }
        122.118.96.198/32 { }
        122.118.96.222/32 { }
        122.118.96.236/32 { }
        122.118.96.246/32 { }
        122.118.97.36/32 { }
        122.118.97.57/32 { }
        122.118.97.73/32 { }
        122.118.97.88/32 { }
        122.118.97.116/32 { }
        122.118.97.129/32 { }
        122.118.97.147/32 { }
        122.118.97.164/32 { }
        122.118.97.176/32 { }
        122.118.97.244/32 { }
        122.118.98.46/32 { }
        122.118.98.69/32 { }
        122.118.98.101/32 { }
        122.118.98.117/32 { }
        124.173.113.18/32 { }
        124.173.114.27/32 { }
        218.28.180.18/32 { }
        218.29.107.74/32 { }
        218.164.0.194/32 { }
    }
    type ip
}
ltm data-group internal /RBIT/INEB_NULL {
    type ip
}
ltm data-group internal /RBIT/INEB_REJECT {
    records {
        59.125.182.223/32 { }
        211.23.28.235/32 { }
    }
    type ip
}
ltm data-group internal /RBIT/INEB_X5B_ALLOW {
    type ip
}
ltm data-group internal /RBIT/INEB_deny {
    records {
        59.125.182.223/32 { }
    }
    type ip
}
ltm data-group internal /RBIT/INEB_deny_20151022 {
    records {
        1.165.234.92/32 { }
        31.205.76.97/32 { }
        36.232.184.108/32 { }
        36.232.187.103/32 { }
        36.232.187.105/32 { }
        36.232.188.246/32 { }
        36.232.189.139/32 { }
        36.232.191.144/32 { }
        36.233.48.16/32 { }
        36.233.48.55/32 { }
        36.233.80.7/32 { }
        36.233.81.124/32 { }
        36.233.81.240/32 { }
        36.233.83.16/32 { }
        36.233.83.166/32 { }
        36.233.83.209/32 { }
        36.234.113.167/32 { }
        36.234.113.252/32 { }
        36.234.117.196/32 { }
        36.234.117.223/32 { }
        36.234.118.179/32 { }
        36.234.178.214/32 { }
        36.235.41.23/32 { }
        36.235.44.43/32 { }
        36.235.91.207/32 { }
        61.224.80.213/32 { }
        61.224.83.208/32 { }
        61.224.85.134/32 { }
        61.224.86.251/32 { }
        61.224.87.127/32 { }
        61.224.90.160/32 { }
        61.224.92.138/32 { }
        61.224.94.159/32 { }
        61.224.243.65/32 { }
        61.224.243.136/32 { }
        61.224.244.54/32 { }
        61.224.245.149/32 { }
        61.224.246.182/32 { }
        61.224.247.93/32 { }
        61.224.247.237/32 { }
        61.224.248.138/32 { }
        111.246.24.119/32 { }
        111.246.26.29/32 { }
        111.246.27.92/32 { }
        111.246.253.92/32 { }
        111.253.89.190/32 { }
        111.253.89.224/32 { }
        111.253.90.249/32 { }
        114.38.131.215/32 { }
        114.38.133.248/32 { }
        114.46.195.50/32 { }
        114.46.195.187/32 { }
        114.46.198.162/32 { }
        114.46.200.21/32 { }
        114.46.201.107/32 { }
        114.46.201.170/32 { }
        114.46.203.57/32 { }
        114.46.212.123/32 { }
        114.46.213.94/32 { }
        114.46.214.87/32 { }
        114.46.215.209/32 { }
        114.46.219.18/32 { }
        118.170.32.132/32 { }
        118.170.32.244/32 { }
        118.170.34.192/32 { }
        118.170.35.142/32 { }
        118.170.37.170/32 { }
        118.170.40.121/32 { }
        118.170.40.221/32 { }
        118.170.44.24/32 { }
        118.170.45.230/32 { }
        118.170.49.235/32 { }
        118.170.52.67/32 { }
        118.170.52.224/32 { }
        122.118.3.201/32 { }
        122.118.13.164/32 { }
        122.118.21.168/32 { }
        122.118.34.112/32 { }
        122.118.41.53/32 { }
        122.118.41.232/32 { }
        122.118.42.66/32 { }
        125.224.249.58/32 { }
        125.224.249.208/32 { }
        125.224.250.29/32 { }
        218.28.180.18/32 { }
    }
    type ip
}
ltm data-group internal /RBIT/INHK_X5B_ALLOW {
    type ip
}
ltm data-group internal /RBIT/INWA_Internal {
    records {
        10.33.181.233/32 { }
    }
    type ip
}
ltm data-group internal /RBIT/MoneyBook_list {
    records {
        DKrXiYtXNMaeCqKwvoTF5YX9J_BG { }
        D_JgcfG4VAZm0vA74XpAV5U9k8f3 { }
    }
    type string
}
ltm monitor http /RBIT/HTTP_mon_CNINEB_AP_14 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /CTCBPortalWeb/WebContent/pages/common/error503.html HTTP/1.1\r\nHost:10.24.74.14\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_ACCESS_15 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /INEBAccessibleWeb/resources/html/error503.html HTTP/1.1\r\nHost:10.24.74.15\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_ACCESS_53 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /INEBAccessibleWeb/resources/html/error503.html HTTP/1.1\r\nHost:10.24.74.53\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_DEV_83 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /CTCBPortalWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:172.24.16.83\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_DEV_84 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /CTCBPortalWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:172.24.16.84\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_INMW_AP_14 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /MobileWeb/c_FinanceManage/ccInstallment/init/ HTTP/1.1\r\nHost:10.24.74.14\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_INMW_AP_15 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /MobileWeb/c_FinanceManage/ccInstallment/init/ HTTP/1.1\r\nHost:10.24.74.15\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_INMW_AP_52 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /MobileWeb/c_FinanceManage/ccInstallment/init/ HTTP/1.1\r\nHost:10.24.74.52\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_INMW_AP_53 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /MobileWeb/c_FinanceManage/ccInstallment/init/ HTTP/1.1\r\nHost:10.24.74.53\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/HTTP_monitor_WEB_114 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv none
    recv-disable none
    send "GET /IB/api/adapters/IB_Adapter/resource/health/check HTTP/1.1\r\nHost:10.248.29.114 \r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/MON_TrustPay_AP_14 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /TrustPayWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:10.24.74.14\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/MON_TrustPay_AP_15 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /TrustPayWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:10.24.74.15\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INAWA_AP_79 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /AccessibleWebATM/help/safe.html HTTP/1.1\r\nHost:10.24.70.79\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INAWA_AP_80 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /AccessibleWebATM/help/safe.html HTTP/1.1\r\nHost:10.24.70.79\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INAWA_AP_96 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv none
    recv-disable none
    send "GET /AccessibleWebATM/help/safe.html HTTP/1.1\r\nHost:10.248.29.96\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INAWA_AP_97 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv none
    recv-disable none
    send "GET /AccessibleWebATM/help/safe.html HTTP/1.1\r\nHost:10.248.29.97\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INEB_AP_48 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv none
    recv-disable none
    send "GET /CTCBPortalWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:10.24.74.48\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INEB_AP_52 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /CTCBPortalWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:10.24.74.52\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INEB_AP_53 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /CTCBPortalWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:10.24.74.53\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INEB_AP_54 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /CTCBPortalWeb/appmanager/pages/common/error503.html HTTP/1.1\r\nHost:10.24.74.52\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INFH_WEB {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /index.html HTTP/1.1\r\nHost:175.184.243.183\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INFH_Web_8 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /index.html HTTP/1.1\r\nHost:10.24.123.8\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INWA_AP {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /WebATM/help/user01.htm HTTP/1.1\r\nHost:10.24.70.79\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INWA_AP_79 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /WebATM/help/user0101.htm HTTP/1.1\r\nHost:10.24.70.79\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INWA_AP_80 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /WebATM/help/user0101.htm HTTP/1.1\r\nHost:10.24.70.80\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INWA_AP_96 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /WebATM/help/user0101.htm HTTP/1.1\r\nHost:10.248.29.96\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor http /RBIT/mon_INWA_AP_97 {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 33
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /WebATM/help/user0101.htm HTTP/1.1\r\nHost:10.248.29.97\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 100
}
ltm monitor https /RBIT/mon_INWA_WEB {
    adaptive disabled
    cipherlist DEFAULT:+SHA:+3DES:+kEDH
    compatibility enabled
    defaults-from /Common/https
    destination *:*
    interval 100
    ip-dscp 0
    recv "200 OK"
    recv-disable none
    send "GET /WebATM/help.do HTTP/1.1\r\nHost:175.184.240.195\r\nUser-Agent: Mozilla/4.0 (compatible; Mozilla/4.0; F5)\r\nConnection: Close\r\n\r\n\r\n"
    time-until-up 0
    timeout 301
}
ltm monitor tcp /RBIT/tcp_10seconds {
    adaptive disabled
    defaults-from /Common/tcp
    destination *:*
    interval 20
    ip-dscp 0
    recv none
    recv-disable none
    send none
    time-until-up 0
    timeout 61
}
ltm monitor tcp /RBIT/tcp_60seconds {
    adaptive disabled
    defaults-from /Common/tcp
    destination *:*
    interval 20
    ip-dscp 0
    recv none
    recv-disable none
    send none
    time-until-up 0
    timeout 61
}
ltm monitor tcp /RBIT/tcp_7003 {
    adaptive disabled
    defaults-from /Common/tcp
    destination *.7003
    interval 5
    ip-dscp 0
    recv none
    recv-disable none
    send none
    time-until-up 0
    timeout 16
}
ltm persistence cookie /RBIT/cookie_insert_ineb {
    always-send disabled
    app-service none
    cookie-encryption disabled
    cookie-encryption-passphrase $M$IQ$KaaLbbEhd/9mFpEWNP5R1A==
    cookie-name none
    defaults-from /Common/cookie
    encrypt-cookie-poolname enabled
    expiration 0
    httponly enabled
    method insert
    override-connection-limit disabled
    secure enabled
}
ltm persistence cookie /RBIT/cookie_insert_infh {
    app-service none
    cookie-encryption required
    cookie-encryption-passphrase $M$wf$cuabjJpvMYFcuHBD+ct2sQ==
    defaults-from /Common/cookie
}
ltm persistence cookie /RBIT/cookie_insert_inwa {
    app-service none
    cookie-encryption required
    cookie-encryption-passphrase $M$6l$vh3hkvy0PwA1cMIQCFgINw==
    defaults-from /Common/cookie
}
ltm profile client-ssl /RBIT/INEB_ctbcbank_SSL_profile_TWCA {
    app-service none
    ca-file /Common/TWCA_EV_uca1.crt
    cert /Common/INEB_www.ctbcbank.com_x2_2021.crt
    cert-key-chain {
        INEB_www.ctbcbank.com_x2_2021_TWCA_EV_uca2 {
            cert /Common/INEB_www.ctbcbank.com_x2_2021.crt
            chain /Common/TWCA_EV_uca2.crt
            key /Common/INEB_www.ctbcbank.com_x2_2021.key
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!AES:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_EV_root.crt
    defaults-from /Common/clientssl
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INEB_www.ctbcbank.com_x2_2021.key
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    renegotiate-size 1000mb
}
ltm profile client-ssl /RBIT/INEB_ctbcbank_TW_SSL_profile_TWCA {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    ca-file /Common/TWCA_EV_uca1.crt
    cache-size 262144
    cache-timeout 3600
    cert /Common/INEB_www.ctbcbank.com_x2_2022.crt
    cert-key-chain {
        INEB_www.ctbcbank.com_x2_2022_TWCA_EV_uca2 {
            cert /Common/INEB_www.ctbcbank.com_x2_2022.crt
            chain /Common/TWCA_EV_uca2.crt
            key /Common/INEB_www.ctbcbank.com_x2_2022.key
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!AES:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_EV_root.crt
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INEB_www.ctbcbank.com_x2_2022.key
    mod-ssl-methods disabled
    mode enabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    proxy-ssl disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size indefinite
    renegotiation enabled
    secure-renegotiation require
    server-name none
    session-ticket disabled
    sni-default false
    sni-require false
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /RBIT/INEB_mobilepage.ctbcbank.com_SSL_profile {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    authenticate once
    authenticate-depth 9
    ca-file /Common/TWCA_EV_uca1.crt
    cache-size 262144
    cache-timeout 3600
    cert /Common/INEB_mobilepage.ctbcbank.com_2021.crt
    cert-key-chain {
        INEB_mobilepage.ctbcbank.com_2021_TWCA_EV_uca2 {
            cert /Common/INEB_mobilepage.ctbcbank.com_2021.crt
            chain /Common/TWCA_EV_uca2.crt
            key /Common/INEB_mobilepage.ctbcbank.com_2021.key
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_EV_root.crt
    crl-file none
    defaults-from /Common/clientssl
    generic-alert enabled
    handshake-timeout 10
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INEB_mobilepage.ctbcbank.com_2021.key
    mod-ssl-methods disabled
    mode enabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    peer-cert-mode ignore
    proxy-ssl disabled
    renegotiate-max-record-delay indefinite
    renegotiate-period indefinite
    renegotiate-size 1000mb
    renegotiation enabled
    retain-certificate true
    secure-renegotiation require
    server-name none
    session-ticket disabled
    sni-default false
    sni-require false
    ssl-sign-hash any
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /RBIT/INMW_SSL_Profile {
    app-service none
    ca-file /Common/TWCA_EV_uca1.crt
    cert /Common/INEB_m.ctbcbank.com_2021.crt
    cert-key-chain {
        INEB_m.ctbcbank.com_2021_TWCA_EV_uca2 {
            cert /Common/INEB_m.ctbcbank.com_2021.crt
            chain /Common/TWCA_EV_uca2.crt
            key /Common/INEB_m.ctbcbank.com_2021.key
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    defaults-from /Common/clientssl
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INEB_m.ctbcbank.com_2021.key
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    renegotiate-size 1000mb
    renegotiation enabled
}
ltm profile client-ssl /RBIT/INWA_SSL_profile {
    alert-timeout 10
    allow-non-ssl disabled
    app-service none
    ca-file /Common/TWCA_EV_uca1.crt
    cache-size 262144
    cache-timeout 3600
    cert /Common/INWA_eatm_SSL_2024_new
    cert-key-chain {
        INWA_eatm_SSL_2024_new_TWCA_EV_uca2_0 {
            cert /Common/INWA_eatm_SSL_2024_new
            chain /Common/TWCA_EV_uca2.crt
            key /Common/INWA_eatm_SSL_2024_new
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE+AES-GCM:CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_EV_root.crt
    defaults-from /Common/clientssl
    handshake-timeout 10
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INWA_eatm_SSL_2024_new
    mod-ssl-methods disabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    proxy-ssl disabled
    renegotiate-max-record-delay 10
    renegotiate-period indefinite
    renegotiate-size 1000mb
    renegotiation enabled
    secure-renegotiation require
    server-name none
    session-ticket disabled
    sni-default false
    sni-require false
    strict-resume disabled
    unclean-shutdown enabled
}
ltm profile client-ssl /RBIT/consumer_ssl_p_TWCA {
    app-service none
    ca-file /Common/TWCA_ROOT_hk
    cert /Common/INEB_www.chinatrust.com.tw_x2_2025
    cert-key-chain {
        INEB_www.chinatrust.com_TWCA_UCA_hk_0 {
            cert /Common/INEB_www.chinatrust.com.tw_x2_2025
            chain /Common/TWCA_UCA_hk
            key /Common/INEB_www.chinatrust.com.tw_x2_2025
        }
    }
    chain /Common/TWCA_UCA_hk
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    client-cert-ca none
    defaults-from /Common/clientssl
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INEB_www.chinatrust.com.tw_x2_2025
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    peer-cert-mode ignore
    renegotiate-size 1000mb
    renegotiation enabled
}
ltm profile client-ssl /RBIT/ctbc.tw_SSL_profile {
    app-service none
    ca-file /Common/TWCA_EV_uca1.crt
    cert /Common/EBMW_ctbc.tw_SSL_2024_new
    cert-key-chain {
        EBMW_ctbc_TWCA_EV_uca2_0 {
            cert /Common/EBMW_ctbc.tw_SSL_2024_new
            chain /Common/TWCA_EV_uca2.crt
            key /Common/EBMW_ctbc.tw_SSL_2024_new
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_EV_root.crt
    defaults-from /Common/clientssl
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/EBMW_ctbc.tw_SSL_2024_new
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    renegotiate-size 1000mb
    renegotiation enabled
}
ltm profile client-ssl /RBIT/incm_ctbcbank_ssl_profile_TWCA {
    alert-timeout 60
    app-service none
    ca-file /Common/TWCA_UCA1.crt
    cert /Common/INCM_mcard_SSL_2020.crt
    cert-key-chain {
        INCM_mcard_SSL_2020_TWCA_UCA2 {
            cert /Common/INCM_mcard_SSL_2020.crt
            chain /Common/TWCA_UCA2.crt
            key /Common/INCM_mcard_SSL_2020.key
        }
    }
    chain /Common/TWCA_UCA2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_Root.crt
    defaults-from /Common/clientssl
    handshake-timeout 60
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INCM_mcard_SSL_2020.key
    options { dont-insert-empty-fragments no-ssl no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    renegotiate-size 1000mb
}
ltm profile client-ssl /RBIT/inhb_ssl_profile_TWCA {
    alert-timeout 60
    app-service none
    ca-file /Common/TWCA_UCA1.crt
    cert /RBIT/INHB_mb.ctbcbank.com_TWCA_2018.crt
    cert-key-chain {
        INHB_mb.ctbcbank.com_TWCA_2018 {
            cert /RBIT/INHB_mb.ctbcbank.com_TWCA_2018.crt
            chain /Common/TWCA_UCA2.crt
            key /RBIT/INHB_mb.ctbcbank.com_TWCA_2018.key
        }
    }
    chain /Common/TWCA_UCA2.crt
    cipher-group none
    ciphers DEFAULT:!RC4:!3DES:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_Root.crt
    defaults-from /Common/clientssl
    handshake-timeout 60
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /RBIT/INHB_mb.ctbcbank.com_TWCA_2018.key
    mode enabled
    options { dont-insert-empty-fragments no-ssl no-tlsv1.3 no-sslv3 }
    passphrase none
    renegotiate-size 1000mb
}
ltm profile client-ssl /RBIT/inhk_ssl_profile_TWCA {
    alert-timeout 60
    app-service none
    ca-file /Common/TWCA_EV_uca1.crt
    cache-size 262144
    cache-timeout 3600
    cert /Common/HKINEB_2DN_SSL_2024
    cert-key-chain {
        HKINEB_2DN_SSL_2024_TWCA_EV_uca2_0 {
            cert /Common/HKINEB_2DN_SSL_2024
            chain /Common/TWCA_EV_uca2.crt
            key /Common/HKINEB_2DN_SSL_2024
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_EV_root.crt
    defaults-from /Common/clientssl
    handshake-timeout 60
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/HKINEB_2DN_SSL_2024
    mod-ssl-methods disabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    renegotiate-period indefinite
    renegotiate-size 1000mb
}
ltm profile client-ssl /RBIT/www_ssl_p_TWCA {
    app-service none
    ca-file /Common/TWCA_EV_uca1.crt
    cert /Common/INEB_www.chinatrust.com.tw_x2_2025
    cert-key-chain {
        INEB_www.chinatrust.com_TWCA_EV_uca2_0 {
            cert /Common/INEB_www.chinatrust.com.tw_x2_2025
            chain /Common/TWCA_EV_uca2.crt
            key /Common/INEB_www.chinatrust.com.tw_x2_2025
        }
    }
    chain /Common/TWCA_EV_uca2.crt
    cipher-group none
    ciphers ECDHE:!3DES:!SHA1:!CHACHA20-POLY1305
    client-cert-ca /Common/TWCA_EV_root.crt
    defaults-from /Common/clientssl
    inherit-ca-certkeychain true
    inherit-certkeychain false
    key /Common/INEB_www.chinatrust.com.tw_x2_2025
    mod-ssl-methods disabled
    options { dont-insert-empty-fragments no-tlsv1.3 no-tlsv1.1 no-sslv3 no-tlsv1 }
    passphrase none
    renegotiate-size 1000mb
}
ltm profile http /RBIT/WLS-PROXY {
    accept-xff disabled
    app-service none
    defaults-from /Common/HTTP_X_forward
    encrypt-cookies none
    enforcement {
        max-header-count 64
        max-header-size 32768
        max-requests 0
        pipeline allow
        truncated-redirects disabled
        unknown-method allow
    }
    fallback-host none
    fallback-status-codes none
    header-erase none
    header-insert WL-Proxy-SSL:true
    insert-xforwarded-for enabled
    lws-separator none
    lws-width 80
    oneconnect-transformations enabled
    proxy-type reverse
    redirect-rewrite matching
    request-chunking sustain
    response-chunking sustain
    response-headers-permitted none
    server-agent-name none
    sflow {
        poll-interval 0
        poll-interval-global yes
        sampling-rate 0
        sampling-rate-global yes
    }
    via-request preserve
    via-response preserve
    xff-alternative-names none
}
ltm profile rewrite /RBIT/rewrite-openapi {
    app-service none
    bypass-list none
    client-caching-type cache-css-js
    defaults-from /Common/rewrite
    java-ca-file /Common/ca-bundle.crt
    java-crl none
    java-sign-key /Common/default.key
    java-sign-key-passphrase-encrypted $M$nG$2wykXxSOZWrvKgzPQiVeww==
    java-signer /Common/default.crt
    location-specific false
    request {
        insert-xforwarded-for enabled
        insert-xforwarded-host disabled
        insert-xforwarded-proto disabled
        rewrite-headers enabled
    }
    response {
        rewrite-content enabled
        rewrite-headers enabled
    }
    rewrite-list none
    rewrite-mode uri-translation
    split-tunneling false
    uri-rules {
        uri_1669371530117 {
            client {
                path /
            }
            server {
                host ebmw-openapi-3scale-apicast-production.apps.scp01.ctbcbank.com
                path /
                port 80
                scheme http
            }
        }
    }
}
ltm profile server-ssl /RBIT/mon_INWA_WEB_ssl_profile {
    app-service none
    cert none
    cipher-group none
    ciphers DEFAULT:+SHA:+3DES
    defaults-from /Common/serverssl
    key none
    options { dont-insert-empty-fragments no-tlsv1.3 }
}
security bot-defense asm-profile /RBIT/ASM_SP_EBMWIB {
    app-service none
}
security bot-defense asm-profile /RBIT/ASM_SP_INEB {
    app-service none
}
security bot-defense asm-profile /RBIT/ASM_SP_INFH {
    app-service none
}
security bot-defense asm-profile /RBIT/ASM_SP_INWA {
    app-service none
}
sys file ifile /RBIT/CTBC_logo {
    cache-path /config/filestore/files_d/RBIT_d/ifile_d/:RBIT:CTBC_logo_86405_1
    revision 1
}
sys file ssl-cert /RBIT/INCM_mcard.ctbcbank.com_TWCA_2018.crt {
    cache-path /config/filestore/files_d/RBIT_d/certificate_d/:RBIT:INCM_mcard.ctbcbank.com_TWCA_2018.crt_88472_1
    revision 1
}
sys file ssl-cert /RBIT/INHB_mb.ctbcbank.com_TWCA_2018.crt {
    cache-path /config/filestore/files_d/RBIT_d/certificate_d/:RBIT:INHB_mb.ctbcbank.com_TWCA_2018.crt_88463_1
    revision 1
}
sys file ssl-cert /RBIT/Symantec_Class_3_Secure_Server_SHA256_SSL_CA.crt {
    cache-path /config/filestore/files_d/RBIT_d/certificate_d/:RBIT:Symantec_Class_3_Secure_Server_SHA256_SSL_CA.crt_82873_1
    revision 1
}
sys file ssl-key /RBIT/INCM_mcard.ctbcbank.com_TWCA_2018.key {
    cache-path /config/filestore/files_d/RBIT_d/certificate_key_d/:RBIT:INCM_mcard.ctbcbank.com_TWCA_2018.key_88469_1
    revision 1
}
sys file ssl-key /RBIT/INHB_mb.ctbcbank.com_TWCA_2018.key {
    cache-path /config/filestore/files_d/RBIT_d/certificate_key_d/:RBIT:INHB_mb.ctbcbank.com_TWCA_2018.key_88466_1
    revision 1
}
